[["ilustración-del-kriging-simple-espacio-tiempo-1.html", "Chapter 10 Ilustración del kriging simple espacio tiempo 10.1 Dependencias 10.2 Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1 10.3 Algunas funciones de covarianza espacio temporal no separables", " Chapter 10 Ilustración del kriging simple espacio tiempo 10.1 Dependencias library(mvtnorm) 10.2 Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1 En primer lugar, se generar la grilla espacio temporal. Aquí suponemos n=6 ubicaciones espaciales y T=4 momentos en el tiempo, así en total son 24 ubicaciones espacio-tiempo. Se llevará a cabo la simulación y posteriormente se usará el predictor kriging con su respectiva estimación de varianza del error de predicción, en un punto no “observado”. Se asume conocida la función de covarianza. En la práctica esta matriz se puede estimar por métodos como maxima veorsimilitud, pseudoverosimilitud y métodos basados en mínimos cuadrados. x1 &lt;- seq(0,3,len = 3) x2 &lt;- seq(1,6,len = 2) t &lt;- 1:4 grillaSpT=expand.grid(x1,x2,t) #matriz de distancias (rezagos) espaciales matDistSp=as.matrix(dist(grillaSpT[,1:2])) #matriz de distancias (rezagos) temporales matDistT=as.matrix(dist(grillaSpT[,3:3])) cressie1=function(h,u,p){(p[1]^2/((p[2]^2*u^2+1)))*exp(-(p[3]^2*h^2)/(p[2]^2*u^2+1))} ##parámetros p, mu, que en este caso son p=c(0.4,1.7,1.9) y mu=0 sigma=cressie1(matDistSp,matDistT,p=c(0.15,1.7,1.9)) sim1=rmvnorm(1,mean=rep(0,nrow(grillaSpT)), sigma=sigma) datos1=cbind(grillaSpT,t(sim1)) names(datos1)=c(&quot;x&quot;,&quot;y&quot;,&quot;t&quot;,&quot;z((x,y),t)&quot;) matDistSp ## 1 2 3 4 5 6 7 8 ## 1 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 ## 2 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 ## 3 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 ## 4 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 ## 5 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 ## 6 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 ## 7 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 ## 8 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 ## 9 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 ## 10 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 ## 11 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 ## 12 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 ## 13 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 ## 14 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 ## 15 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 ## 16 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 ## 17 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 ## 18 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 ## 19 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 ## 20 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 ## 21 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 ## 22 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 ## 23 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 ## 24 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 ## 9 10 11 12 13 14 15 16 ## 1 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 ## 2 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 ## 3 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 ## 4 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 ## 5 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 ## 6 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 ## 7 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 ## 8 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 ## 9 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 ## 10 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 ## 11 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 ## 12 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 ## 13 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 ## 14 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 ## 15 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 ## 16 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 ## 17 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 ## 18 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 ## 19 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 ## 20 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 ## 21 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 ## 22 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 ## 23 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 ## 24 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 ## 17 18 19 20 21 22 23 24 ## 1 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 ## 2 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 ## 3 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 ## 4 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 ## 5 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 ## 6 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 ## 7 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 ## 8 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 ## 9 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 ## 10 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 ## 11 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 ## 12 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 ## 13 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 ## 14 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 ## 15 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 ## 16 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 ## 17 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 ## 18 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 ## 19 5.220153 5.830952 0.000000 1.500000 3.000000 5.000000 5.220153 5.830952 ## 20 5.000000 5.220153 1.500000 0.000000 1.500000 5.220153 5.000000 5.220153 ## 21 5.220153 5.000000 3.000000 1.500000 0.000000 5.830952 5.220153 5.000000 ## 22 1.500000 3.000000 5.000000 5.220153 5.830952 0.000000 1.500000 3.000000 ## 23 0.000000 1.500000 5.220153 5.000000 5.220153 1.500000 0.000000 1.500000 ## 24 1.500000 0.000000 5.830952 5.220153 5.000000 3.000000 1.500000 0.000000 matDistT ## 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 ## 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 2 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 3 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 4 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 5 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 6 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 ## 7 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 8 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 9 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 10 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 11 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 12 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 ## 13 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 14 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 15 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 16 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 17 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 18 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 ## 19 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 ## 20 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 ## 21 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 ## 22 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 ## 23 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 ## 24 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1 1 1 0 0 0 0 0 0 sigma ## 1 2 3 4 5 ## 1 2.250000e-02 6.677680e-06 1.745640e-16 1.435838e-41 4.261364e-45 ## 2 6.677680e-06 2.250000e-02 6.677680e-06 4.261364e-45 1.435838e-41 ## 3 1.745640e-16 6.677680e-06 2.250000e-02 1.113981e-55 4.261364e-45 ## 4 1.435838e-41 4.261364e-45 1.113981e-55 2.250000e-02 6.677680e-06 ## 5 4.261364e-45 1.435838e-41 4.261364e-45 6.677680e-06 2.250000e-02 ## 6 1.113981e-55 4.261364e-45 1.435838e-41 1.745640e-16 6.677680e-06 ## 7 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 6.019365e-14 ## 8 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 4.857107e-13 ## 9 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 6.019365e-14 ## 10 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 7.168131e-04 ## 11 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 5.784062e-03 ## 12 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 7.168131e-04 ## 13 1.791401e-03 9.382886e-04 1.348240e-04 1.356956e-06 7.107376e-07 ## 14 9.382886e-04 1.791401e-03 9.382886e-04 7.107376e-07 1.356956e-06 ## 15 1.348240e-04 9.382886e-04 1.791401e-03 1.021269e-07 7.107376e-07 ## 16 1.356956e-06 7.107376e-07 1.021269e-07 1.791401e-03 9.382886e-04 ## 17 7.107376e-07 1.356956e-06 7.107376e-07 9.382886e-04 1.791401e-03 ## 18 1.021269e-07 7.107376e-07 1.356956e-06 1.348240e-04 9.382886e-04 ## 19 8.330248e-04 6.166746e-04 2.501787e-04 2.947989e-05 2.182348e-05 ## 20 6.166746e-04 8.330248e-04 6.166746e-04 2.182348e-05 2.947989e-05 ## 21 2.501787e-04 6.166746e-04 8.330248e-04 8.853568e-06 2.182348e-05 ## 22 2.947989e-05 2.182348e-05 8.853568e-06 8.330248e-04 6.166746e-04 ## 23 2.182348e-05 2.947989e-05 2.182348e-05 6.166746e-04 8.330248e-04 ## 24 8.853568e-06 2.182348e-05 2.947989e-05 2.501787e-04 6.166746e-04 ## 6 7 8 9 10 ## 1 1.113981e-55 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 ## 2 4.261364e-45 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 ## 3 1.435838e-41 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 ## 4 1.745640e-16 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 ## 5 6.677680e-06 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 ## 6 2.250000e-02 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 ## 7 1.145697e-16 2.250000e-02 6.677680e-06 1.745640e-16 1.435838e-41 ## 8 6.019365e-14 6.677680e-06 2.250000e-02 6.677680e-06 4.261364e-45 ## 9 4.857107e-13 1.745640e-16 6.677680e-06 2.250000e-02 1.113981e-55 ## 10 1.364348e-06 1.435838e-41 4.261364e-45 1.113981e-55 2.250000e-02 ## 11 7.168131e-04 4.261364e-45 1.435838e-41 4.261364e-45 6.677680e-06 ## 12 5.784062e-03 1.113981e-55 4.261364e-45 1.435838e-41 1.745640e-16 ## 13 1.021269e-07 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 ## 14 7.107376e-07 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 ## 15 1.356956e-06 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 ## 16 1.348240e-04 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 ## 17 9.382886e-04 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 ## 18 1.791401e-03 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 ## 19 8.853568e-06 1.791401e-03 9.382886e-04 1.348240e-04 1.356956e-06 ## 20 2.182348e-05 9.382886e-04 1.791401e-03 9.382886e-04 7.107376e-07 ## 21 2.947989e-05 1.348240e-04 9.382886e-04 1.791401e-03 1.021269e-07 ## 22 2.501787e-04 1.356956e-06 7.107376e-07 1.021269e-07 1.791401e-03 ## 23 6.166746e-04 7.107376e-07 1.356956e-06 7.107376e-07 9.382886e-04 ## 24 8.330248e-04 1.021269e-07 7.107376e-07 1.356956e-06 1.348240e-04 ## 11 12 13 14 15 ## 1 6.019365e-14 1.145697e-16 1.791401e-03 9.382886e-04 1.348240e-04 ## 2 4.857107e-13 6.019365e-14 9.382886e-04 1.791401e-03 9.382886e-04 ## 3 6.019365e-14 4.857107e-13 1.348240e-04 9.382886e-04 1.791401e-03 ## 4 7.168131e-04 1.364348e-06 1.356956e-06 7.107376e-07 1.021269e-07 ## 5 5.784062e-03 7.168131e-04 7.107376e-07 1.356956e-06 7.107376e-07 ## 6 7.168131e-04 5.784062e-03 1.021269e-07 7.107376e-07 1.356956e-06 ## 7 4.261364e-45 1.113981e-55 5.784062e-03 7.168131e-04 1.364348e-06 ## 8 1.435838e-41 4.261364e-45 7.168131e-04 5.784062e-03 7.168131e-04 ## 9 4.261364e-45 1.435838e-41 1.364348e-06 7.168131e-04 5.784062e-03 ## 10 6.677680e-06 1.745640e-16 4.857107e-13 6.019365e-14 1.145697e-16 ## 11 2.250000e-02 6.677680e-06 6.019365e-14 4.857107e-13 6.019365e-14 ## 12 6.677680e-06 2.250000e-02 1.145697e-16 6.019365e-14 4.857107e-13 ## 13 6.019365e-14 1.145697e-16 2.250000e-02 6.677680e-06 1.745640e-16 ## 14 4.857107e-13 6.019365e-14 6.677680e-06 2.250000e-02 6.677680e-06 ## 15 6.019365e-14 4.857107e-13 1.745640e-16 6.677680e-06 2.250000e-02 ## 16 7.168131e-04 1.364348e-06 1.435838e-41 4.261364e-45 1.113981e-55 ## 17 5.784062e-03 7.168131e-04 4.261364e-45 1.435838e-41 4.261364e-45 ## 18 7.168131e-04 5.784062e-03 1.113981e-55 4.261364e-45 1.435838e-41 ## 19 7.107376e-07 1.021269e-07 5.784062e-03 7.168131e-04 1.364348e-06 ## 20 1.356956e-06 7.107376e-07 7.168131e-04 5.784062e-03 7.168131e-04 ## 21 7.107376e-07 1.356956e-06 1.364348e-06 7.168131e-04 5.784062e-03 ## 22 9.382886e-04 1.348240e-04 4.857107e-13 6.019365e-14 1.145697e-16 ## 23 1.791401e-03 9.382886e-04 6.019365e-14 4.857107e-13 6.019365e-14 ## 24 9.382886e-04 1.791401e-03 1.145697e-16 6.019365e-14 4.857107e-13 ## 16 17 18 19 20 ## 1 1.356956e-06 7.107376e-07 1.021269e-07 8.330248e-04 6.166746e-04 ## 2 7.107376e-07 1.356956e-06 7.107376e-07 6.166746e-04 8.330248e-04 ## 3 1.021269e-07 7.107376e-07 1.356956e-06 2.501787e-04 6.166746e-04 ## 4 1.791401e-03 9.382886e-04 1.348240e-04 2.947989e-05 2.182348e-05 ## 5 9.382886e-04 1.791401e-03 9.382886e-04 2.182348e-05 2.947989e-05 ## 6 1.348240e-04 9.382886e-04 1.791401e-03 8.853568e-06 2.182348e-05 ## 7 4.857107e-13 6.019365e-14 1.145697e-16 1.791401e-03 9.382886e-04 ## 8 6.019365e-14 4.857107e-13 6.019365e-14 9.382886e-04 1.791401e-03 ## 9 1.145697e-16 6.019365e-14 4.857107e-13 1.348240e-04 9.382886e-04 ## 10 5.784062e-03 7.168131e-04 1.364348e-06 1.356956e-06 7.107376e-07 ## 11 7.168131e-04 5.784062e-03 7.168131e-04 7.107376e-07 1.356956e-06 ## 12 1.364348e-06 7.168131e-04 5.784062e-03 1.021269e-07 7.107376e-07 ## 13 1.435838e-41 4.261364e-45 1.113981e-55 5.784062e-03 7.168131e-04 ## 14 4.261364e-45 1.435838e-41 4.261364e-45 7.168131e-04 5.784062e-03 ## 15 1.113981e-55 4.261364e-45 1.435838e-41 1.364348e-06 7.168131e-04 ## 16 2.250000e-02 6.677680e-06 1.745640e-16 4.857107e-13 6.019365e-14 ## 17 6.677680e-06 2.250000e-02 6.677680e-06 6.019365e-14 4.857107e-13 ## 18 1.745640e-16 6.677680e-06 2.250000e-02 1.145697e-16 6.019365e-14 ## 19 4.857107e-13 6.019365e-14 1.145697e-16 2.250000e-02 6.677680e-06 ## 20 6.019365e-14 4.857107e-13 6.019365e-14 6.677680e-06 2.250000e-02 ## 21 1.145697e-16 6.019365e-14 4.857107e-13 1.745640e-16 6.677680e-06 ## 22 5.784062e-03 7.168131e-04 1.364348e-06 1.435838e-41 4.261364e-45 ## 23 7.168131e-04 5.784062e-03 7.168131e-04 4.261364e-45 1.435838e-41 ## 24 1.364348e-06 7.168131e-04 5.784062e-03 1.113981e-55 4.261364e-45 ## 21 22 23 24 ## 1 2.501787e-04 2.947989e-05 2.182348e-05 8.853568e-06 ## 2 6.166746e-04 2.182348e-05 2.947989e-05 2.182348e-05 ## 3 8.330248e-04 8.853568e-06 2.182348e-05 2.947989e-05 ## 4 8.853568e-06 8.330248e-04 6.166746e-04 2.501787e-04 ## 5 2.182348e-05 6.166746e-04 8.330248e-04 6.166746e-04 ## 6 2.947989e-05 2.501787e-04 6.166746e-04 8.330248e-04 ## 7 1.348240e-04 1.356956e-06 7.107376e-07 1.021269e-07 ## 8 9.382886e-04 7.107376e-07 1.356956e-06 7.107376e-07 ## 9 1.791401e-03 1.021269e-07 7.107376e-07 1.356956e-06 ## 10 1.021269e-07 1.791401e-03 9.382886e-04 1.348240e-04 ## 11 7.107376e-07 9.382886e-04 1.791401e-03 9.382886e-04 ## 12 1.356956e-06 1.348240e-04 9.382886e-04 1.791401e-03 ## 13 1.364348e-06 4.857107e-13 6.019365e-14 1.145697e-16 ## 14 7.168131e-04 6.019365e-14 4.857107e-13 6.019365e-14 ## 15 5.784062e-03 1.145697e-16 6.019365e-14 4.857107e-13 ## 16 1.145697e-16 5.784062e-03 7.168131e-04 1.364348e-06 ## 17 6.019365e-14 7.168131e-04 5.784062e-03 7.168131e-04 ## 18 4.857107e-13 1.364348e-06 7.168131e-04 5.784062e-03 ## 19 1.745640e-16 1.435838e-41 4.261364e-45 1.113981e-55 ## 20 6.677680e-06 4.261364e-45 1.435838e-41 4.261364e-45 ## 21 2.250000e-02 1.113981e-55 4.261364e-45 1.435838e-41 ## 22 1.113981e-55 2.250000e-02 6.677680e-06 1.745640e-16 ## 23 4.261364e-45 6.677680e-06 2.250000e-02 6.677680e-06 ## 24 1.435838e-41 1.745640e-16 6.677680e-06 2.250000e-02 datos1 ## x y t z((x,y),t) ## 1 0.0 1 1 0.032258475 ## 2 1.5 1 1 -0.069335074 ## 3 3.0 1 1 0.204614624 ## 4 0.0 6 1 0.074244047 ## 5 1.5 6 1 -0.018313899 ## 6 3.0 6 1 -0.054183055 ## 7 0.0 1 2 0.072981211 ## 8 1.5 1 2 0.239906717 ## 9 3.0 1 2 -0.187116495 ## 10 0.0 6 2 -0.026077816 ## 11 1.5 6 2 0.114156103 ## 12 3.0 6 2 0.083705521 ## 13 0.0 1 3 0.047760019 ## 14 1.5 1 3 0.035096926 ## 15 3.0 1 3 0.003381299 ## 16 0.0 6 3 -0.141476499 ## 17 1.5 6 3 0.196179210 ## 18 3.0 6 3 -0.046623565 ## 19 0.0 1 4 -0.158382243 ## 20 1.5 1 4 -0.040267249 ## 21 3.0 1 4 0.045260828 ## 22 0.0 6 4 -0.036635922 ## 23 1.5 6 4 -0.027844797 ## 24 3.0 6 4 0.185949562 Se requiere predecir predecir en el tiempo t=2.3 y en el lugar s0=(1.5,2.7).Nótese que tanto el dominio espacial como el dominio temporal con continuos y fijos. A continuación se presenta el procedimiento para llevar a cabo Kriging simple con su respectiva varianza de error de predicción estimada grillaSpT0=rbind(expand.grid(x1,x2,t),c(1.5,2.7,2.3)) matDistSp0=as.matrix(dist(grillaSpT0[,1:2])) matDistT0=as.matrix(dist(grillaSpT0[,3:3])) sigma0=cressie1(matDistSp0,matDistT0,p=c(0.15,1.7,1.9)) #vector de covarianzas entre la coordenada a predecir y las observadas sigma0 ## 1 2 3 4 5 ## 1 2.250000e-02 6.677680e-06 1.745640e-16 1.435838e-41 4.261364e-45 ## 2 6.677680e-06 2.250000e-02 6.677680e-06 4.261364e-45 1.435838e-41 ## 3 1.745640e-16 6.677680e-06 2.250000e-02 1.113981e-55 4.261364e-45 ## 4 1.435838e-41 4.261364e-45 1.113981e-55 2.250000e-02 6.677680e-06 ## 5 4.261364e-45 1.435838e-41 4.261364e-45 6.677680e-06 2.250000e-02 ## 6 1.113981e-55 4.261364e-45 1.435838e-41 1.745640e-16 6.677680e-06 ## 7 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 6.019365e-14 ## 8 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 4.857107e-13 ## 9 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 6.019365e-14 ## 10 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 7.168131e-04 ## 11 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 5.784062e-03 ## 12 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 7.168131e-04 ## 13 1.791401e-03 9.382886e-04 1.348240e-04 1.356956e-06 7.107376e-07 ## 14 9.382886e-04 1.791401e-03 9.382886e-04 7.107376e-07 1.356956e-06 ## 15 1.348240e-04 9.382886e-04 1.791401e-03 1.021269e-07 7.107376e-07 ## 16 1.356956e-06 7.107376e-07 1.021269e-07 1.791401e-03 9.382886e-04 ## 17 7.107376e-07 1.356956e-06 7.107376e-07 9.382886e-04 1.791401e-03 ## 18 1.021269e-07 7.107376e-07 1.356956e-06 1.348240e-04 9.382886e-04 ## 19 8.330248e-04 6.166746e-04 2.501787e-04 2.947989e-05 2.182348e-05 ## 20 6.166746e-04 8.330248e-04 6.166746e-04 2.182348e-05 2.947989e-05 ## 21 2.501787e-04 6.166746e-04 8.330248e-04 8.853568e-06 2.182348e-05 ## 22 2.947989e-05 2.182348e-05 8.853568e-06 8.330248e-04 6.166746e-04 ## 23 2.182348e-05 2.947989e-05 2.182348e-05 6.166746e-04 8.330248e-04 ## 24 8.853568e-06 2.182348e-05 2.947989e-05 2.501787e-04 6.166746e-04 ## 25 1.632912e-04 6.493361e-04 1.632912e-04 1.206101e-06 4.796124e-06 ## 6 7 8 9 10 ## 1 1.113981e-55 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 ## 2 4.261364e-45 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 ## 3 1.435838e-41 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 ## 4 1.745640e-16 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 ## 5 6.677680e-06 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 ## 6 2.250000e-02 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 ## 7 1.145697e-16 2.250000e-02 6.677680e-06 1.745640e-16 1.435838e-41 ## 8 6.019365e-14 6.677680e-06 2.250000e-02 6.677680e-06 4.261364e-45 ## 9 4.857107e-13 1.745640e-16 6.677680e-06 2.250000e-02 1.113981e-55 ## 10 1.364348e-06 1.435838e-41 4.261364e-45 1.113981e-55 2.250000e-02 ## 11 7.168131e-04 4.261364e-45 1.435838e-41 4.261364e-45 6.677680e-06 ## 12 5.784062e-03 1.113981e-55 4.261364e-45 1.435838e-41 1.745640e-16 ## 13 1.021269e-07 5.784062e-03 7.168131e-04 1.364348e-06 4.857107e-13 ## 14 7.107376e-07 7.168131e-04 5.784062e-03 7.168131e-04 6.019365e-14 ## 15 1.356956e-06 1.364348e-06 7.168131e-04 5.784062e-03 1.145697e-16 ## 16 1.348240e-04 4.857107e-13 6.019365e-14 1.145697e-16 5.784062e-03 ## 17 9.382886e-04 6.019365e-14 4.857107e-13 6.019365e-14 7.168131e-04 ## 18 1.791401e-03 1.145697e-16 6.019365e-14 4.857107e-13 1.364348e-06 ## 19 8.853568e-06 1.791401e-03 9.382886e-04 1.348240e-04 1.356956e-06 ## 20 2.182348e-05 9.382886e-04 1.791401e-03 9.382886e-04 7.107376e-07 ## 21 2.947989e-05 1.348240e-04 9.382886e-04 1.791401e-03 1.021269e-07 ## 22 2.501787e-04 1.356956e-06 7.107376e-07 1.021269e-07 1.791401e-03 ## 23 6.166746e-04 7.107376e-07 1.356956e-06 7.107376e-07 9.382886e-04 ## 24 8.330248e-04 1.021269e-07 7.107376e-07 1.356956e-06 1.348240e-04 ## 25 1.206101e-06 7.188593e-09 4.529707e-06 7.188593e-09 8.000712e-19 ## 11 12 13 14 15 ## 1 6.019365e-14 1.145697e-16 1.791401e-03 9.382886e-04 1.348240e-04 ## 2 4.857107e-13 6.019365e-14 9.382886e-04 1.791401e-03 9.382886e-04 ## 3 6.019365e-14 4.857107e-13 1.348240e-04 9.382886e-04 1.791401e-03 ## 4 7.168131e-04 1.364348e-06 1.356956e-06 7.107376e-07 1.021269e-07 ## 5 5.784062e-03 7.168131e-04 7.107376e-07 1.356956e-06 7.107376e-07 ## 6 7.168131e-04 5.784062e-03 1.021269e-07 7.107376e-07 1.356956e-06 ## 7 4.261364e-45 1.113981e-55 5.784062e-03 7.168131e-04 1.364348e-06 ## 8 1.435838e-41 4.261364e-45 7.168131e-04 5.784062e-03 7.168131e-04 ## 9 4.261364e-45 1.435838e-41 1.364348e-06 7.168131e-04 5.784062e-03 ## 10 6.677680e-06 1.745640e-16 4.857107e-13 6.019365e-14 1.145697e-16 ## 11 2.250000e-02 6.677680e-06 6.019365e-14 4.857107e-13 6.019365e-14 ## 12 6.677680e-06 2.250000e-02 1.145697e-16 6.019365e-14 4.857107e-13 ## 13 6.019365e-14 1.145697e-16 2.250000e-02 6.677680e-06 1.745640e-16 ## 14 4.857107e-13 6.019365e-14 6.677680e-06 2.250000e-02 6.677680e-06 ## 15 6.019365e-14 4.857107e-13 1.745640e-16 6.677680e-06 2.250000e-02 ## 16 7.168131e-04 1.364348e-06 1.435838e-41 4.261364e-45 1.113981e-55 ## 17 5.784062e-03 7.168131e-04 4.261364e-45 1.435838e-41 4.261364e-45 ## 18 7.168131e-04 5.784062e-03 1.113981e-55 4.261364e-45 1.435838e-41 ## 19 7.107376e-07 1.021269e-07 5.784062e-03 7.168131e-04 1.364348e-06 ## 20 1.356956e-06 7.107376e-07 7.168131e-04 5.784062e-03 7.168131e-04 ## 21 7.107376e-07 1.356956e-06 1.364348e-06 7.168131e-04 5.784062e-03 ## 22 9.382886e-04 1.348240e-04 4.857107e-13 6.019365e-14 1.145697e-16 ## 23 1.791401e-03 9.382886e-04 6.019365e-14 4.857107e-13 6.019365e-14 ## 24 9.382886e-04 1.791401e-03 1.145697e-16 6.019365e-14 4.857107e-13 ## 25 5.041442e-16 8.000712e-19 4.302596e-06 1.240942e-04 4.302596e-06 ## 16 17 18 19 20 ## 1 1.356956e-06 7.107376e-07 1.021269e-07 8.330248e-04 6.166746e-04 ## 2 7.107376e-07 1.356956e-06 7.107376e-07 6.166746e-04 8.330248e-04 ## 3 1.021269e-07 7.107376e-07 1.356956e-06 2.501787e-04 6.166746e-04 ## 4 1.791401e-03 9.382886e-04 1.348240e-04 2.947989e-05 2.182348e-05 ## 5 9.382886e-04 1.791401e-03 9.382886e-04 2.182348e-05 2.947989e-05 ## 6 1.348240e-04 9.382886e-04 1.791401e-03 8.853568e-06 2.182348e-05 ## 7 4.857107e-13 6.019365e-14 1.145697e-16 1.791401e-03 9.382886e-04 ## 8 6.019365e-14 4.857107e-13 6.019365e-14 9.382886e-04 1.791401e-03 ## 9 1.145697e-16 6.019365e-14 4.857107e-13 1.348240e-04 9.382886e-04 ## 10 5.784062e-03 7.168131e-04 1.364348e-06 1.356956e-06 7.107376e-07 ## 11 7.168131e-04 5.784062e-03 7.168131e-04 7.107376e-07 1.356956e-06 ## 12 1.364348e-06 7.168131e-04 5.784062e-03 1.021269e-07 7.107376e-07 ## 13 1.435838e-41 4.261364e-45 1.113981e-55 5.784062e-03 7.168131e-04 ## 14 4.261364e-45 1.435838e-41 4.261364e-45 7.168131e-04 5.784062e-03 ## 15 1.113981e-55 4.261364e-45 1.435838e-41 1.364348e-06 7.168131e-04 ## 16 2.250000e-02 6.677680e-06 1.745640e-16 4.857107e-13 6.019365e-14 ## 17 6.677680e-06 2.250000e-02 6.677680e-06 6.019365e-14 4.857107e-13 ## 18 1.745640e-16 6.677680e-06 2.250000e-02 1.145697e-16 6.019365e-14 ## 19 4.857107e-13 6.019365e-14 1.145697e-16 2.250000e-02 6.677680e-06 ## 20 6.019365e-14 4.857107e-13 6.019365e-14 6.677680e-06 2.250000e-02 ## 21 1.145697e-16 6.019365e-14 4.857107e-13 1.745640e-16 6.677680e-06 ## 22 5.784062e-03 7.168131e-04 1.364348e-06 1.435838e-41 4.261364e-45 ## 23 7.168131e-04 5.784062e-03 7.168131e-04 4.261364e-45 1.435838e-41 ## 24 1.364348e-06 7.168131e-04 5.784062e-03 1.113981e-55 4.261364e-45 ## 25 2.770413e-11 7.990346e-10 2.770413e-11 3.308220e-04 7.884761e-04 ## 21 22 23 24 25 ## 1 2.501787e-04 2.947989e-05 2.182348e-05 8.853568e-06 1.632912e-04 ## 2 6.166746e-04 2.182348e-05 2.947989e-05 2.182348e-05 6.493361e-04 ## 3 8.330248e-04 8.853568e-06 2.182348e-05 2.947989e-05 1.632912e-04 ## 4 8.853568e-06 8.330248e-04 6.166746e-04 2.501787e-04 1.206101e-06 ## 5 2.182348e-05 6.166746e-04 8.330248e-04 6.166746e-04 4.796124e-06 ## 6 2.947989e-05 2.501787e-04 6.166746e-04 8.330248e-04 1.206101e-06 ## 7 1.348240e-04 1.356956e-06 7.107376e-07 1.021269e-07 7.188593e-09 ## 8 9.382886e-04 7.107376e-07 1.356956e-06 7.107376e-07 4.529707e-06 ## 9 1.791401e-03 1.021269e-07 7.107376e-07 1.356956e-06 7.188593e-09 ## 10 1.021269e-07 1.791401e-03 9.382886e-04 1.348240e-04 8.000712e-19 ## 11 7.107376e-07 9.382886e-04 1.791401e-03 9.382886e-04 5.041442e-16 ## 12 1.356956e-06 1.348240e-04 9.382886e-04 1.791401e-03 8.000712e-19 ## 13 1.364348e-06 4.857107e-13 6.019365e-14 1.145697e-16 4.302596e-06 ## 14 7.168131e-04 6.019365e-14 4.857107e-13 6.019365e-14 1.240942e-04 ## 15 5.784062e-03 1.145697e-16 6.019365e-14 4.857107e-13 4.302596e-06 ## 16 1.145697e-16 5.784062e-03 7.168131e-04 1.364348e-06 2.770413e-11 ## 17 6.019365e-14 7.168131e-04 5.784062e-03 7.168131e-04 7.990346e-10 ## 18 4.857107e-13 1.364348e-06 7.168131e-04 5.784062e-03 2.770413e-11 ## 19 1.745640e-16 1.435838e-41 4.261364e-45 1.113981e-55 3.308220e-04 ## 20 6.677680e-06 4.261364e-45 1.435838e-41 4.261364e-45 7.884761e-04 ## 21 2.250000e-02 1.113981e-55 4.261364e-45 1.435838e-41 3.308220e-04 ## 22 1.113981e-55 2.250000e-02 6.677680e-06 1.745640e-16 1.508203e-05 ## 23 4.261364e-45 6.677680e-06 2.250000e-02 6.677680e-06 3.594628e-05 ## 24 1.435838e-41 1.745640e-16 6.677680e-06 2.250000e-02 1.508203e-05 ## 25 3.308220e-04 1.508203e-05 3.594628e-05 1.508203e-05 2.250000e-02 lambda=solve(sigma)%*%sigma0[25,-25] lambda ## [,1] ## 1 7.588729e-03 ## 2 3.051466e-02 ## 3 7.588729e-03 ## 4 -3.276782e-05 ## 5 1.166265e-04 ## 6 -3.276782e-05 ## 7 -4.212887e-03 ## 8 -1.073644e-02 ## 9 -4.212887e-03 ## 10 -5.666790e-05 ## 11 -9.187561e-05 ## 12 -5.666790e-05 ## 13 -5.543596e-03 ## 14 -4.857869e-03 ## 15 -5.543596e-03 ## 16 -2.212264e-04 ## 17 -4.597041e-04 ## 18 -2.212264e-04 ## 19 1.587928e-02 ## 20 3.629635e-02 ## 21 1.587928e-02 ## 22 7.064917e-04 ## 23 1.685196e-03 ## 24 7.064917e-04 z_pred0=t(lambda)%*%datos1[,4] z_pred0 ## [,1] ## [1,] -0.006131473 VarErropred0=sigma[1,1]-t(sigma0[25,-25])%*%solve(sigma)%*%sigma0[25,-25] VarErropred0 ## [,1] ## [1,] 0.0224392 10.3 Algunas funciones de covarianza espacio temporal no separables ##Funciones de covarianza espacio temporal p vector de parámetros para cada modelo exp_esp_temp=function(h,u,p){((p[1])^2)*exp(-h/p[2]-u/p[3])} gauss_esp_temp=function(h,u,p){(p[1]^2)*exp(-(h/p[2])^2-(u/p[3])^2)} cressie1=function(h,u,p){(p[1]^2/((p[2]^2*u^2+1)))*exp(-(p[3]^2*h^2)/(p[2]^2*u^2+1))} Gneiting1=function(h,u,p){p[1]^2/((p[2]*u^(2*p[3])+1)^(p[4]))*exp(-(p[6]*h^(2*p[5]))/((p[2]*u^(2*p[3])+1)^(p[4]*p[5])))} Gneiting2=function(h,u,sigma,p) {p[1]^2/((2^(p[3]-1))*p[7](p[3])*(p[2]*u^(2*p[3])+1)^(p[4]+p[5]))* (((p[6]*h)/((p[2]*u^(2*p[3])+1)^(p[5]/2)))^p[3])* besselK(((p[6]*h)/((p[2]*u^(2*p[3])+1)^(p[5]/2))),p[3])} Iaco_Cesare=function(h,u,a,b,c){(1+h^p[1]+u^p[2])^(-p[3])} 10.3.1 C R E S S I E - H U A N G (1999) #sigma:desviacion estandar, a es el parámetros de escala del tiempo, b es el parámetros de escala del espacio, d es la dimensión espacial; a,b positivos CH_1=function(h,u,p,d){(p[1]^2/((p[2]^2*u^2+1)^(d/2)))*exp(-(p[3]^2*h^2)/(p[2]^2*u^2+1))} CH_2=function(h,u,p,d){(p[1]^2/((p[2]*abs(u)+1)^(d/2)))*exp(-(p[3]^2*h^2)/(p[2]*abs(u)+1))} CH_3=function(h,u,p,d){p[1]^2*((p[2]^2)*(u^2)+1)/(((p[2]^2)*(u^2)+1)^2+(p[3]^2)*h^2)^((d+1)/2)} CH_4=function(h,u,p,d){p[1]^2*(p[2]*abs(u)+1)/((p[2]*abs(u)+1)^2+(p[3]^2)*h^2)^((d+1)/2)} #el caso mas general de C R E S S I E - H U A N G (1999) es cuando d=2, entonces queda CH_1=function(h,u,p){(p[1]^2/((p[2]^2*u^2+1)))*exp(-(p[3]^2*h^2)/(p[2]^2*u^2+1))} CH_2=function(h,u,p){(p[1]^2/((p[2]*abs(u)+1)))*exp(-(p[3]^2*h^2)/(p[2]*abs(u)+1))} CH_3=function(h,u,p){p[1]^2*((p[2]^2)*(u^2)+1)/(((p[2]^2)*(u^2)+1)^2+(p[3]^2)*h^2)^((3)/2)} CH_4=function(h,u,p){p[1]^2*(p[2]*abs(u)+1)/((p[2]*abs(u)+1)^2+(p[3]^2)*h^2)^((3)/2)} 10.3.2 Gneiting (2002), combina fun1, fun2 y psi en Gneiting #fun1 phi1=function(r,c,gama,v){v*exp(-c*r^gama)} #c&gt;0, 0&lt;gama&lt;=1, siempre v=1 phi2=function(r,c,gama,v){((2^(v-1))*gamma(v))^(-1)*(c*r^0.5)^v*besselK(c*r^0.5,v)} #c&gt;0, v&gt;0 phi3=function(r,c,gama,v){(1+c*r^gama)^(-v)} #c&gt;0, 0&lt;gama&lt;=1, v&gt;0 phi4=function(r,c,gama,v){gama*(2^v)*(exp(c*r^0.5)+exp(-c*r^0.5))^(-v)} #c&gt;0, v&gt;0, siempre gama=1 #fun2 psi1=function(r,a,alpha,beta){(a*r^alpha+1)^beta} #a&gt;0, 0&lt;alpha&lt;=1, 0&lt;=beta&lt;=1 psi2=function(r,a,alpha,beta){log(a*r^alpha+beta)/log(beta)} #a&gt;0, beta&gt;1, 0&lt;alpha&lt;=1 psi3=function(r,a,alpha,beta){(a*r^alpha+beta)/(beta*(a*r^alpha+1))} #a&gt;0, 0&lt;beta&lt;=1 0&lt;alpha&lt;=1 #Cualquier combinación genera una función de covarianza válida Gneiting=function(h,u,sigma,d,a,alpha,beta,c,gama,v,psi,phi){(sigma^2/(psi((abs(u)^2),a,alpha,beta))^(d/2))*phi(h^2/(psi(abs(u)^2,a,alpha,beta)),c,gama,v)} #el caso mas general de Gneiting (2002) es cuando d=2, entonces queda Gneiting=function(h,u,sigma,a,alpha,beta,c,gama,v,psi,phi){(sigma^2/(psi((abs(u)^2),a,alpha,beta)))*phi(h^2/(psi(abs(u)^2,a,alpha,beta)),c,gama,v)} 10.3.2.1 IACO_CESSARE C_IACO_CESSARE=function(h,u,sigma,a,b,alpha,beta,gama){(1 + (h/a)^alpha + (u/b)^beta)^(-gama)} #(Porcu, 2007) Basado en la función de supervivencia de Dagum #función de Dagum Dagum=function(r,lambda,theta,epsilon){1-1/(1+lambda*r^(-theta))^epsilon} #lamdba, theta in (0,7), epsilon in (0,7) Dagumm=function(r,lambda,theta,epsilon){ifelse(r==0,1,Dagum(r,lambda,theta,epsilon))} Porcu_sep=function(h,u,lambda_h,theta_h,epsilon_h,lambda_u,theta_u,epsilon_u){Dagumm(h,lambda_h,theta_h,epsilon_h)*Dagumm(u,lambda_u,theta_u,epsilon_u)} Porcu_Nsep=function(h,u,lambda_h,theta_h,epsilon_h,lambda_u,theta_u,epsilon_u,vartheta){vartheta*Dagumm(h,lambda_h,theta_h,epsilon_h)+(1-vartheta)*Dagumm(u,lambda_u,theta_u,epsilon_u)} "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
