<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Análisis de datos funcionales | Patrones Puntuales</title>
  <meta name="description" content="Chapter 13 Análisis de datos funcionales | Patrones Puntuales" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Análisis de datos funcionales | Patrones Puntuales" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Análisis de datos funcionales | Patrones Puntuales" />
  
  
  

<meta name="author" content="Martha Bohorquez" />


<meta name="date" content="2022-12-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ilustración-del-kriging-simple-espacio-tiempo-1.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cuadernos R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#indice"><i class="fa fa-check"></i><b>1.1</b> Indice</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulación-proceso-espacio-temporal.html"><a href="simulación-proceso-espacio-temporal.html"><i class="fa fa-check"></i><b>2</b> Simulación Proceso Espacio Temporal</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulación-proceso-espacio-temporal.html"><a href="simulación-proceso-espacio-temporal.html#funciones"><i class="fa fa-check"></i><b>2.1</b> Funciones</a></li>
<li class="chapter" data-level="2.2" data-path="simulación-proceso-espacio-temporal.html"><a href="simulación-proceso-espacio-temporal.html#ch-1-no-separable"><i class="fa fa-check"></i><b>2.2</b> CH 1 no separable</a></li>
<li class="chapter" data-level="2.3" data-path="simulación-proceso-espacio-temporal.html"><a href="simulación-proceso-espacio-temporal.html#ch3-no-separable"><i class="fa fa-check"></i><b>2.3</b> CH3 no separable</a></li>
<li class="chapter" data-level="2.4" data-path="simulación-proceso-espacio-temporal.html"><a href="simulación-proceso-espacio-temporal.html#ch-4"><i class="fa fa-check"></i><b>2.4</b> CH 4</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html"><i class="fa fa-check"></i><b>3</b> Spatial modeling leukemia</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#mortality"><i class="fa fa-check"></i><b>3.1</b> <strong>Mortality</strong></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-mortality"><i class="fa fa-check"></i><b>3.1.1</b> <em>Packages Mortality</em></a></li>
<li class="chapter" data-level="3.1.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-mortality"><i class="fa fa-check"></i><b>3.1.2</b> <em>Code Mortality</em></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#incidence"><i class="fa fa-check"></i><b>3.2</b> Incidence</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-incidence"><i class="fa fa-check"></i><b>3.2.1</b> <strong>Packages Incidence</strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-incidence"><i class="fa fa-check"></i><b>3.2.2</b> <em>Code Incidence</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html"><i class="fa fa-check"></i><b>4</b> Modelos de regresión espacial</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#estudio-de-mercadeo"><i class="fa fa-check"></i><b>4.1</b> Estudio de Mercadeo</a></li>
<li class="chapter" data-level="4.2" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#paquetes"><i class="fa fa-check"></i><b>4.2</b> Paquetes</a></li>
<li class="chapter" data-level="4.3" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#lectura-de-datos"><i class="fa fa-check"></i><b>4.3</b> Lectura de Datos</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#cruce-de-información-y-arreglo-de-coordenadas"><i class="fa fa-check"></i><b>4.3.1</b> Cruce de información y arreglo de coordenadas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html"><i class="fa fa-check"></i><b>5</b> Pre-procesamiento de datos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#matriz-de-vecindades"><i class="fa fa-check"></i><b>5.1</b> Matriz de vecindades</a></li>
<li class="chapter" data-level="5.2" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapa-de-valores-observados"><i class="fa fa-check"></i><b>5.2</b> Mapa de valores observados</a></li>
<li class="chapter" data-level="5.3" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#pruebas-de-autocorrelación"><i class="fa fa-check"></i><b>5.3</b> Pruebas de Autocorrelación</a></li>
<li class="chapter" data-level="5.4" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapas"><i class="fa fa-check"></i><b>5.4</b> Mapas</a></li>
<li class="chapter" data-level="5.5" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#resumen-de-modelos"><i class="fa fa-check"></i><b>5.5</b> Resumen de modelos</a></li>
<li class="chapter" data-level="5.6" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#calculo-de-varibles-significativas"><i class="fa fa-check"></i><b>5.6</b> Calculo de varibles significativas</a></li>
<li class="chapter" data-level="5.7" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapa-estimado"><i class="fa fa-check"></i><b>5.7</b> Mapa Estimado</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html"><i class="fa fa-check"></i><b>6</b> Ilustración del kriging simple espacio tiempo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#librerías"><i class="fa fa-check"></i><b>6.1</b> librerías</a></li>
<li class="chapter" data-level="6.2" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#simulación-no-condicional-de-una-realización-de-un-campo-aleatorio-espacio-temporal-no-separable-usando-el-modelo-de-covarianza-cressie1"><i class="fa fa-check"></i><b>6.2</b> <strong>Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1</strong></a></li>
<li class="chapter" data-level="6.3" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#algunas-funciones-de-covarianza-espacio-temporal-no-separables"><i class="fa fa-check"></i><b>6.3</b> <strong>Algunas funciones de covarianza espacio temporal no separables</strong></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#c-r-e-s-s-i-e---h-u-a-n-g-1999"><i class="fa fa-check"></i><b>6.3.1</b> C R E S S I E - H U A N G (1999)</a></li>
<li class="chapter" data-level="6.3.2" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#gneiting-2002-combina-fun1-fun2-y-psi-en-gneiting"><i class="fa fa-check"></i><b>6.3.2</b> Gneiting (2002), combina fun1, fun2 y psi en Gneiting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html"><i class="fa fa-check"></i><b>7</b> Pulimiento de medianas</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#cargar-librerias"><i class="fa fa-check"></i><b>7.1</b> Cargar librerias</a></li>
<li class="chapter" data-level="7.2" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#grilla-de-las-ubicaciones-espaciales."><i class="fa fa-check"></i><b>7.2</b> Grilla de las ubicaciones espaciales.</a></li>
<li class="chapter" data-level="7.3" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#definición-de-objeto-vgm"><i class="fa fa-check"></i><b>7.3</b> Definición de objeto VGM</a></li>
<li class="chapter" data-level="7.4" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#matriz-de-varianza-dadas-coordenadas."><i class="fa fa-check"></i><b>7.4</b> Matriz de varianza dadas coordenadas.</a></li>
<li class="chapter" data-level="7.5" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#simulación."><i class="fa fa-check"></i><b>7.5</b> Simulación.</a></li>
<li class="chapter" data-level="7.6" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#pulimiento-de-medianas-1"><i class="fa fa-check"></i><b>7.6</b> Pulimiento de medianas</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html"><i class="fa fa-check"></i><b>8</b> Introducción proceso espacial bivariado</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#librerías-1"><i class="fa fa-check"></i><b>8.1</b> Librerías</a></li>
<li class="chapter" data-level="8.2" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#ubicaciones-en-este-caso-se-supone-que-ambos-procesos-están-observados-en-los-mismos-lugares"><i class="fa fa-check"></i><b>8.2</b> Ubicaciones: En este caso se supone que ambos procesos están observados en los mismos lugares</a></li>
<li class="chapter" data-level="8.3" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#modelo-lineal-de-coregionalización"><i class="fa fa-check"></i><b>8.3</b> Modelo lineal de coregionalización</a></li>
<li class="chapter" data-level="8.4" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#simulación-de-un-proceso-espacial-gaussiano-bivariado"><i class="fa fa-check"></i><b>8.4</b> Simulación de un proceso espacial Gaussiano bivariado</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html"><i class="fa fa-check"></i><b>9</b> Geoestadística con sgeostat</a>
<ul>
<li class="chapter" data-level="9.1" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#data-load"><i class="fa fa-check"></i><b>9.1</b> Data Load</a></li>
<li class="chapter" data-level="9.2" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#libraries"><i class="fa fa-check"></i><b>9.2</b> Libraries</a></li>
<li class="chapter" data-level="9.3" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#including-plots"><i class="fa fa-check"></i><b>9.3</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cokriging.html"><a href="cokriging.html"><i class="fa fa-check"></i><b>10</b> Cokriging</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cokriging.html"><a href="cokriging.html#librerías-2"><i class="fa fa-check"></i><b>10.1</b> Librerías</a></li>
<li class="chapter" data-level="10.2" data-path="cokriging.html"><a href="cokriging.html#descripción-de-los-datos"><i class="fa fa-check"></i><b>10.2</b> Descripción de los datos</a></li>
<li class="chapter" data-level="10.3" data-path="cokriging.html"><a href="cokriging.html#matrices-de-coregionalización."><i class="fa fa-check"></i><b>10.3</b> Matrices de coregionalización.</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="cokriging.html"><a href="cokriging.html#matriz-definida-positiva-para-el-modelo-esférico."><i class="fa fa-check"></i><b>10.3.1</b> Matriz definida positiva para el modelo Esférico.</a></li>
<li class="chapter" data-level="10.3.2" data-path="cokriging.html"><a href="cokriging.html#matriz-definida-positiva-para-el-modelo-efecto-hueco."><i class="fa fa-check"></i><b>10.3.2</b> Matriz definida positiva para el modelo efecto Hueco.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="cokriging.html"><a href="cokriging.html#definición-de-objeto-en-gstat"><i class="fa fa-check"></i><b>10.4</b> Definición de objeto en gstat</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="cokriging.html"><a href="cokriging.html#semivariogramas-univariados"><i class="fa fa-check"></i><b>10.4.1</b> Semivariogramas univariados</a></li>
<li class="chapter" data-level="10.4.2" data-path="cokriging.html"><a href="cokriging.html#semivarogramas-cruzados-bivariados"><i class="fa fa-check"></i><b>10.4.2</b> Semivarogramas cruzados (Bivariados)</a></li>
<li class="chapter" data-level="10.4.3" data-path="cokriging.html"><a href="cokriging.html#gstat"><i class="fa fa-check"></i><b>10.4.3</b> gstat</a></li>
<li class="chapter" data-level="10.4.4" data-path="cokriging.html"><a href="cokriging.html#estimación-del-semivariograma"><i class="fa fa-check"></i><b>10.4.4</b> Estimación del semivariograma</a></li>
<li class="chapter" data-level="10.4.5" data-path="cokriging.html"><a href="cokriging.html#mapas-de-predicción-de-o3-con-las-covariables-espaciales-no2-y-nox"><i class="fa fa-check"></i><b>10.4.5</b> Mapas de predicción de O3 con las covariables espaciales NO2 y NOX</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html"><i class="fa fa-check"></i><b>11</b> Introducción al proceso espacial bivariado</a>
<ul>
<li class="chapter" data-level="11.1" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html#dependencias"><i class="fa fa-check"></i><b>11.1</b> Dependencias</a></li>
<li class="chapter" data-level="11.2" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html#ubicaciones"><i class="fa fa-check"></i><b>11.2</b> Ubicaciones:</a></li>
<li class="chapter" data-level="11.3" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html#modelo-lineal-de-coregionalización-1"><i class="fa fa-check"></i><b>11.3</b> Modelo lineal de coregionalización</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html#determinante-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>11.3.1</b> Determinante de la matriz de covarianzas</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="introducción-al-proceso-espacial-bivariado.html"><a href="introducción-al-proceso-espacial-bivariado.html#simulación-de-un-proceso-espacial-gaussiano-bivariado-1"><i class="fa fa-check"></i><b>11.4</b> simulación de un proceso espacial Gaussiano bivariado</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html"><i class="fa fa-check"></i><b>12</b> Ilustración del kriging simple espacio tiempo</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#dependencias-1"><i class="fa fa-check"></i><b>12.1</b> Dependencias</a></li>
<li class="chapter" data-level="12.2" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#simulación-no-condicional-de-una-realización-de-un-campo-aleatorio-espacio-temporal-no-separable-usando-el-modelo-de-covarianza-cressie1-1"><i class="fa fa-check"></i><b>12.2</b> Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1</a></li>
<li class="chapter" data-level="12.3" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#algunas-funciones-de-covarianza-espacio-temporal-no-separables-1"><i class="fa fa-check"></i><b>12.3</b> Algunas funciones de covarianza espacio temporal no separables</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#c-r-e-s-s-i-e---h-u-a-n-g-1999-1"><i class="fa fa-check"></i><b>12.3.1</b> C R E S S I E - H U A N G (1999)</a></li>
<li class="chapter" data-level="12.3.2" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#gneiting-2002-combina-fun1-fun2-y-psi-en-gneiting-1"><i class="fa fa-check"></i><b>12.3.2</b> Gneiting (2002), combina fun1, fun2 y psi en Gneiting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html"><i class="fa fa-check"></i><b>13</b> Análisis de datos funcionales</a>
<ul>
<li class="chapter" data-level="13.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-exploratorio"><i class="fa fa-check"></i><b>13.1</b> Análisis de datos funcionales (ADF) - Análisis exploratorio</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#datos-funcionales"><i class="fa fa-check"></i><b>13.1.1</b> Datos funcionales</a></li>
<li class="chapter" data-level="13.1.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-gráfico-y-detección-de-outliers"><i class="fa fa-check"></i><b>13.1.2</b> Análisis gráfico y detección de outliers</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-gráfico"><i class="fa fa-check"></i><b>13.2</b> Análisis de datos funcionales (ADF) - Análisis gráfico</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#deteccción-de-curvas-atípicas"><i class="fa fa-check"></i><b>13.2.1</b> Deteccción de curvas atípicas</a></li>
<li class="chapter" data-level="13.2.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#otras-medidas-de-resumen"><i class="fa fa-check"></i><b>13.2.2</b> Otras medidas de resumen</a></li>
<li class="chapter" data-level="13.2.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-en-componentes-principales-acpf"><i class="fa fa-check"></i><b>13.2.3</b> Análisis en Componentes Principales (ACPF)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#modelos-lineales"><i class="fa fa-check"></i><b>13.3</b> Modelos lineales</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-escalar"><i class="fa fa-check"></i><b>13.3.1</b> Regresión lineal funcional con respuesta escalar</a></li>
<li class="chapter" data-level="13.3.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estimación-de-los-coeficientes-beta-con-regularización"><i class="fa fa-check"></i><b>13.3.2</b> Estimación de los coeficientes <span class="math inline">\(\beta\)</span> con regularización</a></li>
<li class="chapter" data-level="13.3.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#prueba-f-para-ajuste-del-modelo-a-través-de-permutaciones"><i class="fa fa-check"></i><b>13.3.3</b> Prueba <span class="math inline">\(F\)</span> para ajuste del modelo a través de permutaciones</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#modelos-lineales-funcionales-regresión-funcional"><i class="fa fa-check"></i><b>13.4</b> Modelos lineales funcionales (Regresión Funcional)</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-funcional-anova-funcional"><i class="fa fa-check"></i><b>13.4.1</b> Regresión lineal funcional con respuesta funcional (ANOVA Funcional)</a></li>
<li class="chapter" data-level="13.4.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estimación---mínimos-cuadrados-ordinarios"><i class="fa fa-check"></i><b>13.4.2</b> Estimación - Mínimos cuadrados ordinarios</a></li>
<li class="chapter" data-level="13.4.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#pruebas-de-hipótesis---prueba-de-shen-faraway"><i class="fa fa-check"></i><b>13.4.3</b> Pruebas de hipótesis - Prueba de Shen &amp; Faraway</a></li>
<li class="chapter" data-level="13.4.4" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#ejemplo"><i class="fa fa-check"></i><b>13.4.4</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estadística-espacial"><i class="fa fa-check"></i><b>13.5</b> Estadística Espacial</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#metodología-de-predicción-espacial-con-datos-funcionales"><i class="fa fa-check"></i><b>13.5.1</b> Metodología de predicción espacial con datos funcionales</a></li>
<li class="chapter" data-level="13.5.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#ilustración"><i class="fa fa-check"></i><b>13.5.2</b> Ilustración</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#patrones-puntuales"><i class="fa fa-check"></i><b>13.6</b> Patrones Puntuales</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#datos"><i class="fa fa-check"></i><b>13.6.1</b> Datos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Patrones Puntuales</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="análisis-de-datos-funcionales" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Análisis de datos funcionales<a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="análisis-de-datos-funcionales-adf---análisis-exploratorio" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Análisis de datos funcionales (ADF) - Análisis exploratorio<a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-exploratorio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="datos-funcionales" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Datos funcionales<a href="análisis-de-datos-funcionales.html#datos-funcionales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="descripción" class="section level4 hasAnchor" number="13.1.1.1">
<h4><span class="header-section-number">13.1.1.1</span> Descripción<a href="análisis-de-datos-funcionales.html#descripción" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Los desarrollos tecnólogicos han hecho posible que los investigadores de muchas áreas dispongan de grandes volúmenes de información para un mismo individuo. Usualmente éstos datos pueden ser representados a través de curvas o en general de funciones.</p>
<p>En el ADF la unidad básica de información es la función completa, más que un conjunto de valores (Ramsay and Dalzell, 1991), es decir, que un dato funcional se puede establecer como la extensión de medidas repetidas cuando la cantidad de mediciones (<span class="math inline">\(M\)</span>) en un determinado individuo es muy grande.</p>
<p>Ferraty and Vieu (2006) definen una variable aleatoria funcional <span class="math inline">\(\chi\)</span>, como una variable aleatoria que toma valores en un espacio de funciones, es decir, un espacio infinito dimensional (espacio funcional). Una observación <span class="math inline">\(x\)</span> de la variable aleatoria <span class="math inline">\(\chi\)</span> se denomina dato funcional.</p>
<p>Un conjunto de datos funcionales <span class="math inline">\(x_1, x_2, ..., x_n\)</span> es la observación de <span class="math inline">\(n\)</span> variables funcionales distribuidas como <span class="math inline">\(\chi\)</span>. Un dato funcional <span class="math inline">\(x_i(t), t ∈ T = [a, b] ⊂ R\)</span>, es representado usualmente como un conjunto finito de pares <span class="math inline">\((t_j, x_{ij})\)</span> con <span class="math inline">\(t_j\)</span> <span class="math inline">\(\in\)</span> <span class="math inline">\(T\)</span>, <span class="math inline">\(j = 1, 2, ..., M\)</span>, dónde <span class="math inline">\(M\)</span> representa la cantidad de puntos en los cuales es observada la variable de interés y <span class="math inline">\(y_{ij} = \chi_i(t_j)\)</span> (si no existe error observacional) o <span class="math inline">\(y_{ij} = \chi_i(t_j) + ε_j\)</span> (en caso contrario).</p>
<p>Por ejemplo, consideremos la temperatura promedio mensual de la superficie del océano en grados Celsius, registrada desde Enero de 1982 a Abril de 2022, disponible en:<a href="https://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices" class="uri">https://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices</a>.</p>
<p>Realizamos la lectura de los datos:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="análisis-de-datos-funcionales.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb454-2"><a href="análisis-de-datos-funcionales.html#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda.usc)</span>
<span id="cb454-3"><a href="análisis-de-datos-funcionales.html#cb454-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rainbow)</span>
<span id="cb454-4"><a href="análisis-de-datos-funcionales.html#cb454-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb454-5"><a href="análisis-de-datos-funcionales.html#cb454-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb454-6"><a href="análisis-de-datos-funcionales.html#cb454-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-7"><a href="análisis-de-datos-funcionales.html#cb454-7" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">=</span><span class="fu">read.delim2</span>(<span class="st">&quot;data_11_PatronesPuntuales/1_AnalisisExploratorio/sstoi.indices1.txt&quot;</span>,<span class="at">header=</span>T,<span class="at">dec=</span><span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb454-8"><a href="análisis-de-datos-funcionales.html#cb454-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Datos)</span></code></pre></div>
<pre><code>##        YR            MON            NINO1.2           ANOM              NINO3           ANOM.1        
##  Min.   :1982   Min.   : 1.000   Min.   :19.06   Min.   :-1.90000   Min.   :23.38   Min.   :-2.16000  
##  1st Qu.:1992   1st Qu.: 3.000   1st Qu.:21.23   1st Qu.:-0.73250   1st Qu.:25.00   1st Qu.:-0.65000  
##  Median :2002   Median : 6.000   Median :23.14   Median :-0.23500   Median :25.93   Median :-0.15000  
##  Mean   :2002   Mean   : 6.467   Mean   :23.25   Mean   :-0.05118   Mean   :25.97   Mean   :-0.06033  
##  3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:25.22   3rd Qu.: 0.44000   3rd Qu.:26.89   3rd Qu.: 0.42000  
##  Max.   :2022   Max.   :12.000   Max.   :28.51   Max.   : 4.03000   Max.   :28.81   Max.   : 3.07000  
##      NINO4           ANOM.2            NINO3.4          ANOM.3        
##  Min.   :26.36   Min.   :-1.87000   Min.   :24.56   Min.   :-2.22000  
##  1st Qu.:28.02   1st Qu.:-0.55250   1st Qu.:26.35   1st Qu.:-0.65250  
##  Median :28.57   Median :-0.00500   Median :27.07   Median :-0.11000  
##  Mean   :28.46   Mean   :-0.08946   Mean   :27.02   Mean   :-0.06878  
##  3rd Qu.:28.98   3rd Qu.: 0.38000   3rd Qu.:27.69   3rd Qu.: 0.45000  
##  Max.   :30.22   Max.   : 1.55000   Max.   :29.54   Max.   : 2.72000</code></pre>
<p>Reorganizamos la información para que cada año sea una curva. No tenemos en cuenta el año 2022 por no disponer de la información de todo el año.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="análisis-de-datos-funcionales.html#cb456-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(Datos<span class="sc">$</span>NINO1<span class="fl">.2</span>[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">481</span><span class="sc">:</span><span class="dv">484</span>)], <span class="at">nrow=</span><span class="dv">12</span>, <span class="dv">40</span>)</span>
<span id="cb456-2"><a href="análisis-de-datos-funcionales.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2021</span>)</span></code></pre></div>
<p>Construimos las gráficas para cada año</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="análisis-de-datos-funcionales.html#cb457-1" aria-hidden="true" tabindex="-1"></a>month<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb457-2"><a href="análisis-de-datos-funcionales.html#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(month, temp[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">30</span>), <span class="at">xlab=</span><span class="st">&quot;Mes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;temperatura&quot;</span>)</span>
<span id="cb457-3"><a href="análisis-de-datos-funcionales.html#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(temp))</span>
<span id="cb457-4"><a href="análisis-de-datos-funcionales.html#cb457-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(month, temp[,i], <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span>i)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/pressure01-1.png" width="672" /></p>
</div>
<div id="suavizamiento-de-curvas" class="section level4 hasAnchor" number="13.1.1.2">
<h4><span class="header-section-number">13.1.1.2</span> Suavizamiento de curvas<a href="análisis-de-datos-funcionales.html#suavizamiento-de-curvas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Una herramienta no paramétrica de mucha utilidad en el ADF es el suavizado de curvas a través de funciones. El procedimiento consiste en aproximar las funciones del espacio considerado a través de (Ramsay and Silverman, 2005):</p>
<p><span class="math display">\[\begin{equation}
\chi(t) = \sum_{l=1}^K c_lB_l(t) = c&#39;B(t)
\end{equation}\]</span>
dónde K es el número de funciones de la base.</p>
<p>En la literatura exisste varias funciones base que permiten desarrollar la expansión. La selección del tipo de funciones de la base depende de las caracteríticas que cumpla que fenómeno de estudio. Por ejemplo, las series de Fourier se utilizan para funciones con comportamientos cíclicos o periódicos y las bases monomiales se utilizan cuando existen tendencias simples que pueden ser ajustadas mediante líneas rectas, polinomios cuadráticos, polinomios de orden superior, etc. Las bases más usuales son aquellas basadas en splines debido a que son más flexibles y se ajustan de mejor manera a diferentes comportamientos. Dentro de estas se encuentran B-splines, M-splines, I-splines, y fucniones de potencia truncadas.</p>
<div id="bases-monomiales" class="section level5 hasAnchor" number="13.1.1.2.1">
<h5><span class="header-section-number">13.1.1.2.1</span> Bases monomiales<a href="análisis-de-datos-funcionales.html#bases-monomiales" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Las bases monomiales requieren el dominio y el número de base. Por ejemplo, la base monomial con K=6 funciones de base definidas en el intervalo [0,1] se puede construir con:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="análisis-de-datos-funcionales.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb458-2"><a href="análisis-de-datos-funcionales.html#cb458-2" aria-hidden="true" tabindex="-1"></a>bbasis_obj <span class="ot">=</span> <span class="fu">create.monomial.basis</span>(<span class="at">rangeval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nbasis =</span> <span class="dv">6</span>)</span></code></pre></div>
<p>Esto devolverá una salida de “funciones”. Para evaluar las bases en una cuadrícula de puntos <span class="math inline">\(s\)</span>, debemos:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="análisis-de-datos-funcionales.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb459-2"><a href="análisis-de-datos-funcionales.html#cb459-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb459-3"><a href="análisis-de-datos-funcionales.html#cb459-3" aria-hidden="true" tabindex="-1"></a>bbasisevals <span class="ot">&lt;-</span> <span class="fu">eval.basis</span>(x, bbasis_obj)</span>
<span id="cb459-4"><a href="análisis-de-datos-funcionales.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(basisevals)</span></span>
<span id="cb459-5"><a href="análisis-de-datos-funcionales.html#cb459-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(x, bbasisevals, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">6</span>),</span>
<span id="cb459-6"><a href="análisis-de-datos-funcionales.html#cb459-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;bases&quot;</span>, </span>
<span id="cb459-7"><a href="análisis-de-datos-funcionales.html#cb459-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;base monomial con k = 6&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars04-1.png" width="672" /></p>
</div>
<div id="bases-de-fourier" class="section level5 hasAnchor" number="13.1.1.2.2">
<h5><span class="header-section-number">13.1.1.2.2</span> Bases de Fourier<a href="análisis-de-datos-funcionales.html#bases-de-fourier" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Para utilizarlas bases de Fourier se requiere que se defina el dominio, el período de oscilación y el número de funciones de base.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="análisis-de-datos-funcionales.html#cb460-1" aria-hidden="true" tabindex="-1"></a>fbasis_obj <span class="ot">&lt;-</span> <span class="fu">create.fourier.basis</span>(<span class="at">rangeval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb460-2"><a href="análisis-de-datos-funcionales.html#cb460-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nbasis=</span><span class="dv">65</span>, <span class="at">period =</span> <span class="dv">1</span>)</span>
<span id="cb460-3"><a href="análisis-de-datos-funcionales.html#cb460-3" aria-hidden="true" tabindex="-1"></a>fbasisevals <span class="ot">&lt;-</span> <span class="fu">eval.basis</span>(x, fbasis_obj)</span>
<span id="cb460-4"><a href="análisis-de-datos-funcionales.html#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(x, fbasisevals[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">3</span>),</span>
<span id="cb460-5"><a href="análisis-de-datos-funcionales.html#cb460-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;bases&quot;</span>, </span>
<span id="cb460-6"><a href="análisis-de-datos-funcionales.html#cb460-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Primeras tres bases de Fourier&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars05-1.png" width="672" /></p>
</div>
<div id="b-splines" class="section level5 hasAnchor" number="13.1.1.2.3">
<h5><span class="header-section-number">13.1.1.2.3</span> B-splines<a href="análisis-de-datos-funcionales.html#b-splines" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Las bases B-spline requieren el dominio, el número de funciones de la base y el orden.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="análisis-de-datos-funcionales.html#cb461-1" aria-hidden="true" tabindex="-1"></a>bsbasis_obj <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb461-2"><a href="análisis-de-datos-funcionales.html#cb461-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">nbasis=</span><span class="dv">10</span>, <span class="at">norder=</span><span class="dv">4</span>)</span>
<span id="cb461-3"><a href="análisis-de-datos-funcionales.html#cb461-3" aria-hidden="true" tabindex="-1"></a>bsbasisevals <span class="ot">&lt;-</span> <span class="fu">eval.basis</span>(x, bsbasis_obj)</span>
<span id="cb461-4"><a href="análisis-de-datos-funcionales.html#cb461-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(x, bsbasisevals, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">15</span>),</span>
<span id="cb461-5"><a href="análisis-de-datos-funcionales.html#cb461-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;bases&quot;</span>, </span>
<span id="cb461-6"><a href="análisis-de-datos-funcionales.html#cb461-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;B-spline cubica con K = 10&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars06-1.png" width="672" /></p>
</div>
<div id="otras-bases" class="section level5 hasAnchor" number="13.1.1.2.4">
<h5><span class="header-section-number">13.1.1.2.4</span> Otras bases<a href="análisis-de-datos-funcionales.html#otras-bases" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>El paquete también se puede usar para construir otros tipos de bases. Para revisar la lista de bases disponibles se puede utilizar $ ?create. + tab$</p>
</div>
<div id="suavizamiento-de-la-temperatura" class="section level5 hasAnchor" number="13.1.1.2.5">
<h5><span class="header-section-number">13.1.1.2.5</span> Suavizamiento de la temperatura<a href="análisis-de-datos-funcionales.html#suavizamiento-de-la-temperatura" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>La temperatura es una variable que se puede tomar en intervalos más pequeños (diaria, cada hora, etc). Es decir, al realizar la gráfica anterior estamos suponiendo que podemos discretizar la variable de temperatura a través de la medición mensual.La primera tarea es convertir estos valores discretos en una función que puede tomar valores en cualquier valor de argumento deseado <span class="math inline">\(x_i(t)\)</span>. Si se supone que estas observaciones no presentan un término de error asociado, el proceso de generación de la función (curva) será un proceso de interpolación, pero si tienen algún
error observacional que necesita modelarse, entonces la conversión de datos (finitos) a funciones (que teóricamente se pueden evaluar en un número infinito de puntos) se enmarca en los procesos de suavizamiento.</p>
<p>En consecuencia, requerimos una estrategia para construir funciones con parámetros que sean fáciles de estimar y que puedan ajustarse casi a cualquier característica de la curva. Por otro lado, no queremos usar más parámetros de los que necesitamos, ya que hacerlo aumentaría en gran medida el tiempo de cálculo y complicar los análisis. Para el caso de la temperatura se utiliza una B-spline de orden 4.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="análisis-de-datos-funcionales.html#cb462-1" aria-hidden="true" tabindex="-1"></a>BSpl <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">norder=</span><span class="dv">4</span>, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="at">length=</span><span class="dv">5</span>))</span>
<span id="cb462-2"><a href="análisis-de-datos-funcionales.html#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BSpl)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars07-1.png" width="672" /></p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="análisis-de-datos-funcionales.html#cb463-1" aria-hidden="true" tabindex="-1"></a>Ftemp <span class="ot">&lt;-</span> <span class="fu">Data2fd</span>(temp, <span class="at">basisobj=</span>BSpl)</span></code></pre></div>
<pre><code>## &#39;y&#39; is missing, using &#39;argvals&#39;
## &#39;argvals&#39; is missing;  using seq( 0 ,  12 , length= 12 )</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="análisis-de-datos-funcionales.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Ftemp, <span class="at">main=</span><span class="st">&quot;Datos suavizados de la Temperatura&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>,</span>
<span id="cb465-2"><a href="análisis-de-datos-funcionales.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">30</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars07-2.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
<p>En el proceso de suavizamiento es necesario tener en cuenta la rugosidad como un aspecto fundamental. El método utilizado para aproximar funciones mediante una base de funciones B-splines se basa en minimizar el sistema:</p>
<p><span class="math display">\[\begin{equation}
GCV = \min_c \sum_{j =1}^M (y_j - S(t_j))^2 + \lambda\int_t (S&#39;&#39;(t)dt)
\end{equation}\]</span></p>
<p>con <span class="math inline">\(\lambda\)</span> un parámetro de penalización para disminuir la variabilidad del ajuste. El número de funciones base (K) y el coeficiente <span class="math inline">\(\lambda\)</span> son estimados a través de procedimientos de validación cruzada
(Ramsay and Silverman, 2005). Con el siguiente programa se puede establecer la estimación del parámetro de suavizamiento óptimo.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="análisis-de-datos-funcionales.html#cb467-1" aria-hidden="true" tabindex="-1"></a>loglam <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.05</span>,<span class="fl">0.001</span>)</span>
<span id="cb467-2"><a href="análisis-de-datos-funcionales.html#cb467-2" aria-hidden="true" tabindex="-1"></a>nlam <span class="ot">=</span> <span class="fu">length</span>(loglam)</span>
<span id="cb467-3"><a href="análisis-de-datos-funcionales.html#cb467-3" aria-hidden="true" tabindex="-1"></a>dfsave <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,nlam)</span>
<span id="cb467-4"><a href="análisis-de-datos-funcionales.html#cb467-4" aria-hidden="true" tabindex="-1"></a>gcvsave <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,nlam)</span>
<span id="cb467-5"><a href="análisis-de-datos-funcionales.html#cb467-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ilam <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nlam) {</span>
<span id="cb467-6"><a href="análisis-de-datos-funcionales.html#cb467-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> loglam[ilam]</span>
<span id="cb467-7"><a href="análisis-de-datos-funcionales.html#cb467-7" aria-hidden="true" tabindex="-1"></a>fdParobj <span class="ot">=</span> <span class="fu">fdPar</span>(BSpl, <span class="at">Lfdobj=</span><span class="cn">NULL</span>, <span class="at">lambda=</span> lambda)</span>
<span id="cb467-8"><a href="análisis-de-datos-funcionales.html#cb467-8" aria-hidden="true" tabindex="-1"></a>smoothlist <span class="ot">=</span> <span class="fu">smooth.basis</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, temp, fdParobj)</span>
<span id="cb467-9"><a href="análisis-de-datos-funcionales.html#cb467-9" aria-hidden="true" tabindex="-1"></a>dfsave[ilam] <span class="ot">=</span> smoothlist<span class="sc">$</span>df</span>
<span id="cb467-10"><a href="análisis-de-datos-funcionales.html#cb467-10" aria-hidden="true" tabindex="-1"></a>gcvsave[ilam] <span class="ot">=</span> <span class="fu">sum</span>(smoothlist<span class="sc">$</span>gcv)</span>
<span id="cb467-11"><a href="análisis-de-datos-funcionales.html#cb467-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb467-12"><a href="análisis-de-datos-funcionales.html#cb467-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(loglam,gcvsave,<span class="at">xlab=</span><span class="fu">expression</span>(lambda),<span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">GCV</span>(lambda)),</span>
<span id="cb467-13"><a href="análisis-de-datos-funcionales.html#cb467-13" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;Parámetros de suavizamiento versus GCV&quot;</span>,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars08-1.png" width="672" /></p>
<p>Tomando como referencia los 40 añoos reportados (de 1982 a 2021) en la base de datos de interés, se evidencia que el punto que minimiza la estadística GCV se encuentra alrededor de <span class="math inline">\(\nu\)</span> = 0.017 con valores muy superiores antes de 0.01 y después de 0.04. Se destaca que dicho parámetro minimiza la suma del criterio GCV de todas las 40 curvas que se encuentran dentro de la muestra, es decir, el valor de dicho parámetro resulta ser el óptimo en relación con el proceso de suavizamiento de todas las curvas dentro de la muestra.</p>
</div>
</div>
<div id="estadística-descriptiva" class="section level4 hasAnchor" number="13.1.1.3">
<h4><span class="header-section-number">13.1.1.3</span> Estadística descriptiva<a href="análisis-de-datos-funcionales.html#estadística-descriptiva" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dado un conjunto de datos funcionales <span class="math inline">\(x_1, x_2, ..., x_n\)</span> definidos en <span class="math inline">\(t ⊂ T ∈ R\)</span>, las correspondientes funciones descriptivas están dadas por las expresiones (Ramsay and Silverman, 2005):</p>
<p><span class="math inline">\(Media:\bar{\chi}(t) = \frac{\sum_{i=1}^n \chi_i(t)}{n}\)</span></p>
<p><span class="math inline">\(Varianza: Var(\chi(t)) = \frac{\sum_{i=1}^n (\chi_i(t) - \bar{\chi}(t))^2}{n}\)</span></p>
<p><span class="math inline">\(Desviación estándar: \sigma(\chi(t)) = \sqrt{var(\chi(t)}\)</span></p>
<p>Así, se puede concluir que las estadísticas descriptivas univariadas clásicas se
aplican igualmente cuando se tienen datos funcionales. Sin embargo se resalta que en este
caso, los objetos calculados corresponden a curvas.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="análisis-de-datos-funcionales.html#cb468-1" aria-hidden="true" tabindex="-1"></a>meanfdh <span class="ot">&lt;-</span> <span class="fu">mean.fd</span>(Ftemp)</span>
<span id="cb468-2"><a href="análisis-de-datos-funcionales.html#cb468-2" aria-hidden="true" tabindex="-1"></a>varfdh <span class="ot">&lt;-</span><span class="fu">var.fd</span>(Ftemp)</span>
<span id="cb468-3"><a href="análisis-de-datos-funcionales.html#cb468-3" aria-hidden="true" tabindex="-1"></a>stdvfdh <span class="ot">&lt;-</span> <span class="fu">stddev.fd</span>(Ftemp)</span>
<span id="cb468-4"><a href="análisis-de-datos-funcionales.html#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Ftemp,<span class="at">col=</span><span class="dv">8</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="análisis-de-datos-funcionales.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(meanfdh,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars09-1.png" width="672" /></p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="análisis-de-datos-funcionales.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb471-2"><a href="análisis-de-datos-funcionales.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(varfdh, <span class="at">main=</span><span class="st">&quot; Superficie de varianza&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars09-2.png" width="672" /></p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="análisis-de-datos-funcionales.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stdvfdh, <span class="at">main=</span><span class="st">&quot;Desviación estándar&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars09-3.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
</div>
</div>
<div id="análisis-gráfico-y-detección-de-outliers" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Análisis gráfico y detección de outliers<a href="análisis-de-datos-funcionales.html#análisis-gráfico-y-detección-de-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es posible realizar detección de datos atípicos (outliers) a través de las herramientas: bagplot, HDR y boxplot para datos funcionales.</p>
<p>Con respecto a la base de datos de la temperatura, utilizando las profundidades dadas a través del criterio de bagplot, se muestran nueves curvas atípicas. La identicación de las curvas se encuentra en la parte superior del panel izquierdo de la siguiente figura. Se destaca, que el factor de inflación utilizado en este caso toma el valor de 1.96 que es el establecido por defecto en la función tipo bag.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="análisis-de-datos-funcionales.html#cb474-1" aria-hidden="true" tabindex="-1"></a>TempTs <span class="ot">=</span> <span class="fu">sfts</span>(<span class="fu">ts</span>(<span class="fu">as.numeric</span>(temp), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1982</span>,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>), <span class="at">xname =</span> <span class="st">&quot;Mes&quot;</span>,</span>
<span id="cb474-2"><a href="análisis-de-datos-funcionales.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="at">yname =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span>
<span id="cb474-3"><a href="análisis-de-datos-funcionales.html#cb474-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb474-4"><a href="análisis-de-datos-funcionales.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;functional&quot;</span>, <span class="at">type =</span> <span class="st">&quot;bag&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>)</span>
<span id="cb474-5"><a href="análisis-de-datos-funcionales.html#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;bivariate&quot;</span>, <span class="at">type =</span> <span class="st">&quot;bag&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>,</span>
<span id="cb474-6"><a href="análisis-de-datos-funcionales.html#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars10-1.png" width="672" /></p>
<p>Análogamente, teniendo en cuenta la profundidad a través del criterio de HDR plot, se evidencian dos curvas atípicasicas identificadas con los años 1997 y 2015. Para este caso los porcentajes de cobertura de los datos atipicos y de la región central tenidos en cuenta fueron los establecidos por defecto en la respectiva función (0.05, 0.5).</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="análisis-de-datos-funcionales.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb475-2"><a href="análisis-de-datos-funcionales.html#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;functional&quot;</span>, <span class="at">type =</span> <span class="st">&quot;hdr&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>)</span>
<span id="cb475-3"><a href="análisis-de-datos-funcionales.html#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;bivariate&quot;</span>, <span class="at">type =</span> <span class="st">&quot;hdr&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>,</span>
<span id="cb475-4"><a href="análisis-de-datos-funcionales.html#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars11-1.png" width="672" /></p>
<p>Finalmente, al utilizar la herramienta del boxplot funcional, teniendo en cuenta la profundidad dada por la versión modificada de Band-depth, existe una curva atípica (1990). La probabilidad de la región central utilizada para realizar el gráfico fue de 0.5.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="análisis-de-datos-funcionales.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb476-2"><a href="análisis-de-datos-funcionales.html#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fbplot</span>(<span class="at">fit=</span> temp, <span class="at">method =</span> <span class="st">&quot;BD2&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars12-1.png" width="672" /></p>
<pre><code>## $depth
##       1982       1983       1984       1985       1986       1987       1988       1989       1990       1991 
## 0.05000000 0.05000000 0.09871795 0.05000000 0.12179487 0.20384615 0.05000000 0.13205128 0.23846154 0.07820513 
##       1992       1993       1994       1995       1996       1997       1998       1999       2000       2001 
## 0.09102564 0.21153846 0.06666667 0.10384615 0.05000000 0.05000000 0.05000000 0.06923077 0.13717949 0.12051282 
##       2002       2003       2004       2005       2006       2007       2008       2009       2010       2011 
## 0.10641026 0.06025641 0.10384615 0.06282051 0.06538462 0.05000000 0.10769231 0.13653846 0.06153846 0.13974359 
##       2012       2013       2014       2015       2016       2017       2018       2019       2020       2021 
## 0.09102564 0.05000000 0.05512821 0.05769231 0.11666667 0.05256410 0.07243590 0.08589744 0.11923077 0.06410256 
## 
## $outpoint
## [1] 16
## 
## $medcurve
## 1990 
##    9</code></pre>
<p>Al comparar la detección de datos atípicos utilizando las tres herramientas mencionadas
(bagplot, hdr plot y fbplot) en la muestra de las 40 curvas de temperatura, se evidencia que el bagplot resulta ser la herramienta más estricta o exigente en cuanto a que detecta nueve curvas como atípicas, mientras que las otras dos detectaron dos y una, respectivamente. Es importante destacar que, lo que permite comparar las diferentes herramientas en términos de exigencia es utilizar las opciones de probabilidades de cobertura y factor de infación establecidas por defecto.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="análisis-de-datos-funcionales.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb478-2"><a href="análisis-de-datos-funcionales.html#cb478-2" aria-hidden="true" tabindex="-1"></a>MedFM <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;FM&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb478-3"><a href="análisis-de-datos-funcionales.html#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedFM)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars13-1.png" width="672" /></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="análisis-de-datos-funcionales.html#cb479-1" aria-hidden="true" tabindex="-1"></a>MedRP <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;RP&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb479-2"><a href="análisis-de-datos-funcionales.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedRP)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars13-2.png" width="672" /></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="análisis-de-datos-funcionales.html#cb480-1" aria-hidden="true" tabindex="-1"></a>MedRPD <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;RPD&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb480-2"><a href="análisis-de-datos-funcionales.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedRPD)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars13-3.png" width="672" /></p>
</div>
</div>
<div id="análisis-de-datos-funcionales-adf---análisis-gráfico" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Análisis de datos funcionales (ADF) - Análisis gráfico<a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-gráfico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Por ejemplo, consideremos la temperatura promedio mensual de la superficie del océano en grados Celsius, registrada desde Enero de 1982 a Abril de 2022, disponible en:<a href="https://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices" class="uri">https://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices</a>.</p>
<p>Realizamos la lectura de los datos:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="análisis-de-datos-funcionales.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb481-2"><a href="análisis-de-datos-funcionales.html#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda.usc)</span>
<span id="cb481-3"><a href="análisis-de-datos-funcionales.html#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rainbow)</span>
<span id="cb481-4"><a href="análisis-de-datos-funcionales.html#cb481-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb481-5"><a href="análisis-de-datos-funcionales.html#cb481-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb481-6"><a href="análisis-de-datos-funcionales.html#cb481-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-7"><a href="análisis-de-datos-funcionales.html#cb481-7" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">=</span><span class="fu">read.delim2</span>(<span class="st">&quot;data_11_PatronesPuntuales/2_AnalisisGrafico/sstoi.indices1.txt&quot;</span>,<span class="at">header=</span>T,<span class="at">dec=</span><span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb481-8"><a href="análisis-de-datos-funcionales.html#cb481-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Datos)</span></code></pre></div>
<pre><code>##        YR            MON            NINO1.2           ANOM              NINO3           ANOM.1        
##  Min.   :1982   Min.   : 1.000   Min.   :19.06   Min.   :-1.90000   Min.   :23.38   Min.   :-2.16000  
##  1st Qu.:1992   1st Qu.: 3.000   1st Qu.:21.23   1st Qu.:-0.73250   1st Qu.:25.00   1st Qu.:-0.65000  
##  Median :2002   Median : 6.000   Median :23.14   Median :-0.23500   Median :25.93   Median :-0.15000  
##  Mean   :2002   Mean   : 6.467   Mean   :23.25   Mean   :-0.05118   Mean   :25.97   Mean   :-0.06033  
##  3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:25.22   3rd Qu.: 0.44000   3rd Qu.:26.89   3rd Qu.: 0.42000  
##  Max.   :2022   Max.   :12.000   Max.   :28.51   Max.   : 4.03000   Max.   :28.81   Max.   : 3.07000  
##      NINO4           ANOM.2            NINO3.4          ANOM.3        
##  Min.   :26.36   Min.   :-1.87000   Min.   :24.56   Min.   :-2.22000  
##  1st Qu.:28.02   1st Qu.:-0.55250   1st Qu.:26.35   1st Qu.:-0.65250  
##  Median :28.57   Median :-0.00500   Median :27.07   Median :-0.11000  
##  Mean   :28.46   Mean   :-0.08946   Mean   :27.02   Mean   :-0.06878  
##  3rd Qu.:28.98   3rd Qu.: 0.38000   3rd Qu.:27.69   3rd Qu.: 0.45000  
##  Max.   :30.22   Max.   : 1.55000   Max.   :29.54   Max.   : 2.72000</code></pre>
<p>Reorganizamos la información para que cada año sea una curva. No tenemos en cuenta el año 2022 por no disponer de la información de todo el año.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="análisis-de-datos-funcionales.html#cb483-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(Datos<span class="sc">$</span>NINO1<span class="fl">.2</span>[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">481</span><span class="sc">:</span><span class="dv">484</span>)], <span class="at">nrow=</span><span class="dv">12</span>, <span class="dv">40</span>)</span>
<span id="cb483-2"><a href="análisis-de-datos-funcionales.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp)<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2021</span>)</span></code></pre></div>
<p>Construimos las gráficas para cada año</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="análisis-de-datos-funcionales.html#cb484-1" aria-hidden="true" tabindex="-1"></a>month<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb484-2"><a href="análisis-de-datos-funcionales.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(month, temp[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">30</span>), <span class="at">xlab=</span><span class="st">&quot;Mes&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;temperatura&quot;</span>)</span>
<span id="cb484-3"><a href="análisis-de-datos-funcionales.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(temp))</span>
<span id="cb484-4"><a href="análisis-de-datos-funcionales.html#cb484-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(month, temp[,i], <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span>i)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/pressure02-1.png" width="672" /></p>
<div id="deteccción-de-curvas-atípicas" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Deteccción de curvas atípicas<a href="análisis-de-datos-funcionales.html#deteccción-de-curvas-atípicas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es posible realizar detección de datos atípicos (outliers) a través de las herramientas: bagplot, HDR y boxplot para datos funcionales.</p>
<p>Con respecto a la base de datos de la temperatura, utilizando las profundidades dadas a través del criterio de bagplot, se muestran nueves curvas atípicas. La identicación de las curvas se encuentra en la parte superior del panel izquierdo de la siguiente figura. Se destaca, que el factor de inflación utilizado en este caso toma el valor de 1.96 que es el establecido por defecto en la función tipo bag.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="análisis-de-datos-funcionales.html#cb485-1" aria-hidden="true" tabindex="-1"></a>TempTs <span class="ot">=</span> <span class="fu">sfts</span>(<span class="fu">ts</span>(<span class="fu">as.numeric</span>(temp), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1982</span>,<span class="dv">1</span>),<span class="at">frequency =</span> <span class="dv">12</span>), <span class="at">xname =</span> <span class="st">&quot;Mes&quot;</span>,</span>
<span id="cb485-2"><a href="análisis-de-datos-funcionales.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="at">yname =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span>
<span id="cb485-3"><a href="análisis-de-datos-funcionales.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb485-4"><a href="análisis-de-datos-funcionales.html#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;functional&quot;</span>, <span class="at">type =</span> <span class="st">&quot;bag&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>)</span>
<span id="cb485-5"><a href="análisis-de-datos-funcionales.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;bivariate&quot;</span>, <span class="at">type =</span> <span class="st">&quot;bag&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>,</span>
<span id="cb485-6"><a href="análisis-de-datos-funcionales.html#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars16-1.png" width="672" /></p>
<p>Análogamente, teniendo en cuenta la profundidad a través del criterio de HDR plot, se evidencian dos curvas atípicas identificadas con los años 1997 y 2015. Para este caso los porcentajes de cobertura de los datos atípicos y de la región central tenidos en cuenta fueron los establecidos por defecto en la respectiva función (0.05, 0.5).</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="análisis-de-datos-funcionales.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb486-2"><a href="análisis-de-datos-funcionales.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;functional&quot;</span>, <span class="at">type =</span> <span class="st">&quot;hdr&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>)</span>
<span id="cb486-3"><a href="análisis-de-datos-funcionales.html#cb486-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fboxplot</span>(<span class="at">data=</span> TempTs, <span class="at">plot.type =</span> <span class="st">&quot;bivariate&quot;</span>, <span class="at">type =</span> <span class="st">&quot;hdr&quot;</span>, <span class="at">projmethod =</span> <span class="st">&quot;PCAproj&quot;</span>,</span>
<span id="cb486-4"><a href="análisis-de-datos-funcionales.html#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">6</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars17-1.png" width="672" /></p>
<p>Finalmente, al utilizar la herramienta del boxplot funcional, teniendo en cuenta la profundidad dada por la versión modificada de Band-depth, existe una curva atípica (1990). La probabilidad de la región central utilizada para realizar el gráfico fue de 0.5.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="análisis-de-datos-funcionales.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb487-2"><a href="análisis-de-datos-funcionales.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fbplot</span>(<span class="at">fit=</span> temp, <span class="at">method =</span> <span class="st">&quot;BD2&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars18-1.png" width="672" /></p>
<pre><code>## $depth
##       1982       1983       1984       1985       1986       1987       1988       1989       1990       1991 
## 0.05000000 0.05000000 0.09871795 0.05000000 0.12179487 0.20384615 0.05000000 0.13205128 0.23846154 0.07820513 
##       1992       1993       1994       1995       1996       1997       1998       1999       2000       2001 
## 0.09102564 0.21153846 0.06666667 0.10384615 0.05000000 0.05000000 0.05000000 0.06923077 0.13717949 0.12051282 
##       2002       2003       2004       2005       2006       2007       2008       2009       2010       2011 
## 0.10641026 0.06025641 0.10384615 0.06282051 0.06538462 0.05000000 0.10769231 0.13653846 0.06153846 0.13974359 
##       2012       2013       2014       2015       2016       2017       2018       2019       2020       2021 
## 0.09102564 0.05000000 0.05512821 0.05769231 0.11666667 0.05256410 0.07243590 0.08589744 0.11923077 0.06410256 
## 
## $outpoint
## [1] 16
## 
## $medcurve
## 1990 
##    9</code></pre>
<p>Al comparar la detección de datos atípicos utilizando las tres herramientas mencionadas (bagplot, hdr plot y fbplot) en la muestra de las 40 curvas de temperatura, se evidencia que el bagplot resulta ser la herramienta más estricta o exigente en cuanto a que detecta nueve curvas como atípicas, mientras que las otras dos detectaron dos y una, respectivamente. Es importante destacar que, lo que permite comparar las diferentes herramientas en términos de exigencia es utilizar las opciones de probabilidades de cobertura y factor de infación establecidas por defecto.</p>
</div>
<div id="otras-medidas-de-resumen" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> Otras medidas de resumen<a href="análisis-de-datos-funcionales.html#otras-medidas-de-resumen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con datos funcionales también es posible calcular otras etadísticas de resumen como la moda, medias recortadas y la mediana.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="análisis-de-datos-funcionales.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co">#*********************************************************</span></span>
<span id="cb489-2"><a href="análisis-de-datos-funcionales.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Parámetros estimados - Media recortada al 10%</span></span>
<span id="cb489-3"><a href="análisis-de-datos-funcionales.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="co">#*********************************************************</span></span>
<span id="cb489-4"><a href="análisis-de-datos-funcionales.html#cb489-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb489-5"><a href="análisis-de-datos-funcionales.html#cb489-5" aria-hidden="true" tabindex="-1"></a><span class="do">###Calcula la profundidad de Fraiman and Muniz (2001)</span></span>
<span id="cb489-6"><a href="análisis-de-datos-funcionales.html#cb489-6" aria-hidden="true" tabindex="-1"></a>MedFM <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;FM&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb489-7"><a href="análisis-de-datos-funcionales.html#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedFM)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars19-1.png" width="672" /></p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="análisis-de-datos-funcionales.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Calcula la profundidad a través de proyecciones aletorias de Cuevas et al. (2007)</span></span>
<span id="cb490-2"><a href="análisis-de-datos-funcionales.html#cb490-2" aria-hidden="true" tabindex="-1"></a>MedRP <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;RP&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb490-3"><a href="análisis-de-datos-funcionales.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedRP)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars19-2.png" width="672" /></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="análisis-de-datos-funcionales.html#cb491-1" aria-hidden="true" tabindex="-1"></a>MedRPD <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;RPD&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb491-2"><a href="análisis-de-datos-funcionales.html#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MedRPD)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars19-3.png" width="672" /></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="análisis-de-datos-funcionales.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb492-2"><a href="análisis-de-datos-funcionales.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros estimados - Moda</span></span>
<span id="cb492-3"><a href="análisis-de-datos-funcionales.html#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb492-4"><a href="análisis-de-datos-funcionales.html#cb492-4" aria-hidden="true" tabindex="-1"></a>MODA <span class="ot">=</span> <span class="fu">fdepth</span>(<span class="at">data =</span> TempTs, <span class="at">type =</span> <span class="st">&quot;mode&quot;</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span>
<span id="cb492-5"><a href="análisis-de-datos-funcionales.html#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MODA)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars19-4.png" width="672" /></p>
<p>Finalmemnte, a través de procedimientos bootstrap es posible estimar intervalos de confianza para las medidas de resumen.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="análisis-de-datos-funcionales.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb493-2"><a href="análisis-de-datos-funcionales.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Boostrap Funcional</span></span>
<span id="cb493-3"><a href="análisis-de-datos-funcionales.html#cb493-3" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb493-4"><a href="análisis-de-datos-funcionales.html#cb493-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-5"><a href="análisis-de-datos-funcionales.html#cb493-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-6"><a href="análisis-de-datos-funcionales.html#cb493-6" aria-hidden="true" tabindex="-1"></a>BSpl <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">norder=</span><span class="dv">4</span>, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="at">length=</span><span class="dv">5</span>))</span>
<span id="cb493-7"><a href="análisis-de-datos-funcionales.html#cb493-7" aria-hidden="true" tabindex="-1"></a>Ftemp <span class="ot">&lt;-</span> <span class="fu">Data2fd</span>(temp, <span class="at">basisobj=</span>BSpl)</span></code></pre></div>
<pre><code>## &#39;y&#39; is missing, using &#39;argvals&#39;
## &#39;argvals&#39; is missing;  using seq( 0 ,  12 , length= 12 )</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="análisis-de-datos-funcionales.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Ftemp, <span class="at">main=</span><span class="st">&quot;Datos suavizados de la Temperatura&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Mes&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Temperatura oC&quot;</span>,</span>
<span id="cb495-2"><a href="análisis-de-datos-funcionales.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">30</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars20-1.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="análisis-de-datos-funcionales.html#cb497-1" aria-hidden="true" tabindex="-1"></a>out.boot1<span class="ot">=</span><span class="fu">fdata.bootstrap</span>(Ftemp,<span class="at">statistic=</span>func.mean,<span class="at">nb=</span><span class="dv">200</span>,<span class="at">draw=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars20-2.png" width="672" /></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="análisis-de-datos-funcionales.html#cb498-1" aria-hidden="true" tabindex="-1"></a>out.boot2<span class="ot">=</span><span class="fu">fdata.bootstrap</span>(Ftemp,<span class="at">statistic=</span>func.trim.FM,<span class="at">nb=</span><span class="dv">100</span>,<span class="at">draw=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars20-3.png" width="672" /></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="análisis-de-datos-funcionales.html#cb499-1" aria-hidden="true" tabindex="-1"></a>out.boot2<span class="ot">=</span><span class="fu">fdata.bootstrap</span>(Ftemp,<span class="at">statistic=</span>func.trim.mode,<span class="at">nb=</span><span class="dv">100</span>,<span class="at">draw=</span><span class="cn">TRUE</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars20-4.png" width="672" /></p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="análisis-de-datos-funcionales.html#cb500-1" aria-hidden="true" tabindex="-1"></a>out.boot2<span class="ot">=</span><span class="fu">fdata.bootstrap</span>(Ftemp,<span class="at">statistic=</span>func.trim.RP,<span class="at">nb=</span><span class="dv">100</span>,<span class="at">draw=</span><span class="cn">TRUE</span>, <span class="at">trim =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars20-5.png" width="672" /></p>
</div>
<div id="análisis-en-componentes-principales-acpf" class="section level3 hasAnchor" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Análisis en Componentes Principales (ACPF)<a href="análisis-de-datos-funcionales.html#análisis-en-componentes-principales-acpf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El análisis de componentes principales funcionales (ACPF) es una extensión del ACP clásico en el que las componentes principales están representadas por funciones y no por vectores (Ramsay &amp; Sylverman, 2005). La idea fundamental del análisis de componentes principales es reducir la dimensión del conjunto de datos conservando tanto como sea posible la variación presente en los mismos.</p>
<p><img src="data_11_PatronesPuntuales/2_AnalisisGrafico/ACPF.jpg" width="500" /></p>
<p>Fuente: Chávez-Chong,Sánchez-García y DelaCerda-Gastélum (2015), disponile en <a href="https://rio.upo.es/xmlui/bitstream/handle/10433/2768/1694-5314-1-SM.pdf?sequence=1&amp;isAllowed=y#:~:text=AN%C3%81LISIS%20DE%20COMPONENTES%20PRINCIPALES%20(ACP)&amp;text=Es%20decir%3A%20reducir%20la%20dimensi%C3%B3n,la%20biometr%C3%ADa%20de%20la%20%C3%A9poca" class="uri">https://rio.upo.es/xmlui/bitstream/handle/10433/2768/1694-5314-1-SM.pdf?sequence=1&amp;isAllowed=y#:~:text=AN%C3%81LISIS%20DE%20COMPONENTES%20PRINCIPALES%20(ACP)&amp;text=Es%20decir%3A%20reducir%20la%20dimensi%C3%B3n,la%20biometr%C3%ADa%20de%20la%20%C3%A9poca</a>.</p>
<p>Si se aplica el método a las curvas de temperturas trabajadas hasta el momento, reteniendo en el análisis 4 componentes, la primera función retiene el 70.1% de la variabilidad total de las curvas, la segunda función, el 20.9%, la tercera, el 4.8% y la cuarta, el 2.7%. Las funciones de componentes principales se muestran como perturbaciones de la curva media, que es la línea continua. Los + muestran lo que sucede cuando una pequeña cantidad de un componente principal se suma a la media, y los - muestran el efecto de restar este componente.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="análisis-de-datos-funcionales.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb501-2"><a href="análisis-de-datos-funcionales.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ACPF</span></span>
<span id="cb501-3"><a href="análisis-de-datos-funcionales.html#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="co">#***********************************************************</span></span>
<span id="cb501-4"><a href="análisis-de-datos-funcionales.html#cb501-4" aria-hidden="true" tabindex="-1"></a>PCA <span class="ot">=</span> <span class="fu">pca.fd</span>(Ftemp, <span class="dv">4</span>)</span>
<span id="cb501-5"><a href="análisis-de-datos-funcionales.html#cb501-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PCA)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars21-1.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-2.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-3.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-4.png" width="672" /></p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="análisis-de-datos-funcionales.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.pca.fd</span>(PCA)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars21-5.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-6.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-7.png" width="672" /><img src="bookdownproj_files/figure-html/cars21-8.png" width="672" /></p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="análisis-de-datos-funcionales.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> PCA<span class="sc">$</span>scores[,<span class="dv">1</span>], <span class="at">y =</span> PCA<span class="sc">$</span>scores[,<span class="dv">2</span>], <span class="at">cex =</span> <span class="fl">0.001</span>)</span>
<span id="cb503-2"><a href="análisis-de-datos-funcionales.html#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> PCA<span class="sc">$</span>scores[,<span class="dv">1</span>], <span class="at">y =</span> PCA<span class="sc">$</span>scores[,<span class="dv">2</span>] , <span class="fu">seq</span>(<span class="dv">1982</span>,<span class="dv">2021</span>,<span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">0.5</span> )</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars21-9.png" width="672" /></p>
</div>
</div>
<div id="modelos-lineales" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Modelos lineales<a href="análisis-de-datos-funcionales.html#modelos-lineales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un modelo lineal permite establecer la relación entre una variable respuesta y una o varias
covariables. La extensión al caso funcional se presenta cuando existe por lo menos una variable (respuesta o explicativa) funcional en dicho modelo. Así, el modelo de regresión funcional es la extensión natural del modelo de regresión usual al caso en el cual se cuenta con una variable respuesta funcional y/o con covariables funcionales (Aristizabal, 2011)</p>
<div id="regresión-lineal-funcional-con-respuesta-escalar" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Regresión lineal funcional con respuesta escalar<a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-escalar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La función <span class="math inline">\(fRegress\)</span> realiza un análisis de regresión funcional, donde la variable dependiente o una o más variables independientes son funcionales. Las variables no funcionales se pueden utilizar en cualquier lado de la ecuación. En un problema simple donde hay una sola covariable escalar independiente con valores <span class="math inline">\(z_i\)</span> con <span class="math inline">\(i = 1,2,3,...,n\)</span> y una sola covariable funcional con valores <span class="math inline">\(x_i(t)\)</span>, el modelo establecido es:
<span class="math display">\[\begin{equation}
y_i = \beta_1z_i + \int x_i(t)\beta_2(t)dt + e_i
\end{equation}\]</span></p>
<p>A través de esta función también es posible llevar a cabo la estimación de los parámetros del modelo concurrente con variable dependiente funcional dado por:</p>
<p><span class="math display">\[\begin{equation}
y_i = \beta_1(t)z_i + \beta_2(t)x_i(t) + e_i(t)
\end{equation}\]</span></p>
<p>Los parámetros <span class="math inline">\(e_i\)</span> y <span class="math inline">\(e_i(t)\)</span> son los residuales del modelo (falta de ajuste o término error). Observe que, en el modelo lineal funcional concurrente para una variable dependiente funcional, todas las variables funcionales se evalúan en un tiempo común o valor de argumento <span class="math inline">\(t\)</span>. Es decir, el ajuste se define en términos del comportamiento de todas las variables en un momento fijo, o en términos del comportamiento del “ahora”.</p>
<p>Todas las funciones de coeficientes <span class="math inline">\(\beta_j(t)\)</span> son consideradas objetos funcionales. En el caso de una variable dependiente escalar, el coeficiente de regresión para una covariable escalar es convertido a una variable funcional con una base de constantes. Todas las funciones de coeficientes de regresión se pueden forzar para que sean uniformes mediante el uso de penalizaciones por aspereza o rugosidad y, en consecuencia, se especifican en la lista de argumentos como objetos de los parámetros funcionales.</p>
<p>En esta sección vamos a predecir el logaritmo de la precipitación anual para 35 estaciones meteorológicas canadienses a partir de sus perfiles de temperatura. Se utiliza como variable predictora el perfil de temperatura completo y un intercepto constante. Estas dos covariables se pueden almacenar en una lista de longitud 2. Así, configuramos un objeto de datos funcional para la temperatura con 35 perfiles en un objeto llamado tempfd. Asmismo, utilizamos 65 funciones de una base de Fourier sin penalización. Este número de funciones de base es adecuado para la mayoría de los propósitos y puede, por ejemplo, capturar la ondulaciones observadas a principios de la primavera en muchas estaciones meteorológicas (Ramsay &amp; Silverman, 2005).</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="análisis-de-datos-funcionales.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb504-2"><a href="análisis-de-datos-funcionales.html#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda.usc)</span>
<span id="cb504-3"><a href="análisis-de-datos-funcionales.html#cb504-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rainbow)</span>
<span id="cb504-4"><a href="análisis-de-datos-funcionales.html#cb504-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb504-5"><a href="análisis-de-datos-funcionales.html#cb504-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb504-6"><a href="análisis-de-datos-funcionales.html#cb504-6" aria-hidden="true" tabindex="-1"></a>annualprec <span class="ot">=</span> <span class="fu">log10</span>(<span class="fu">apply</span>(daily<span class="sc">$</span>precav,<span class="dv">2</span>,sum))</span>
<span id="cb504-7"><a href="análisis-de-datos-funcionales.html#cb504-7" aria-hidden="true" tabindex="-1"></a>tempbasis <span class="ot">=</span><span class="fu">create.fourier.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">365</span>),<span class="dv">65</span>)</span>
<span id="cb504-8"><a href="análisis-de-datos-funcionales.html#cb504-8" aria-hidden="true" tabindex="-1"></a>tempSmooth<span class="ot">=</span><span class="fu">smooth.basis</span>(day<span class="fl">.5</span>,daily<span class="sc">$</span>tempav,tempbasis)</span>
<span id="cb504-9"><a href="análisis-de-datos-funcionales.html#cb504-9" aria-hidden="true" tabindex="-1"></a>tempfd <span class="ot">=</span>tempSmooth<span class="sc">$</span>fd</span>
<span id="cb504-10"><a href="análisis-de-datos-funcionales.html#cb504-10" aria-hidden="true" tabindex="-1"></a>templist <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">2</span>)</span>
<span id="cb504-11"><a href="análisis-de-datos-funcionales.html#cb504-11" aria-hidden="true" tabindex="-1"></a>templist[[<span class="dv">1</span>]] <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">35</span>)</span>
<span id="cb504-12"><a href="análisis-de-datos-funcionales.html#cb504-12" aria-hidden="true" tabindex="-1"></a>templist[[<span class="dv">2</span>]] <span class="ot">=</span> tempfd</span></code></pre></div>
<p>La estrategia más simple para estimar los parámetros funionales es mantener una dimensionalidad en el proceso de suavizamiento relativamente pequeño. Para este caso, trabajaremos con cinco funciones de una base de Fourier para la estimación del coeficiente de regresión (pendiente) y una función constante para el intercepto.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="análisis-de-datos-funcionales.html#cb505-1" aria-hidden="true" tabindex="-1"></a>conbasis <span class="ot">=</span> <span class="fu">create.constant.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">365</span>))</span>
<span id="cb505-2"><a href="análisis-de-datos-funcionales.html#cb505-2" aria-hidden="true" tabindex="-1"></a>betabasis <span class="ot">=</span> <span class="fu">create.fourier.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">365</span>),<span class="dv">5</span>)</span>
<span id="cb505-3"><a href="análisis-de-datos-funcionales.html#cb505-3" aria-hidden="true" tabindex="-1"></a>betalist <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">2</span>)</span>
<span id="cb505-4"><a href="análisis-de-datos-funcionales.html#cb505-4" aria-hidden="true" tabindex="-1"></a>betalist[[<span class="dv">1</span>]] <span class="ot">=</span> conbasis</span>
<span id="cb505-5"><a href="análisis-de-datos-funcionales.html#cb505-5" aria-hidden="true" tabindex="-1"></a>betalist[[<span class="dv">2</span>]] <span class="ot">=</span> betabasis</span></code></pre></div>
<p>Una vez definidas las funciones base para los parámetros de regresión, procedemos a realizar el proceso de regresión:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="análisis-de-datos-funcionales.html#cb506-1" aria-hidden="true" tabindex="-1"></a>fRegressList <span class="ot">=</span> <span class="fu">fRegress</span>(annualprec,templist,betalist)</span>
<span id="cb506-2"><a href="análisis-de-datos-funcionales.html#cb506-2" aria-hidden="true" tabindex="-1"></a>betaestlist <span class="ot">=</span> fRegressList<span class="sc">$</span>betaestlist</span>
<span id="cb506-3"><a href="análisis-de-datos-funcionales.html#cb506-3" aria-hidden="true" tabindex="-1"></a>tempbetafd <span class="ot">=</span> betaestlist[[<span class="dv">2</span>]]<span class="sc">$</span>fd</span>
<span id="cb506-4"><a href="análisis-de-datos-funcionales.html#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tempbetafd, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,</span>
<span id="cb506-5"><a href="análisis-de-datos-funcionales.html#cb506-5" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;Coeficiente Beta para temperatura&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars24-1.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
<p>La Figura anterior muestra el resultado. El intercepto se puede obtener de coef(betaestlist[[1]]).Su valor en este caso es 3.464844.</p>
<p>Para evaluar la calidad de este ajuste, se extraen los valores ajustados definido por este modelo y se calculan los residuos. De manera análoga que en el caso escalar, se calculan las sumas de cuadrados de los residuales con el modelo completo y utilizando solo el parámetro de intercepto y se comparan a través de la estadística <span class="math inline">\(F\)</span>.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="análisis-de-datos-funcionales.html#cb508-1" aria-hidden="true" tabindex="-1"></a>annualprechat1 <span class="ot">=</span> fRegressList<span class="sc">$</span>yhatfdobj</span>
<span id="cb508-2"><a href="análisis-de-datos-funcionales.html#cb508-2" aria-hidden="true" tabindex="-1"></a>annualprecres1 <span class="ot">=</span> annualprec <span class="sc">-</span> annualprechat1</span>
<span id="cb508-3"><a href="análisis-de-datos-funcionales.html#cb508-3" aria-hidden="true" tabindex="-1"></a>SSE1 <span class="ot">=</span> <span class="fu">sum</span>(annualprecres1<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb508-4"><a href="análisis-de-datos-funcionales.html#cb508-4" aria-hidden="true" tabindex="-1"></a>SSE0 <span class="ot">=</span> <span class="fu">sum</span>((annualprec <span class="sc">-</span> <span class="fu">mean</span>(annualprec))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb508-5"><a href="análisis-de-datos-funcionales.html#cb508-5" aria-hidden="true" tabindex="-1"></a>RSQ1 <span class="ot">=</span> (SSE0<span class="sc">-</span>SSE1)<span class="sc">/</span>SSE0</span>
<span id="cb508-6"><a href="análisis-de-datos-funcionales.html#cb508-6" aria-hidden="true" tabindex="-1"></a>RSQ1 </span></code></pre></div>
<pre><code>## [1] 0.7955986</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="análisis-de-datos-funcionales.html#cb510-1" aria-hidden="true" tabindex="-1"></a>Fratio1 <span class="ot">=</span> ((SSE0<span class="sc">-</span>SSE1)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">/</span>(SSE1<span class="sc">/</span><span class="dv">29</span>)</span>
<span id="cb510-2"><a href="análisis-de-datos-funcionales.html#cb510-2" aria-hidden="true" tabindex="-1"></a>Fratio1</span></code></pre></div>
<pre><code>## [1] 22.57554</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="análisis-de-datos-funcionales.html#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(Fratio1 ,<span class="dv">5</span>,<span class="dv">29</span>,)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>El coeficiente de correlación al cuadrado presenta un valor de 0.7955 y la estadística F un valor de 22.57, que tiene asociado un valor p menor al 1%.</p>
</div>
<div id="estimación-de-los-coeficientes-beta-con-regularización" class="section level3 hasAnchor" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Estimación de los coeficientes <span class="math inline">\(\beta\)</span> con regularización<a href="análisis-de-datos-funcionales.html#estimación-de-los-coeficientes-beta-con-regularización" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hay dos maneras de obtener un ajuste suave de las curvas de parámetros <span class="math inline">\(\beta(t)\)</span>. La más sencilla es la revisada anteriomente en la cual se utiliza un modelo de baja dimensión. Sin embargo, podemos tener un control más directo sobre la “suavidad” de la curva mediante el uso de una penalización por rugosidad como se vió en la guía 1 (Ramsay &amp; Silverman, 2005).</p>
<p>Aplicando este enfoque para predecir las precipitaciones logarítmicas anuales se debe configurar un operador de aceleración armónica:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="análisis-de-datos-funcionales.html#cb514-1" aria-hidden="true" tabindex="-1"></a>Lcoef <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">365</span>)<span class="sc">^</span><span class="dv">2</span>,<span class="dv">0</span>)</span>
<span id="cb514-2"><a href="análisis-de-datos-funcionales.html#cb514-2" aria-hidden="true" tabindex="-1"></a>harmaccelLfd <span class="ot">=</span> <span class="fu">vec2Lfd</span>(Lcoef, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">365</span>))</span></code></pre></div>
<p>Ahora creamos el objeto funcional incorporando la penalización por rugosidad:</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="análisis-de-datos-funcionales.html#cb515-1" aria-hidden="true" tabindex="-1"></a>betabasis <span class="ot">=</span> <span class="fu">create.fourier.basis</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">365</span>), <span class="dv">35</span>)</span>
<span id="cb515-2"><a href="análisis-de-datos-funcionales.html#cb515-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span><span class="fl">12.5</span></span>
<span id="cb515-3"><a href="análisis-de-datos-funcionales.html#cb515-3" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">=</span> <span class="fu">fdPar</span>(betabasis, harmaccelLfd, lambda)</span>
<span id="cb515-4"><a href="análisis-de-datos-funcionales.html#cb515-4" aria-hidden="true" tabindex="-1"></a>betalist[[<span class="dv">2</span>]] <span class="ot">=</span> betafdPar</span></code></pre></div>
<p>Y estimamos los parámetros funcionales con el uso de la función <span class="math inline">\(fRegress\)</span>:</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="análisis-de-datos-funcionales.html#cb516-1" aria-hidden="true" tabindex="-1"></a>annPrecTemp <span class="ot">=</span> <span class="fu">fRegress</span>(annualprec, templist,</span>
<span id="cb516-2"><a href="análisis-de-datos-funcionales.html#cb516-2" aria-hidden="true" tabindex="-1"></a>betalist)</span>
<span id="cb516-3"><a href="análisis-de-datos-funcionales.html#cb516-3" aria-hidden="true" tabindex="-1"></a>betaestlist2 <span class="ot">=</span> annPrecTemp<span class="sc">$</span>betaestlist</span>
<span id="cb516-4"><a href="análisis-de-datos-funcionales.html#cb516-4" aria-hidden="true" tabindex="-1"></a>annualprechat2 <span class="ot">=</span> annPrecTemp<span class="sc">$</span>yhatfdobj</span></code></pre></div>
<p>Finalmente, calculamos las estadísticas habituales de <span class="math inline">\(R^2\)</span> y la razón <span class="math inline">\(F\)</span> para evaluar el ajuste del modelo:</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="análisis-de-datos-funcionales.html#cb517-1" aria-hidden="true" tabindex="-1"></a>SSE2 <span class="ot">=</span> <span class="fu">sum</span>((annualprec<span class="sc">-</span>annualprechat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb517-2"><a href="análisis-de-datos-funcionales.html#cb517-2" aria-hidden="true" tabindex="-1"></a>RSQ2 <span class="ot">=</span> (SSE0 <span class="sc">-</span> SSE2)<span class="sc">/</span>SSE0</span>
<span id="cb517-3"><a href="análisis-de-datos-funcionales.html#cb517-3" aria-hidden="true" tabindex="-1"></a>RSQ2</span></code></pre></div>
<pre><code>## [1] 0.7537658</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="análisis-de-datos-funcionales.html#cb519-1" aria-hidden="true" tabindex="-1"></a>Fratio2 <span class="ot">=</span> ((SSE0<span class="sc">-</span>SSE2)<span class="sc">/</span><span class="fl">3.7</span>)<span class="sc">/</span>(SSE1<span class="sc">/</span><span class="fl">30.3</span>)</span>
<span id="cb519-2"><a href="análisis-de-datos-funcionales.html#cb519-2" aria-hidden="true" tabindex="-1"></a>Fratio2</span></code></pre></div>
<pre><code>## [1] 30.19907</code></pre>
<p>Para completar el análisis, se utliza una base constante para la estimación del intercepto y se compara con el modelo completo. Los grados de libertad de este modelo reducido son ahora 2.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="análisis-de-datos-funcionales.html#cb521-1" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">=</span> <span class="fu">fdPar</span>(betabasis, harmaccelLfd, lambda)</span>
<span id="cb521-2"><a href="análisis-de-datos-funcionales.html#cb521-2" aria-hidden="true" tabindex="-1"></a>betalist[[<span class="dv">2</span>]] <span class="ot">=</span> betafdPar</span>
<span id="cb521-3"><a href="análisis-de-datos-funcionales.html#cb521-3" aria-hidden="true" tabindex="-1"></a>fRegressList <span class="ot">=</span> <span class="fu">fRegress</span>(annualprec, templist,</span>
<span id="cb521-4"><a href="análisis-de-datos-funcionales.html#cb521-4" aria-hidden="true" tabindex="-1"></a>betalist)</span>
<span id="cb521-5"><a href="análisis-de-datos-funcionales.html#cb521-5" aria-hidden="true" tabindex="-1"></a>betaestlist <span class="ot">=</span> fRegressList<span class="sc">$</span>betaestlist</span>
<span id="cb521-6"><a href="análisis-de-datos-funcionales.html#cb521-6" aria-hidden="true" tabindex="-1"></a>annualprechat <span class="ot">=</span> fRegressList<span class="sc">$</span>yhatfdobj</span>
<span id="cb521-7"><a href="análisis-de-datos-funcionales.html#cb521-7" aria-hidden="true" tabindex="-1"></a>SSE1 <span class="ot">=</span> <span class="fu">sum</span>((annualprec<span class="sc">-</span>annualprechat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb521-8"><a href="análisis-de-datos-funcionales.html#cb521-8" aria-hidden="true" tabindex="-1"></a>RSQ <span class="ot">=</span> (SSE0 <span class="sc">-</span> SSE1)<span class="sc">/</span>SSE0</span>
<span id="cb521-9"><a href="análisis-de-datos-funcionales.html#cb521-9" aria-hidden="true" tabindex="-1"></a>RSQ </span></code></pre></div>
<pre><code>## [1] 0.7537658</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="análisis-de-datos-funcionales.html#cb523-1" aria-hidden="true" tabindex="-1"></a>Fratio <span class="ot">=</span> ((SSE0<span class="sc">-</span>SSE1)<span class="sc">/</span><span class="dv">1</span>)<span class="sc">/</span>(SSE1<span class="sc">/</span><span class="dv">33</span>)</span>
<span id="cb523-2"><a href="análisis-de-datos-funcionales.html#cb523-2" aria-hidden="true" tabindex="-1"></a>Fratio</span></code></pre></div>
<pre><code>## [1] 101.0188</code></pre>
<p>Asimismo, es posible estimar intervalos de confianza:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="análisis-de-datos-funcionales.html#cb525-1" aria-hidden="true" tabindex="-1"></a>resid <span class="ot">=</span> annualprec <span class="sc">-</span> annualprechat</span>
<span id="cb525-2"><a href="análisis-de-datos-funcionales.html#cb525-2" aria-hidden="true" tabindex="-1"></a>SigmaE.<span class="ot">=</span> <span class="fu">sum</span>(resid<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">35</span><span class="sc">-</span>fRegressList<span class="sc">$</span>df)</span>
<span id="cb525-3"><a href="análisis-de-datos-funcionales.html#cb525-3" aria-hidden="true" tabindex="-1"></a>SigmaE <span class="ot">=</span> SigmaE.<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">35</span>))</span>
<span id="cb525-4"><a href="análisis-de-datos-funcionales.html#cb525-4" aria-hidden="true" tabindex="-1"></a>y2cMap <span class="ot">=</span> tempSmooth<span class="sc">$</span>y2cMap</span>
<span id="cb525-5"><a href="análisis-de-datos-funcionales.html#cb525-5" aria-hidden="true" tabindex="-1"></a>stderrList <span class="ot">=</span> <span class="fu">fRegress.stderr</span>(fRegressList, y2cMap,</span>
<span id="cb525-6"><a href="análisis-de-datos-funcionales.html#cb525-6" aria-hidden="true" tabindex="-1"></a>SigmaE)</span>
<span id="cb525-7"><a href="análisis-de-datos-funcionales.html#cb525-7" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">=</span> betaestlist[[<span class="dv">2</span>]]</span>
<span id="cb525-8"><a href="análisis-de-datos-funcionales.html#cb525-8" aria-hidden="true" tabindex="-1"></a>betafd <span class="ot">=</span> betafdPar<span class="sc">$</span>fd</span>
<span id="cb525-9"><a href="análisis-de-datos-funcionales.html#cb525-9" aria-hidden="true" tabindex="-1"></a>betastderrList <span class="ot">=</span> stderrList<span class="sc">$</span>betastderrlist</span>
<span id="cb525-10"><a href="análisis-de-datos-funcionales.html#cb525-10" aria-hidden="true" tabindex="-1"></a>betastderrfd <span class="ot">=</span> betastderrList[[<span class="dv">2</span>]]</span>
<span id="cb525-11"><a href="análisis-de-datos-funcionales.html#cb525-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(betafd, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,</span>
<span id="cb525-12"><a href="análisis-de-datos-funcionales.html#cb525-12" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;Coeficientes de regresión - Temperatura.&quot;</span>,</span>
<span id="cb525-13"><a href="análisis-de-datos-funcionales.html#cb525-13" aria-hidden="true" tabindex="-1"></a><span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">6e-4</span>,<span class="fl">1.2e-03</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="análisis-de-datos-funcionales.html#cb527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(betafd<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>betastderrfd, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb527-2"><a href="análisis-de-datos-funcionales.html#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(betafd<span class="dv">-2</span><span class="sc">*</span>betastderrfd, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars31-1.png" width="672" /></p>
</div>
<div id="prueba-f-para-ajuste-del-modelo-a-través-de-permutaciones" class="section level3 hasAnchor" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Prueba <span class="math inline">\(F\)</span> para ajuste del modelo a través de permutaciones<a href="análisis-de-datos-funcionales.html#prueba-f-para-ajuste-del-modelo-a-través-de-permutaciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Debido a la naturaleza de las estadísticas funcionales, es difícil intentar derivar una distribución nula teórica para cualquier estadística de prueba, ya que se tendría que tener en cuenta el parámetro de suavizamiento. Ramsay &amp; Silverman (2005) proponen utilizar una metodología de prueba basada en permutaciones. El supuesto utilizado es que si no hay relación entre la respuesta y las covariables, no debería darse ninguna diferencia si se reorganiza al azar la forma en que están emparejados. La función para realizar la respectiva prueba de hipótesis es <span class="math inline">\(Fperm.fd\)</span></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="análisis-de-datos-funcionales.html#cb528-1" aria-hidden="true" tabindex="-1"></a>F.res <span class="ot">=</span> <span class="fu">Fperm.fd</span>(annualprec, templist, betalist)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars32-1.png" width="672" /></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="análisis-de-datos-funcionales.html#cb529-1" aria-hidden="true" tabindex="-1"></a>F.res<span class="sc">$</span>pval</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="modelos-lineales-funcionales-regresión-funcional" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Modelos lineales funcionales (Regresión Funcional)<a href="análisis-de-datos-funcionales.html#modelos-lineales-funcionales-regresión-funcional" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para explicar la variabilidad de una determinada variable con respecto a otras explicativas, consideradas como covariables, el análisis de varianza y la regresión lineal son los procedimientos que generalmente se utilizan. En este sentido el modelo de regresión funcional es la extensión natural del modelo de regresión usual al caso en el cual se cuenta con una variable respuesta funcional o con covariables funcionales (Aristizabal, 2011).</p>
<div id="regresión-lineal-funcional-con-respuesta-funcional-anova-funcional" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Regresión lineal funcional con respuesta funcional (ANOVA Funcional)<a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-funcional-anova-funcional" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En términos formales (Ramsay &amp; Silverman, 2005), se asume que se cuenta con <span class="math inline">\(G\)</span> “tratamientos” cada uno con un número <span class="math inline">\(N_g\)</span> de sujetos. El modelo para la <span class="math inline">\(m\)</span>-ésima función (curva) en el <span class="math inline">\(g\)</span>-ésimo grupo (<span class="math inline">\(y_{mg}(t))\)</span>, esta dada por:<span class="math display">\[ y_{mg}(t) = \mu(t) + \alpha_g(t) + \varepsilon_{mg}(t)\]</span>
dónde la función <span class="math inline">\(\mu\)</span> es la media general, <span class="math inline">\(\alpha_g\)</span> representa la función media para cada ``tratamiento’’ y <span class="math inline">\(\varepsilon_{mg}\)</span> es la función de error en cada caso. La tarea entonces, es establecer la matriz diseño para lograr estimar los parámetros funcionales <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\alpha_g\)</span>, bajo la condición que <span class="math inline">\(\sum_g \alpha_g(t) = 0\)</span> para todo <span class="math inline">\(t\)</span> con el fin de garantizar la estimabilidad de los mismos.</p>
<p>En términos matriciales el modelo queda determinado como: <span class="math display">\[y_{mg}(t) = \sum_{j=1}^{(G+1)} x_{(mg)j}\beta_j(t) + \varepsilon_{(mg)}(t) \]</span><span class="math display">\[y(t) = X(t)\beta(t) + \varepsilon(t)\]</span></p>
<p>Cabe destacar que la matriz diseño <span class="math inline">\(X\)</span> tiene la misma estructura que en el caso multivariado o univariado, la diferencia obedece a que el vector de parámetros <span class="math inline">\(\beta(t)\)</span> y las predicciones <span class="math inline">\(X\beta(t)\)</span>, son vectores de funciones en vez de vectores de números.</p>
</div>
<div id="estimación---mínimos-cuadrados-ordinarios" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Estimación - Mínimos cuadrados ordinarios<a href="análisis-de-datos-funcionales.html#estimación---mínimos-cuadrados-ordinarios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para realizar el ajuste a través del criterio de mínimos cuadrados ordinarios, se debe escoger <span class="math inline">\(\beta(t)\)</span> que minimize la suma de cuadrados residual, así, para extender el principio de mínimos cuadrados al caso funcional, se reinterpreta la suma de cuadrados residual (<span class="math inline">\(y_i(t) - X_i\beta(t)\)</span>) como una nueva función, y entonces por el criterio de mínimos cuadrados ordinarios se debe minimizar:<span class="math display">\[SSE(\beta) = \sum_g  ^{G} \sum_m^{N_g} \int (y_{mg}(t) - \sum_j^q x_{(mg)j}\beta_j(t))^2dt = \sum_i^n \|y_i(t) - x_i^t\beta(t) \|^2\]</span>
Minimizando <span class="math inline">\(SSE(\beta)\)</span> sujeto a la condición de <span class="math inline">\(\sum_{j = 2} ^{G+1}\beta_j(t) = 0\)</span> se obtiene la estimación de los parámetros funcionales <span class="math inline">\(\hat{\beta}(t)\)</span>.</p>
<p>Al igual que en el modelo lineal multivariado, la fuente primaria de información para investigar la importancia de los ``tratamientos’’, es la función de suma de cuadrados:<span class="math display">\[ SSE(t) = \sum_{mg} (y_{mg}(t) - X_{mg}\hat{\beta}(t))^2\]</span>
Está función es comparada con la función de suma de cuadrados de los errores obtenida al utilizar solo la media general <span class="math inline">\(\hat{\mu}\)</span> en el modelo:<span class="math display">\[SSY(t) =   \sum_{mg} (y_{mg}(t) - \hat{\mu}(t))^2\]</span>
Así un camino para realizar la comparación, se establece utilizando la función del cuadrado de correlación múltiple:<span class="math display">\[RSQ(t) = \frac{(SSY(t) - SSE(t))}{SSY(t)}\]</span>
o calcular las funciones análogas a las de una tabla ANOVA en el caso univariado. Por ejemplo la función de cuadrado medio del error:<span class="math display">\[MSE = \frac{SSE}{df(error)} =  \frac{SSE}{N-G}\]</span>
Análogamente, la función de cuadrado medio de la regresión es la diferencia entre la suma de cuadrados total (<span class="math inline">\(SSY\)</span>) y la suma de cuadrados del error (<span class="math inline">\(SSE\)</span>), dividida por la diferencia entre los grados de libertad del error para los dos modelos (grados de libertad de la regresión):<span class="math display">\[MSR(t) = \frac{SSY(t) - SSE(t)}{df(regresion)}\]</span>
Finalmente se puede construir la función <span class="math inline">\(F\)</span> como:<span class="math display">\[ F = \frac{MSR}{MSE}\]</span></p>
<p>Básicamente, la mayoría de los estadísticos del análisis de varianza univariado son aplicables al problema funcional, esencialmente, porque el problema de análisis de varianza funcional, se puede considerar como un análisis de varianza univariado (ANOVA) para cada valor específico <span class="math inline">\(t\)</span> del dominio de la función. Sin embargo, bajo este enfoque la prueba <span class="math inline">\(F\)</span> pierde algunas de sus propiedades, debido a que realizar una prueba <span class="math inline">\(F\)</span> en cada tiempo <span class="math inline">\(t\)</span> con un nivel de significancia determinado no implica el mismo nivel de significancia en una prueba conjunta.</p>
</div>
<div id="pruebas-de-hipótesis---prueba-de-shen-faraway" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Pruebas de hipótesis - Prueba de Shen &amp; Faraway<a href="análisis-de-datos-funcionales.html#pruebas-de-hipótesis---prueba-de-shen-faraway" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En el 2004 Shen y Faraway (Shen &amp; Faraway, 2004), propusieron una prueba tipo <span class="math inline">\(\textbf{F}\)</span> para modelos lineales con respuesta funcional. Esta, es una extensión de la prueba <span class="math inline">\(\textbf{F}\)</span> multivariada al caso en que la cantidad de mediciones crece rápidamente y puede ser utilizada para la comparación de dos modelos anidados cualesquiera.</p>
<p>Sin pérdida de generalidad, se considera la comparación de dos modelos lineales <span class="math inline">\(\omega\)</span> y <span class="math inline">\(\Omega\)</span>, dónde <span class="math inline">\(dim(\Omega) = p\)</span> y <span class="math inline">\(dim(\omega) = q\)</span>, <span class="math inline">\(p&gt;q\)</span>. El modelo <span class="math inline">\(\omega\)</span> resulta de una restricción lineal de los parámetros de <span class="math inline">\(\Omega\)</span>. Así:<span class="math display">\[ H_0: Y(t) = X_1\alpha_1(t) + \epsilon(t) \hspace{5pt}\text{versus} \hspace{5pt} H_a: Y(t) = X_1\alpha_1(t) +  X_2\alpha_2(t) +\epsilon(t) \]</span></p>
<p>Sea <span class="math display">\[\textbf{F} = \frac{(rss_\omega - rss_\Omega)/(p-q)}{rss_\Omega/(n-p)} \approx \frac{traza(\hat{\sum}^\omega - \hat{\sum}^\Omega)/(p-q)}{traza(\hat{\sum}^\Omega)/(n-p)}\]</span>
con <span class="math inline">\(rss = \sum_{i=1}^n \int_t (y_i(t) - \hat{y}_i(t))^2 dt.\)</span></p>
<p> Asumiendo que el proceso de ruido <span class="math inline">\(\epsilon_i(t)\)</span> es gaussiano e independiente y con función de covarianza continua <span class="math inline">\(r(s,t)\)</span> sobre un intervalo cerrado <span class="math inline">\(\tau\)</span>, entonces bajo el sistema de hipótesis descrito, la estadística se distribuye como <span class="math display">\[\frac{\sum_{i=1}^\infty r_i \chi_{p-q}^2/(p-q)}{\sum_{i=1}^\infty r_i \chi_{n-p}^2/(n-p)}\]</span>
dónde <span class="math inline">\(r_i\)</span> es el <span class="math inline">\(i\)</span>-ésimo valor propio ordenado de la función de covarianza <span class="math inline">\(r(s,t)\)</span> y las variables <span class="math inline">\(\chi^2\)</span> son independientes.</p>
<p>En su artículo los autores demuestran que la estadística tiene una distribución denominada distribución funcional con coeficientes <span class="math inline">\({r_i, i =1,2,...,\infty}\)</span> y grados de libertad <span class="math inline">\((p-q, n-p)\)</span>. Así mismo, realizan la aproximación de esta distribución a la distribución <span class="math inline">\(F\)</span> de Fisher con grados de libertad <span class="math inline">\(f_1\)</span> y <span class="math inline">\(f_2\)</span>:<span class="math display">\[f_1 = \frac{(\sum_{i=1}^\infty r_i)^2}{\sum_{i=1}^\infty r_i^2}(p-q); f_2 = \frac{(\sum_{i=1}^\infty r_i)^2}{\sum_{i=1}^\infty r_i^2}(n-p)\]</span>
En la práctica, solo se observa <span class="math inline">\(y_i(t)\)</span> sobre una grilla de puntos <span class="math inline">\(t_j\)</span>, <span class="math inline">\(j = 1,2,...,M\)</span>, así, el factor de ajuste <span class="math inline">\(\frac{(\sum_{i=1}^\infty r_i)^2}{\sum_{i=1}^\infty r_i^2}\)</span> puede ser estimado por <span class="math inline">\(\frac{traza(E)^2}{traza(E^2)}\)</span>, dónde <span class="math inline">\(E = \hat{\sum}^\Omega\)</span> es la matriz de covarianza empírica del ruido calculada con el modelo completo <span class="math inline">\(\Omega\)</span>.</p>
</div>
<div id="ejemplo" class="section level3 hasAnchor" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Ejemplo<a href="análisis-de-datos-funcionales.html#ejemplo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="experimento" class="section level4 hasAnchor" number="13.4.4.1">
<h4><span class="header-section-number">13.4.4.1</span> Experimento<a href="análisis-de-datos-funcionales.html#experimento" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La situación experimental llevada a cabo y que dió origen a la base de datos con la cual se realizan las aplicaciones, parte de que a un paciente se le mostraba un conjunto de palabras con carga emocional positiva (abrazo, paz, regalo), negativa (guerra, enfermedad, muerte), o neutra (número, roca), y también una serie de no palabras. Su tarea consistía en responder mediante un botón adyacente cuando aparecía únicamente una palabra. El número de pacientes total en el experimento fue de 48, de los cuales 30 son hombres y los restantes 18 mujeres.</p>
<p>La presentación de los estímulos y la realización de la tarea se hace en sincronía con el registro del electroencefalograma (EEG) con lo cual se obtiene la medición de la actividad del cerebro medida como la diferencia entre el voltaje máximo y la línea base preestimular (electrodo determinado) para cada condición experimental determinada, cada 4 milisegundos, obteniendo un total de 350 mediciones por paciente en cada uno de los 19 electrodos muestreados (dispuestos en ubicaciones establecidas por el sistema 10-20).</p>
</div>
<div id="sistema-de-referencia-10-20" class="section level4 hasAnchor" number="13.4.4.2">
<h4><span class="header-section-number">13.4.4.2</span> Sistema de referencia 10-20<a href="análisis-de-datos-funcionales.html#sistema-de-referencia-10-20" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El registro del EEG se realiza con distintos tipos de electrodos distribuidos según un mapa normalizado por la Federación de Electroencefalografia y Neurofisiologia Clinica, en base al sistema de coordenadas 10-20, que determina las coordenadas de cada punto de registro mediante porcentajes (10-20) de la distancia existente entre puntos del cráneo bien definidos. Esto permite el estudio de la misma región independientemente de las dimensiones y de la forma del cráneo.</p>
<p>En el primer Congreso Internacional de EEG, que se celebró en Londres en 1947, se reconoció que era necesario un método estándar de la colocación de los electrodos utilizados en el electroencefalograma (EEG). Varias discusiones entorno al tema dieron lugar a la definición del sistema de electrodos 10-20 (Hasper, 1958). Desde entonces, este sistema de electrodos se ha convertido en el estándar para los clínicos y para el estudio de potenciales relacionados con eventos (potenciales evocados) en entornos no clínicos.</p>
<p>Con el fin de determinar bajo este sistema las coordenadas de los 19 electrodos utilizados en el experimento anteriormente descrito, se utilizaron las coordenadas de todos los lugares del electrodo en una superficie de la cabeza <span class="math inline">\(real\)</span>, sobre la base de las distancias a lo largo de la superficie (triangular) de la cabeza. La superficie de la cabeza utilizada fue construida a partir de la resonancia magnética canónica que se incluye en el paquete <span class="math inline">\(SPM2\)</span>, y las ubicaciones se expresan en coordenadas <span class="math inline">\(MNI\)</span> (standard Montreal Neurological Institute) (Oostenveld &amp; Praamstra, 2001)</p>
<p>En la figura se presenta la gráfica de las coordenadas de los electrodos bajo el sistema 10-20:</p>
<div class="figure">
<img src="data_11_PatronesPuntuales/4_ModelosLinealesFuncionales/Coord10-20.jpg" alt="" />
<p class="caption">Sistema 10 - 20</p>
</div>
<div class="figure">
<img src="data_11_PatronesPuntuales/4_ModelosLinealesFuncionales/Captura.PNG" style="width:7cm" alt="" />
<p class="caption">Sistema 20</p>
</div>
</div>
<div id="análisis-de-varianza-a-dos-vías-de-clasificación" class="section level4 hasAnchor" number="13.4.4.3">
<h4><span class="header-section-number">13.4.4.3</span> Análisis de varianza a dos vías de clasificación<a href="análisis-de-datos-funcionales.html#análisis-de-varianza-a-dos-vías-de-clasificación" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La energía liberada por el cerebro al ser estimulado con palabras de distinta carga emocional es diferente si el paciente es hombre o mujer. En el caso de la localización del electrodo <span class="math inline">\(C3\)</span>, los hombres presentan diferencias en algunos tiempos específicos mientras que las mujeres no. En esta sección se propone realizar una análisis de varianza con dos factores fijos que corresponden al tipo de estímulo al cual es sometido el paciente y al género del mismo.</p>
<p>En este caso el proceso de suavizamiento se realizó con 40 funciones base. La curva media de todas las observaciones realizadas en la localización del electrodo <span class="math inline">\(C3\)</span> establece que el pico máximo de liberación de energía se presenta alrededor del milisegundo 400, es decir 200 milisegundos después de la aparición del estímulo.</p>
<p>Las funciones medias estimadas, sugieren que los hombres estimulados con palabras de carga positiva emiten menos energía y las mujeres estimuladas con palabras de carga negativa emiten mayor energía.</p>
<p>Al aplicar la prueba <span class="math inline">\(F\)</span> funcional propuesta por Shen y Faraway (2004), se concluye con un nivel de significancia del 5% que no existen diferencias significativas en la respuesta bioelectrica del cerebro de mujeres y hombres cuando son estimulados con palabras de distinta carga emocional (positivos vs negativos).</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="análisis-de-datos-funcionales.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb531-2"><a href="análisis-de-datos-funcionales.html#cb531-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Código para hacer  Regresión Funcional con</span></span>
<span id="cb531-3"><a href="análisis-de-datos-funcionales.html#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="co"># los datos de un lectrodo determinado, con los  </span></span>
<span id="cb531-4"><a href="análisis-de-datos-funcionales.html#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pacientes de ambos genero determinado, los 2 estimulos </span></span>
<span id="cb531-5"><a href="análisis-de-datos-funcionales.html#cb531-5" aria-hidden="true" tabindex="-1"></a><span class="co">#(palabras positivas y negativas),para un total de</span></span>
<span id="cb531-6"><a href="análisis-de-datos-funcionales.html#cb531-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 60 filas) y 350 mediciones en el tiempo.</span></span>
<span id="cb531-7"><a href="análisis-de-datos-funcionales.html#cb531-7" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb531-8"><a href="análisis-de-datos-funcionales.html#cb531-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-9"><a href="análisis-de-datos-funcionales.html#cb531-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb531-10"><a href="análisis-de-datos-funcionales.html#cb531-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb531-11"><a href="análisis-de-datos-funcionales.html#cb531-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb531-12"><a href="análisis-de-datos-funcionales.html#cb531-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-13"><a href="análisis-de-datos-funcionales.html#cb531-13" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">&quot;data_11_PatronesPuntuales/4_ModelosLinealesFuncionales/BrainDT.txt&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb531-14"><a href="análisis-de-datos-funcionales.html#cb531-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-15"><a href="análisis-de-datos-funcionales.html#cb531-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-16"><a href="análisis-de-datos-funcionales.html#cb531-16" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>esite)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;C3&quot;</span>,<span class="st">&quot;C4&quot;</span>,<span class="st">&quot;CZ&quot;</span>,<span class="st">&quot;F3&quot;</span>,<span class="st">&quot;F4&quot;</span>,<span class="st">&quot;F7&quot;</span>,<span class="st">&quot;F8&quot;</span>,<span class="st">&quot;FP1&quot;</span>,<span class="st">&quot;FP2&quot;</span>,<span class="st">&quot;FZ&quot;</span>,<span class="st">&quot;O1&quot;</span>,<span class="st">&quot;O2&quot;</span>,<span class="st">&quot;P3&quot;</span>,<span class="st">&quot;P4&quot;</span>,<span class="st">&quot;PZ&quot;</span>,<span class="st">&quot;T3&quot;</span>,<span class="st">&quot;T4&quot;</span>,<span class="st">&quot;T5&quot;</span>,<span class="st">&quot;T6&quot;</span>,<span class="st">&quot;VEOG&quot;</span>)</span>
<span id="cb531-17"><a href="análisis-de-datos-funcionales.html#cb531-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-18"><a href="análisis-de-datos-funcionales.html#cb531-18" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb531-19"><a href="análisis-de-datos-funcionales.html#cb531-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Creación de la base, determinando el sexo de los</span></span>
<span id="cb531-20"><a href="análisis-de-datos-funcionales.html#cb531-20" aria-hidden="true" tabindex="-1"></a><span class="co"># pacientes  y el electrodo que se quiere estudiar</span></span>
<span id="cb531-21"><a href="análisis-de-datos-funcionales.html#cb531-21" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb531-22"><a href="análisis-de-datos-funcionales.html#cb531-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-23"><a href="análisis-de-datos-funcionales.html#cb531-23" aria-hidden="true" tabindex="-1"></a>BASEPOSI<span class="ot">&lt;-</span>(datos<span class="sc">$</span>esite<span class="sc">==</span><span class="st">&quot;C3&quot;</span>)<span class="sc">&amp;</span>(datos<span class="sc">$</span>wordtype<span class="sc">==</span><span class="st">&quot;1&quot;</span>)<span class="sc">&amp;</span>(datos<span class="sc">$</span>subject <span class="sc">!=</span><span class="st">&quot;1&quot;</span>)</span>
<span id="cb531-24"><a href="análisis-de-datos-funcionales.html#cb531-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-25"><a href="análisis-de-datos-funcionales.html#cb531-25" aria-hidden="true" tabindex="-1"></a>BASENEGA<span class="ot">&lt;-</span>(datos<span class="sc">$</span>esite<span class="sc">==</span><span class="st">&quot;C3&quot;</span>)<span class="sc">&amp;</span>(datos<span class="sc">$</span>wordtype<span class="sc">==</span><span class="st">&quot;2&quot;</span>)<span class="sc">&amp;</span>(datos<span class="sc">$</span>subject <span class="sc">!=</span><span class="st">&quot;1&quot;</span>)</span>
<span id="cb531-26"><a href="análisis-de-datos-funcionales.html#cb531-26" aria-hidden="true" tabindex="-1"></a>BASEPOSI <span class="ot">=</span> <span class="fu">as.matrix</span>(datos[BASEPOSI,<span class="dv">4</span><span class="sc">:</span><span class="dv">353</span>])</span>
<span id="cb531-27"><a href="análisis-de-datos-funcionales.html#cb531-27" aria-hidden="true" tabindex="-1"></a>BASENEGA <span class="ot">=</span> <span class="fu">as.matrix</span>(datos[BASENEGA,<span class="dv">4</span><span class="sc">:</span><span class="dv">353</span>])</span>
<span id="cb531-28"><a href="análisis-de-datos-funcionales.html#cb531-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-29"><a href="análisis-de-datos-funcionales.html#cb531-29" aria-hidden="true" tabindex="-1"></a>BASETOTAL <span class="ot">=</span>(datos<span class="sc">$</span>esite<span class="sc">==</span><span class="st">&quot;C3&quot;</span>)<span class="sc">&amp;</span>((datos<span class="sc">$</span>wordtype<span class="sc">==</span><span class="st">&quot;1&quot;</span>)<span class="sc">|</span>(datos<span class="sc">$</span>wordtype<span class="sc">==</span><span class="st">&quot;2&quot;</span>))<span class="sc">&amp;</span>(datos<span class="sc">$</span>subject <span class="sc">!=</span><span class="st">&quot;1&quot;</span>)</span>
<span id="cb531-30"><a href="análisis-de-datos-funcionales.html#cb531-30" aria-hidden="true" tabindex="-1"></a>BASETOTAL <span class="ot">=</span><span class="fu">as.matrix</span>(datos[BASETOTAL,<span class="dv">4</span><span class="sc">:</span><span class="dv">353</span>])</span>
<span id="cb531-31"><a href="análisis-de-datos-funcionales.html#cb531-31" aria-hidden="true" tabindex="-1"></a>BASETOTALT <span class="ot">=</span> <span class="fu">t</span>(BASETOTAL)</span>
<span id="cb531-32"><a href="análisis-de-datos-funcionales.html#cb531-32" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">dim</span>(BASETOTALT)[<span class="dv">1</span>]</span>
<span id="cb531-33"><a href="análisis-de-datos-funcionales.html#cb531-33" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(BASETOTALT)[<span class="dv">2</span>]</span>
<span id="cb531-34"><a href="análisis-de-datos-funcionales.html#cb531-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-35"><a href="análisis-de-datos-funcionales.html#cb531-35" aria-hidden="true" tabindex="-1"></a>BASEPOSIT <span class="ot">=</span> <span class="fu">t</span>(BASEPOSI)</span>
<span id="cb531-36"><a href="análisis-de-datos-funcionales.html#cb531-36" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(BASEPOSIT)</span></code></pre></div>
<pre><code>## [1] 350  46</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="análisis-de-datos-funcionales.html#cb533-1" aria-hidden="true" tabindex="-1"></a>BASENEGAT <span class="ot">=</span> <span class="fu">t</span>(BASENEGA)</span>
<span id="cb533-2"><a href="análisis-de-datos-funcionales.html#cb533-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(BASENEGAT)</span></code></pre></div>
<pre><code>## [1] 350  46</code></pre>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="análisis-de-datos-funcionales.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb535-2"><a href="análisis-de-datos-funcionales.html#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creación de una base B spline de orden 4 y k = 40.</span></span>
<span id="cb535-3"><a href="análisis-de-datos-funcionales.html#cb535-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb535-4"><a href="análisis-de-datos-funcionales.html#cb535-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-5"><a href="análisis-de-datos-funcionales.html#cb535-5" aria-hidden="true" tabindex="-1"></a>time<span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">1400</span>,<span class="dv">4</span>))</span>
<span id="cb535-6"><a href="análisis-de-datos-funcionales.html#cb535-6" aria-hidden="true" tabindex="-1"></a>rangeval <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1400</span>)</span>
<span id="cb535-7"><a href="análisis-de-datos-funcionales.html#cb535-7" aria-hidden="true" tabindex="-1"></a>nbasis <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb535-8"><a href="análisis-de-datos-funcionales.html#cb535-8" aria-hidden="true" tabindex="-1"></a>norder <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb535-9"><a href="análisis-de-datos-funcionales.html#cb535-9" aria-hidden="true" tabindex="-1"></a>basis6 <span class="ot">=</span> <span class="fu">create.bspline.basis</span>(rangeval, nbasis, norder)</span>
<span id="cb535-10"><a href="análisis-de-datos-funcionales.html#cb535-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-11"><a href="análisis-de-datos-funcionales.html#cb535-11" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span>n)</span>
<span id="cb535-12"><a href="análisis-de-datos-funcionales.html#cb535-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-13"><a href="análisis-de-datos-funcionales.html#cb535-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb535-14"><a href="análisis-de-datos-funcionales.html#cb535-14" aria-hidden="true" tabindex="-1"></a>fdhposi <span class="ot">=</span> <span class="fu">Data2fd</span>(<span class="at">argvals =</span> time, <span class="at">y =</span> BASEPOSIT, <span class="at">basisobj =</span> basis6)</span>
<span id="cb535-15"><a href="análisis-de-datos-funcionales.html#cb535-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdhposi,<span class="at">col=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>,<span class="at">pch =</span> <span class="dv">56</span>, <span class="at">main =</span> <span class="st">&quot;Estimulo positivo&quot;</span> )</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="análisis-de-datos-funcionales.html#cb537-1" aria-hidden="true" tabindex="-1"></a>fdhnega <span class="ot">=</span> <span class="fu">Data2fd</span>(time,BASENEGAT,  basis6)</span>
<span id="cb537-2"><a href="análisis-de-datos-funcionales.html#cb537-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdhnega, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>,<span class="at">pch =</span> <span class="dv">56</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">main =</span> <span class="st">&quot;Estimulo negativo&quot;</span> )</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-1.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="análisis-de-datos-funcionales.html#cb539-1" aria-hidden="true" tabindex="-1"></a>fdh <span class="ot">=</span> <span class="fu">Data2fd</span>( time,BASETOTALT, basis6)</span>
<span id="cb539-2"><a href="análisis-de-datos-funcionales.html#cb539-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdh,<span class="at">col=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), n), <span class="at">xlab=</span><span class="st">&quot;Tiempo(milisegundos)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje(Voltios)&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>,<span class="at">pch =</span> <span class="dv">56</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="análisis-de-datos-funcionales.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb541-2"><a href="análisis-de-datos-funcionales.html#cb541-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Determinación y grafica de la media y la varianza.</span></span>
<span id="cb541-3"><a href="análisis-de-datos-funcionales.html#cb541-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb541-4"><a href="análisis-de-datos-funcionales.html#cb541-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-5"><a href="análisis-de-datos-funcionales.html#cb541-5" aria-hidden="true" tabindex="-1"></a>meanfdh <span class="ot">&lt;-</span> <span class="fu">mean.fd</span>(fdh)</span>
<span id="cb541-6"><a href="análisis-de-datos-funcionales.html#cb541-6" aria-hidden="true" tabindex="-1"></a>varfdh <span class="ot">&lt;-</span><span class="fu">var.fd</span>(fdh)</span>
<span id="cb541-7"><a href="análisis-de-datos-funcionales.html#cb541-7" aria-hidden="true" tabindex="-1"></a>stdvfdh  <span class="ot">&lt;-</span> <span class="fu">stddev.fd</span>(fdh)</span>
<span id="cb541-8"><a href="análisis-de-datos-funcionales.html#cb541-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-2.png" width="672" /></p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="análisis-de-datos-funcionales.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(meanfdh,               <span class="at">main=</span><span class="st">&quot;Media&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span> )</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="análisis-de-datos-funcionales.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stdvfdh, <span class="at">main=</span><span class="st">&quot;Desviación estándar&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-3.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="análisis-de-datos-funcionales.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stdvfdh<span class="sc">^</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">&quot;Varianza&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="análisis-de-datos-funcionales.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="co">#windows()</span></span>
<span id="cb548-2"><a href="análisis-de-datos-funcionales.html#cb548-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fdh,<span class="at">col=</span><span class="dv">8</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo (milisegundos)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje (Voltios)&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="análisis-de-datos-funcionales.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(meanfdh,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb550-2"><a href="análisis-de-datos-funcionales.html#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(stdvfdh, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">main=</span><span class="st">&quot;Desviación estándar&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Tiempo (milisegundos)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje (Voltios)&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-4.png" width="672" /></p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="análisis-de-datos-funcionales.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-2"><a href="análisis-de-datos-funcionales.html#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo lineal con variable respuesta la curva de</span></span>
<span id="cb551-3"><a href="análisis-de-datos-funcionales.html#cb551-3" aria-hidden="true" tabindex="-1"></a><span class="co"># la energia liberada por el cerebro y  variable </span></span>
<span id="cb551-4"><a href="análisis-de-datos-funcionales.html#cb551-4" aria-hidden="true" tabindex="-1"></a><span class="co"># explicativa  el tipo de estímulo al cual el paciente </span></span>
<span id="cb551-5"><a href="análisis-de-datos-funcionales.html#cb551-5" aria-hidden="true" tabindex="-1"></a><span class="co"># es sometido.</span></span>
<span id="cb551-6"><a href="análisis-de-datos-funcionales.html#cb551-6" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-7"><a href="análisis-de-datos-funcionales.html#cb551-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-8"><a href="análisis-de-datos-funcionales.html#cb551-8" aria-hidden="true" tabindex="-1"></a>matrizh <span class="ot">&lt;-</span> <span class="fu">eval.basis</span>(time, basis6)</span>
<span id="cb551-9"><a href="análisis-de-datos-funcionales.html#cb551-9" aria-hidden="true" tabindex="-1"></a>y2cMap <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">crossprod</span>(matrizh)) <span class="sc">%*%</span> <span class="fu">t</span>(matrizh)</span>
<span id="cb551-10"><a href="análisis-de-datos-funcionales.html#cb551-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-11"><a href="análisis-de-datos-funcionales.html#cb551-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-12"><a href="análisis-de-datos-funcionales.html#cb551-12" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-13"><a href="análisis-de-datos-funcionales.html#cb551-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de los estímulos</span></span>
<span id="cb551-14"><a href="análisis-de-datos-funcionales.html#cb551-14" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-15"><a href="análisis-de-datos-funcionales.html#cb551-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-16"><a href="análisis-de-datos-funcionales.html#cb551-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-17"><a href="análisis-de-datos-funcionales.html#cb551-17" aria-hidden="true" tabindex="-1"></a>estimulos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Efecto global&quot;</span>, <span class="st">&quot;Positivo  &quot;</span>, <span class="st">&quot;Negativo&quot;</span>,<span class="st">&quot;Hombre&quot;</span>, <span class="st">&quot;Mujer&quot;</span>)</span>
<span id="cb551-18"><a href="análisis-de-datos-funcionales.html#cb551-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-19"><a href="análisis-de-datos-funcionales.html#cb551-19" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-20"><a href="análisis-de-datos-funcionales.html#cb551-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Indices para los estimulos y los generos</span></span>
<span id="cb551-21"><a href="análisis-de-datos-funcionales.html#cb551-21" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-22"><a href="análisis-de-datos-funcionales.html#cb551-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-23"><a href="análisis-de-datos-funcionales.html#cb551-23" aria-hidden="true" tabindex="-1"></a>posiindex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,   <span class="dv">3</span>,  <span class="dv">5</span>,  <span class="dv">7</span>,  <span class="dv">9</span>,  <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">21</span>,</span>
<span id="cb551-24"><a href="análisis-de-datos-funcionales.html#cb551-24" aria-hidden="true" tabindex="-1"></a>               <span class="dv">23</span>,  <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">29</span>, <span class="dv">31</span>, <span class="dv">33</span>, <span class="dv">35</span>,<span class="dv">37</span>,<span class="dv">39</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">45</span>,<span class="dv">47</span>,<span class="dv">49</span>,<span class="dv">51</span>,<span class="dv">53</span>,<span class="dv">55</span>,<span class="dv">57</span>)</span>
<span id="cb551-25"><a href="análisis-de-datos-funcionales.html#cb551-25" aria-hidden="true" tabindex="-1"></a>negindex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,    <span class="dv">4</span>,  <span class="dv">6</span>,  <span class="dv">8</span>,  <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">20</span>,</span>
<span id="cb551-26"><a href="análisis-de-datos-funcionales.html#cb551-26" aria-hidden="true" tabindex="-1"></a>              <span class="dv">22</span>,   <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">34</span>, <span class="dv">36</span>,<span class="dv">38</span>,<span class="dv">40</span>,<span class="dv">42</span>,<span class="dv">44</span>,<span class="dv">46</span>,<span class="dv">48</span>,<span class="dv">50</span>,<span class="dv">52</span>,<span class="dv">54</span>,<span class="dv">56</span>,<span class="dv">58</span>)</span>
<span id="cb551-27"><a href="análisis-de-datos-funcionales.html#cb551-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-28"><a href="análisis-de-datos-funcionales.html#cb551-28" aria-hidden="true" tabindex="-1"></a>hombres <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">58</span>,<span class="dv">1</span>)</span>
<span id="cb551-29"><a href="análisis-de-datos-funcionales.html#cb551-29" aria-hidden="true" tabindex="-1"></a>mujeres <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">59</span>,<span class="dv">92</span>,<span class="dv">1</span>)</span>
<span id="cb551-30"><a href="análisis-de-datos-funcionales.html#cb551-30" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-31"><a href="análisis-de-datos-funcionales.html#cb551-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz diseño</span></span>
<span id="cb551-32"><a href="análisis-de-datos-funcionales.html#cb551-32" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-33"><a href="análisis-de-datos-funcionales.html#cb551-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-34"><a href="análisis-de-datos-funcionales.html#cb551-34" aria-hidden="true" tabindex="-1"></a>zmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">92</span>,<span class="dv">5</span>)</span>
<span id="cb551-35"><a href="análisis-de-datos-funcionales.html#cb551-35" aria-hidden="true" tabindex="-1"></a>zmat[        ,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb551-36"><a href="análisis-de-datos-funcionales.html#cb551-36" aria-hidden="true" tabindex="-1"></a>zmat[posiindex,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb551-37"><a href="análisis-de-datos-funcionales.html#cb551-37" aria-hidden="true" tabindex="-1"></a>zmat[negindex,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb551-38"><a href="análisis-de-datos-funcionales.html#cb551-38" aria-hidden="true" tabindex="-1"></a>zmat[hombres,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb551-39"><a href="análisis-de-datos-funcionales.html#cb551-39" aria-hidden="true" tabindex="-1"></a>zmat[mujeres,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb551-40"><a href="análisis-de-datos-funcionales.html#cb551-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-41"><a href="análisis-de-datos-funcionales.html#cb551-41" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-42"><a href="análisis-de-datos-funcionales.html#cb551-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Generación de la fila, para garantizar la ortogonalidad</span></span>
<span id="cb551-43"><a href="análisis-de-datos-funcionales.html#cb551-43" aria-hidden="true" tabindex="-1"></a><span class="co">#y estimabilidad de los parámetros referentes a estímulos.</span></span>
<span id="cb551-44"><a href="análisis-de-datos-funcionales.html#cb551-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1)</span></span>
<span id="cb551-45"><a href="análisis-de-datos-funcionales.html#cb551-45" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-46"><a href="análisis-de-datos-funcionales.html#cb551-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-47"><a href="análisis-de-datos-funcionales.html#cb551-47" aria-hidden="true" tabindex="-1"></a>z93    <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb551-48"><a href="análisis-de-datos-funcionales.html#cb551-48" aria-hidden="true" tabindex="-1"></a>z93[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-49"><a href="análisis-de-datos-funcionales.html#cb551-49" aria-hidden="true" tabindex="-1"></a>z93[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-50"><a href="análisis-de-datos-funcionales.html#cb551-50" aria-hidden="true" tabindex="-1"></a>z93[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-51"><a href="análisis-de-datos-funcionales.html#cb551-51" aria-hidden="true" tabindex="-1"></a>zmat   <span class="ot">&lt;-</span> <span class="fu">rbind</span>(zmat, z93)</span>
<span id="cb551-52"><a href="análisis-de-datos-funcionales.html#cb551-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-53"><a href="análisis-de-datos-funcionales.html#cb551-53" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-54"><a href="análisis-de-datos-funcionales.html#cb551-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimación de la fila generada a través de las </span></span>
<span id="cb551-55"><a href="análisis-de-datos-funcionales.html#cb551-55" aria-hidden="true" tabindex="-1"></a><span class="co">#funciones base.</span></span>
<span id="cb551-56"><a href="análisis-de-datos-funcionales.html#cb551-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1).</span></span>
<span id="cb551-57"><a href="análisis-de-datos-funcionales.html#cb551-57" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-58"><a href="análisis-de-datos-funcionales.html#cb551-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-59"><a href="análisis-de-datos-funcionales.html#cb551-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-60"><a href="análisis-de-datos-funcionales.html#cb551-60" aria-hidden="true" tabindex="-1"></a>coef   <span class="ot">&lt;-</span> fdh<span class="sc">$</span>coefs</span>
<span id="cb551-61"><a href="análisis-de-datos-funcionales.html#cb551-61" aria-hidden="true" tabindex="-1"></a>coef93 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coef,<span class="fu">matrix</span>(<span class="dv">0</span>,nbasis,<span class="dv">1</span>))</span>
<span id="cb551-62"><a href="análisis-de-datos-funcionales.html#cb551-62" aria-hidden="true" tabindex="-1"></a>fdh<span class="sc">$</span>coefs <span class="ot">&lt;-</span> coef93</span>
<span id="cb551-63"><a href="análisis-de-datos-funcionales.html#cb551-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-64"><a href="análisis-de-datos-funcionales.html#cb551-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-65"><a href="análisis-de-datos-funcionales.html#cb551-65" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-66"><a href="análisis-de-datos-funcionales.html#cb551-66" aria-hidden="true" tabindex="-1"></a><span class="co">#Generación de las filas, para garantizar la ortogonalidad</span></span>
<span id="cb551-67"><a href="análisis-de-datos-funcionales.html#cb551-67" aria-hidden="true" tabindex="-1"></a><span class="co">#y estimabilidad de los parámetros referentes a genero.</span></span>
<span id="cb551-68"><a href="análisis-de-datos-funcionales.html#cb551-68" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1)</span></span>
<span id="cb551-69"><a href="análisis-de-datos-funcionales.html#cb551-69" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-70"><a href="análisis-de-datos-funcionales.html#cb551-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-71"><a href="análisis-de-datos-funcionales.html#cb551-71" aria-hidden="true" tabindex="-1"></a>z94    <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb551-72"><a href="análisis-de-datos-funcionales.html#cb551-72" aria-hidden="true" tabindex="-1"></a>z94[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-73"><a href="análisis-de-datos-funcionales.html#cb551-73" aria-hidden="true" tabindex="-1"></a>z94[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-74"><a href="análisis-de-datos-funcionales.html#cb551-74" aria-hidden="true" tabindex="-1"></a>z94[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-75"><a href="análisis-de-datos-funcionales.html#cb551-75" aria-hidden="true" tabindex="-1"></a>zmat   <span class="ot">&lt;-</span> <span class="fu">rbind</span>(zmat, z94)</span>
<span id="cb551-76"><a href="análisis-de-datos-funcionales.html#cb551-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-77"><a href="análisis-de-datos-funcionales.html#cb551-77" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-78"><a href="análisis-de-datos-funcionales.html#cb551-78" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimación de la fila generada a través de las </span></span>
<span id="cb551-79"><a href="análisis-de-datos-funcionales.html#cb551-79" aria-hidden="true" tabindex="-1"></a><span class="co">#funciones base.</span></span>
<span id="cb551-80"><a href="análisis-de-datos-funcionales.html#cb551-80" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1).</span></span>
<span id="cb551-81"><a href="análisis-de-datos-funcionales.html#cb551-81" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-82"><a href="análisis-de-datos-funcionales.html#cb551-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-83"><a href="análisis-de-datos-funcionales.html#cb551-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-84"><a href="análisis-de-datos-funcionales.html#cb551-84" aria-hidden="true" tabindex="-1"></a>coef   <span class="ot">&lt;-</span> fdh<span class="sc">$</span>coefs</span>
<span id="cb551-85"><a href="análisis-de-datos-funcionales.html#cb551-85" aria-hidden="true" tabindex="-1"></a>coef94 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coef,<span class="fu">matrix</span>(<span class="dv">0</span>,nbasis,<span class="dv">1</span>))</span>
<span id="cb551-86"><a href="análisis-de-datos-funcionales.html#cb551-86" aria-hidden="true" tabindex="-1"></a>fdh<span class="sc">$</span>coefs <span class="ot">&lt;-</span> coef94</span>
<span id="cb551-87"><a href="análisis-de-datos-funcionales.html#cb551-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-88"><a href="análisis-de-datos-funcionales.html#cb551-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-89"><a href="análisis-de-datos-funcionales.html#cb551-89" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-90"><a href="análisis-de-datos-funcionales.html#cb551-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación de los parametros funcionales, a través </span></span>
<span id="cb551-91"><a href="análisis-de-datos-funcionales.html#cb551-91" aria-hidden="true" tabindex="-1"></a><span class="co"># de 20 funciones base y de orden 4</span></span>
<span id="cb551-92"><a href="análisis-de-datos-funcionales.html#cb551-92" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-93"><a href="análisis-de-datos-funcionales.html#cb551-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-94"><a href="análisis-de-datos-funcionales.html#cb551-94" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb551-95"><a href="análisis-de-datos-funcionales.html#cb551-95" aria-hidden="true" tabindex="-1"></a>xfdlist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,p)</span>
<span id="cb551-96"><a href="análisis-de-datos-funcionales.html#cb551-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) xfdlist[[j]] <span class="ot">&lt;-</span> zmat[,j]</span>
<span id="cb551-97"><a href="análisis-de-datos-funcionales.html#cb551-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-98"><a href="análisis-de-datos-funcionales.html#cb551-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-99"><a href="análisis-de-datos-funcionales.html#cb551-99" aria-hidden="true" tabindex="-1"></a>nbetabasis <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb551-100"><a href="análisis-de-datos-funcionales.html#cb551-100" aria-hidden="true" tabindex="-1"></a>betabasis <span class="ot">=</span> <span class="fu">create.bspline.basis</span>(rangeval, nbetabasis, norder)</span>
<span id="cb551-101"><a href="análisis-de-datos-funcionales.html#cb551-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-102"><a href="análisis-de-datos-funcionales.html#cb551-102" aria-hidden="true" tabindex="-1"></a>betafd    <span class="ot">&lt;-</span> <span class="fu">fd</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,nbetabasis,<span class="dv">1</span>), betabasis)</span>
<span id="cb551-103"><a href="análisis-de-datos-funcionales.html#cb551-103" aria-hidden="true" tabindex="-1"></a>estimate  <span class="ot">&lt;-</span> T</span>
<span id="cb551-104"><a href="análisis-de-datos-funcionales.html#cb551-104" aria-hidden="true" tabindex="-1"></a>lambda    <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb551-105"><a href="análisis-de-datos-funcionales.html#cb551-105" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(betafd)</span>
<span id="cb551-106"><a href="análisis-de-datos-funcionales.html#cb551-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-107"><a href="análisis-de-datos-funcionales.html#cb551-107" aria-hidden="true" tabindex="-1"></a>betalist <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,p)</span>
<span id="cb551-108"><a href="análisis-de-datos-funcionales.html#cb551-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) betalist[[j]] <span class="ot">&lt;-</span> betafdPar</span>
<span id="cb551-109"><a href="análisis-de-datos-funcionales.html#cb551-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-110"><a href="análisis-de-datos-funcionales.html#cb551-110" aria-hidden="true" tabindex="-1"></a>fRegressList <span class="ot">&lt;-</span> <span class="fu">fRegress</span>(fdh, xfdlist, betalist)</span>
<span id="cb551-111"><a href="análisis-de-datos-funcionales.html#cb551-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-112"><a href="análisis-de-datos-funcionales.html#cb551-112" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb551-113"><a href="análisis-de-datos-funcionales.html#cb551-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de parámetros funcionales (betas) estimados</span></span>
<span id="cb551-114"><a href="análisis-de-datos-funcionales.html#cb551-114" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb551-115"><a href="análisis-de-datos-funcionales.html#cb551-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-116"><a href="análisis-de-datos-funcionales.html#cb551-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-117"><a href="análisis-de-datos-funcionales.html#cb551-117" aria-hidden="true" tabindex="-1"></a>betaestlist <span class="ot">&lt;-</span> fRegressList<span class="sc">$</span>betaestlist</span>
<span id="cb551-118"><a href="análisis-de-datos-funcionales.html#cb551-118" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb551-119"><a href="análisis-de-datos-funcionales.html#cb551-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) </span>
<span id="cb551-120"><a href="análisis-de-datos-funcionales.html#cb551-120" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb551-121"><a href="análisis-de-datos-funcionales.html#cb551-121" aria-hidden="true" tabindex="-1"></a>  betaestParfdj <span class="ot">&lt;-</span> betaestlist[[j]]</span>
<span id="cb551-122"><a href="análisis-de-datos-funcionales.html#cb551-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(betaestParfdj<span class="sc">$</span>fd, <span class="at">xlab=</span><span class="st">&quot;Tiempo (milisegundos)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje (Voltios)&quot;</span>,</span>
<span id="cb551-123"><a href="análisis-de-datos-funcionales.html#cb551-123" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span>estimulos[j])</span>
<span id="cb551-124"><a href="análisis-de-datos-funcionales.html#cb551-124" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-5.png" width="672" /></p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="análisis-de-datos-funcionales.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb552-2"><a href="análisis-de-datos-funcionales.html#cb552-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de funciones predichas</span></span>
<span id="cb552-3"><a href="análisis-de-datos-funcionales.html#cb552-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb552-4"><a href="análisis-de-datos-funcionales.html#cb552-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-5"><a href="análisis-de-datos-funcionales.html#cb552-5" aria-hidden="true" tabindex="-1"></a>yfdpar <span class="ot">&lt;-</span> fRegressList<span class="sc">$</span>yfdpar</span>
<span id="cb552-6"><a href="análisis-de-datos-funcionales.html#cb552-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-7"><a href="análisis-de-datos-funcionales.html#cb552-7" aria-hidden="true" tabindex="-1"></a>yhatfdobj <span class="ot">&lt;-</span> fRegressList<span class="sc">$</span>yhatfdobj</span>
<span id="cb552-8"><a href="análisis-de-datos-funcionales.html#cb552-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhatfdobj)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="análisis-de-datos-funcionales.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb554-2"><a href="análisis-de-datos-funcionales.html#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la matriz de residuales y obtención de</span></span>
<span id="cb554-3"><a href="análisis-de-datos-funcionales.html#cb554-3" aria-hidden="true" tabindex="-1"></a><span class="co"># la matriz de varianza y covarianza</span></span>
<span id="cb554-4"><a href="análisis-de-datos-funcionales.html#cb554-4" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb554-5"><a href="análisis-de-datos-funcionales.html#cb554-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-6"><a href="análisis-de-datos-funcionales.html#cb554-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-7"><a href="análisis-de-datos-funcionales.html#cb554-7" aria-hidden="true" tabindex="-1"></a>yhatmat  <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time,yhatfdobj)      <span class="co"># Valores estimados</span></span>
<span id="cb554-8"><a href="análisis-de-datos-funcionales.html#cb554-8" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(yhatmat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>], <span class="at">col=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb554-9"><a href="análisis-de-datos-funcionales.html#cb554-9" aria-hidden="true" tabindex="-1"></a>ymat     <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time, fdh)              <span class="co"># Valores observados </span></span>
<span id="cb554-10"><a href="análisis-de-datos-funcionales.html#cb554-10" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(time,ymat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb554-11"><a href="análisis-de-datos-funcionales.html#cb554-11" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> betaestlist[[<span class="dv">1</span>]]                              </span>
<span id="cb554-12"><a href="análisis-de-datos-funcionales.html#cb554-12" aria-hidden="true" tabindex="-1"></a>alpha    <span class="ot">&lt;-</span>  <span class="fu">eval.fd</span>(time,alfa<span class="sc">$</span>fd)          <span class="co"># Constantes (Media) estimada</span></span>
<span id="cb554-13"><a href="análisis-de-datos-funcionales.html#cb554-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alfa<span class="sc">$</span>fd, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="análisis-de-datos-funcionales.html#cb556-1" aria-hidden="true" tabindex="-1"></a>Residuales <span class="ot">&lt;-</span> ymat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>] <span class="sc">-</span> yhatmat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>]  <span class="co"># Los residuales son iguales a observados - estimados</span></span>
<span id="cb556-2"><a href="análisis-de-datos-funcionales.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(Residuales, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-6.png" width="672" /></p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="análisis-de-datos-funcionales.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb557-2"><a href="análisis-de-datos-funcionales.html#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de contorno de la varianza de los residuales del modelo completo</span></span>
<span id="cb557-3"><a href="análisis-de-datos-funcionales.html#cb557-3" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb557-4"><a href="análisis-de-datos-funcionales.html#cb557-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-5"><a href="análisis-de-datos-funcionales.html#cb557-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb557-6"><a href="análisis-de-datos-funcionales.html#cb557-6" aria-hidden="true" tabindex="-1"></a>SigmaE   <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">t</span>(Residuales))</span>
<span id="cb557-7"><a href="análisis-de-datos-funcionales.html#cb557-7" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(SigmaE, <span class="at">xlab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb557-8"><a href="análisis-de-datos-funcionales.html#cb557-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(SigmaE)</span></code></pre></div>
<pre><code>## [1] 350 350</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="análisis-de-datos-funcionales.html#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb559-2"><a href="análisis-de-datos-funcionales.html#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de dsviación estandar de los residuales del modelo completo</span></span>
<span id="cb559-3"><a href="análisis-de-datos-funcionales.html#cb559-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb559-4"><a href="análisis-de-datos-funcionales.html#cb559-4" aria-hidden="true" tabindex="-1"></a>cexval <span class="ot">=</span> <span class="fl">1.2</span></span>
<span id="cb559-5"><a href="análisis-de-datos-funcionales.html#cb559-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)<span class="sc">+</span>cexval<span class="sc">+</span><span class="dv">2</span>, <span class="at">pty=</span><span class="st">&quot;m&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-7.png" width="672" /></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="análisis-de-datos-funcionales.html#cb560-1" aria-hidden="true" tabindex="-1"></a>stddevE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(SigmaE))</span>
<span id="cb560-2"><a href="análisis-de-datos-funcionales.html#cb560-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, stddevE, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>,</span>
<span id="cb560-3"><a href="análisis-de-datos-funcionales.html#cb560-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Desviacion estandar (Voltios)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars33-8.png" width="672" /></p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="análisis-de-datos-funcionales.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb561-2"><a href="análisis-de-datos-funcionales.html#cb561-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación del modelo reducido 1: Solo los estímulos</span></span>
<span id="cb561-3"><a href="análisis-de-datos-funcionales.html#cb561-3" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb561-4"><a href="análisis-de-datos-funcionales.html#cb561-4" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-5"><a href="análisis-de-datos-funcionales.html#cb561-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de los estímulos</span></span>
<span id="cb561-6"><a href="análisis-de-datos-funcionales.html#cb561-6" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-7"><a href="análisis-de-datos-funcionales.html#cb561-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-8"><a href="análisis-de-datos-funcionales.html#cb561-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-9"><a href="análisis-de-datos-funcionales.html#cb561-9" aria-hidden="true" tabindex="-1"></a>estimulos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Efecto global&quot;</span>, <span class="st">&quot;Positivo  &quot;</span>, <span class="st">&quot;Negativo&quot;</span>)</span>
<span id="cb561-10"><a href="análisis-de-datos-funcionales.html#cb561-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-11"><a href="análisis-de-datos-funcionales.html#cb561-11" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-12"><a href="análisis-de-datos-funcionales.html#cb561-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Indices para los estimulos </span></span>
<span id="cb561-13"><a href="análisis-de-datos-funcionales.html#cb561-13" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-14"><a href="análisis-de-datos-funcionales.html#cb561-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-15"><a href="análisis-de-datos-funcionales.html#cb561-15" aria-hidden="true" tabindex="-1"></a>posiindex1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">92</span>,<span class="dv">2</span>)</span>
<span id="cb561-16"><a href="análisis-de-datos-funcionales.html#cb561-16" aria-hidden="true" tabindex="-1"></a>negindex1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">92</span>,<span class="dv">2</span>)</span>
<span id="cb561-17"><a href="análisis-de-datos-funcionales.html#cb561-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-18"><a href="análisis-de-datos-funcionales.html#cb561-18" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-19"><a href="análisis-de-datos-funcionales.html#cb561-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz diseño</span></span>
<span id="cb561-20"><a href="análisis-de-datos-funcionales.html#cb561-20" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-21"><a href="análisis-de-datos-funcionales.html#cb561-21" aria-hidden="true" tabindex="-1"></a>q1 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb561-22"><a href="análisis-de-datos-funcionales.html#cb561-22" aria-hidden="true" tabindex="-1"></a>fdh1 <span class="ot">=</span> <span class="fu">Data2fd</span>(time,BASETOTALT, basis6)</span>
<span id="cb561-23"><a href="análisis-de-datos-funcionales.html#cb561-23" aria-hidden="true" tabindex="-1"></a>zmat1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">92</span>,<span class="dv">3</span>)</span>
<span id="cb561-24"><a href="análisis-de-datos-funcionales.html#cb561-24" aria-hidden="true" tabindex="-1"></a>zmat1[        ,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb561-25"><a href="análisis-de-datos-funcionales.html#cb561-25" aria-hidden="true" tabindex="-1"></a>zmat1[posiindex1,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb561-26"><a href="análisis-de-datos-funcionales.html#cb561-26" aria-hidden="true" tabindex="-1"></a>zmat1[negindex1,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb561-27"><a href="análisis-de-datos-funcionales.html#cb561-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-28"><a href="análisis-de-datos-funcionales.html#cb561-28" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-29"><a href="análisis-de-datos-funcionales.html#cb561-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Generación de la fila, para garantizar la ortogonalidad</span></span>
<span id="cb561-30"><a href="análisis-de-datos-funcionales.html#cb561-30" aria-hidden="true" tabindex="-1"></a><span class="co">#y estimabilidad de los parámetros.</span></span>
<span id="cb561-31"><a href="análisis-de-datos-funcionales.html#cb561-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1,1)</span></span>
<span id="cb561-32"><a href="análisis-de-datos-funcionales.html#cb561-32" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-33"><a href="análisis-de-datos-funcionales.html#cb561-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-34"><a href="análisis-de-datos-funcionales.html#cb561-34" aria-hidden="true" tabindex="-1"></a>z931    <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb561-35"><a href="análisis-de-datos-funcionales.html#cb561-35" aria-hidden="true" tabindex="-1"></a>z931[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb561-36"><a href="análisis-de-datos-funcionales.html#cb561-36" aria-hidden="true" tabindex="-1"></a>zmat1   <span class="ot">&lt;-</span> <span class="fu">rbind</span>(zmat1, z931)</span>
<span id="cb561-37"><a href="análisis-de-datos-funcionales.html#cb561-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-38"><a href="análisis-de-datos-funcionales.html#cb561-38" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-39"><a href="análisis-de-datos-funcionales.html#cb561-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimación de la fila generada a través de las </span></span>
<span id="cb561-40"><a href="análisis-de-datos-funcionales.html#cb561-40" aria-hidden="true" tabindex="-1"></a><span class="co">#funciones base.</span></span>
<span id="cb561-41"><a href="análisis-de-datos-funcionales.html#cb561-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1,1).</span></span>
<span id="cb561-42"><a href="análisis-de-datos-funcionales.html#cb561-42" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-43"><a href="análisis-de-datos-funcionales.html#cb561-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-44"><a href="análisis-de-datos-funcionales.html#cb561-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-45"><a href="análisis-de-datos-funcionales.html#cb561-45" aria-hidden="true" tabindex="-1"></a>coef   <span class="ot">&lt;-</span> fdh1<span class="sc">$</span>coefs</span>
<span id="cb561-46"><a href="análisis-de-datos-funcionales.html#cb561-46" aria-hidden="true" tabindex="-1"></a>coef931 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coef,<span class="fu">matrix</span>(<span class="dv">0</span>,nbasis,<span class="dv">1</span>))</span>
<span id="cb561-47"><a href="análisis-de-datos-funcionales.html#cb561-47" aria-hidden="true" tabindex="-1"></a>fdh1<span class="sc">$</span>coefs <span class="ot">&lt;-</span> coef931</span>
<span id="cb561-48"><a href="análisis-de-datos-funcionales.html#cb561-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-49"><a href="análisis-de-datos-funcionales.html#cb561-49" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-50"><a href="análisis-de-datos-funcionales.html#cb561-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación de los parametros funcionales, a través </span></span>
<span id="cb561-51"><a href="análisis-de-datos-funcionales.html#cb561-51" aria-hidden="true" tabindex="-1"></a><span class="co"># de 20 funciones base y de orden 4</span></span>
<span id="cb561-52"><a href="análisis-de-datos-funcionales.html#cb561-52" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-53"><a href="análisis-de-datos-funcionales.html#cb561-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-54"><a href="análisis-de-datos-funcionales.html#cb561-54" aria-hidden="true" tabindex="-1"></a>xfdlist1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,q1)</span>
<span id="cb561-55"><a href="análisis-de-datos-funcionales.html#cb561-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q1) xfdlist1[[j]] <span class="ot">&lt;-</span> zmat1[,j]</span>
<span id="cb561-56"><a href="análisis-de-datos-funcionales.html#cb561-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-57"><a href="análisis-de-datos-funcionales.html#cb561-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-58"><a href="análisis-de-datos-funcionales.html#cb561-58" aria-hidden="true" tabindex="-1"></a>nbetabasis <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb561-59"><a href="análisis-de-datos-funcionales.html#cb561-59" aria-hidden="true" tabindex="-1"></a>betabasis <span class="ot">=</span> <span class="fu">create.bspline.basis</span>(rangeval, nbetabasis, norder)</span>
<span id="cb561-60"><a href="análisis-de-datos-funcionales.html#cb561-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-61"><a href="análisis-de-datos-funcionales.html#cb561-61" aria-hidden="true" tabindex="-1"></a>betafd    <span class="ot">&lt;-</span> <span class="fu">fd</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,nbetabasis,<span class="dv">1</span>), betabasis)</span>
<span id="cb561-62"><a href="análisis-de-datos-funcionales.html#cb561-62" aria-hidden="true" tabindex="-1"></a>estimate  <span class="ot">&lt;-</span> T</span>
<span id="cb561-63"><a href="análisis-de-datos-funcionales.html#cb561-63" aria-hidden="true" tabindex="-1"></a>lambda    <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb561-64"><a href="análisis-de-datos-funcionales.html#cb561-64" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(betafd)</span>
<span id="cb561-65"><a href="análisis-de-datos-funcionales.html#cb561-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-66"><a href="análisis-de-datos-funcionales.html#cb561-66" aria-hidden="true" tabindex="-1"></a>betalist1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,q1)</span>
<span id="cb561-67"><a href="análisis-de-datos-funcionales.html#cb561-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q1) betalist1[[j]] <span class="ot">&lt;-</span> betafdPar</span>
<span id="cb561-68"><a href="análisis-de-datos-funcionales.html#cb561-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-69"><a href="análisis-de-datos-funcionales.html#cb561-69" aria-hidden="true" tabindex="-1"></a>fRegressList1 <span class="ot">&lt;-</span> <span class="fu">fRegress</span>(fdh1, xfdlist1, betalist1)</span>
<span id="cb561-70"><a href="análisis-de-datos-funcionales.html#cb561-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-71"><a href="análisis-de-datos-funcionales.html#cb561-71" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb561-72"><a href="análisis-de-datos-funcionales.html#cb561-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de parámetros funcionales (betas) estimados</span></span>
<span id="cb561-73"><a href="análisis-de-datos-funcionales.html#cb561-73" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb561-74"><a href="análisis-de-datos-funcionales.html#cb561-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-75"><a href="análisis-de-datos-funcionales.html#cb561-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-76"><a href="análisis-de-datos-funcionales.html#cb561-76" aria-hidden="true" tabindex="-1"></a>betaestlist1 <span class="ot">&lt;-</span> fRegressList1<span class="sc">$</span>betaestlist</span>
<span id="cb561-77"><a href="análisis-de-datos-funcionales.html#cb561-77" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb561-78"><a href="análisis-de-datos-funcionales.html#cb561-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q1) </span>
<span id="cb561-79"><a href="análisis-de-datos-funcionales.html#cb561-79" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb561-80"><a href="análisis-de-datos-funcionales.html#cb561-80" aria-hidden="true" tabindex="-1"></a>  betaestParfdj <span class="ot">&lt;-</span> betaestlist1[[j]]</span>
<span id="cb561-81"><a href="análisis-de-datos-funcionales.html#cb561-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(betaestParfdj<span class="sc">$</span>fd, <span class="at">xlab=</span><span class="st">&quot;Tiempo (milisegundos)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje (Voltios)&quot;</span>,</span>
<span id="cb561-82"><a href="análisis-de-datos-funcionales.html#cb561-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span>estimulos[j])</span>
<span id="cb561-83"><a href="análisis-de-datos-funcionales.html#cb561-83" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars34-1.png" width="672" /></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="análisis-de-datos-funcionales.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb562-2"><a href="análisis-de-datos-funcionales.html#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de funciones predichas</span></span>
<span id="cb562-3"><a href="análisis-de-datos-funcionales.html#cb562-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb562-4"><a href="análisis-de-datos-funcionales.html#cb562-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-5"><a href="análisis-de-datos-funcionales.html#cb562-5" aria-hidden="true" tabindex="-1"></a>yfdpar1 <span class="ot">&lt;-</span> fRegressList1<span class="sc">$</span>yfdpar</span>
<span id="cb562-6"><a href="análisis-de-datos-funcionales.html#cb562-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb562-7"><a href="análisis-de-datos-funcionales.html#cb562-7" aria-hidden="true" tabindex="-1"></a>yhatfdobj1 <span class="ot">&lt;-</span> fRegressList1<span class="sc">$</span>yhatfdobj</span>
<span id="cb562-8"><a href="análisis-de-datos-funcionales.html#cb562-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhatfdobj1)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="análisis-de-datos-funcionales.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb564-2"><a href="análisis-de-datos-funcionales.html#cb564-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la matriz de residuales y obtención de</span></span>
<span id="cb564-3"><a href="análisis-de-datos-funcionales.html#cb564-3" aria-hidden="true" tabindex="-1"></a><span class="co"># la matriz de varianza y covarianza del modelo reducido 1: Solo estimulos</span></span>
<span id="cb564-4"><a href="análisis-de-datos-funcionales.html#cb564-4" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb564-5"><a href="análisis-de-datos-funcionales.html#cb564-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-6"><a href="análisis-de-datos-funcionales.html#cb564-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-7"><a href="análisis-de-datos-funcionales.html#cb564-7" aria-hidden="true" tabindex="-1"></a>yhatmat1  <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time,yhatfdobj1)      <span class="co"># Valores estimados</span></span>
<span id="cb564-8"><a href="análisis-de-datos-funcionales.html#cb564-8" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(yhatmat1[,<span class="dv">1</span><span class="sc">:</span>n], <span class="at">col=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb564-9"><a href="análisis-de-datos-funcionales.html#cb564-9" aria-hidden="true" tabindex="-1"></a>ymat1     <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time, fdh1)              <span class="co"># Valores observados </span></span>
<span id="cb564-10"><a href="análisis-de-datos-funcionales.html#cb564-10" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(time,ymat1[,<span class="dv">1</span><span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars34-2.png" width="672" /></p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="análisis-de-datos-funcionales.html#cb565-1" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> betaestlist1[[<span class="dv">1</span>]]                              </span>
<span id="cb565-2"><a href="análisis-de-datos-funcionales.html#cb565-2" aria-hidden="true" tabindex="-1"></a>alpha    <span class="ot">&lt;-</span>  <span class="fu">eval.fd</span>(time,alfa<span class="sc">$</span>fd)          <span class="co"># Constantes (Media) estimada</span></span>
<span id="cb565-3"><a href="análisis-de-datos-funcionales.html#cb565-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alfa<span class="sc">$</span>fd, <span class="at">xlab=</span><span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Voltaje&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="análisis-de-datos-funcionales.html#cb567-1" aria-hidden="true" tabindex="-1"></a>Residuales1 <span class="ot">&lt;-</span> ymat1[,<span class="dv">1</span><span class="sc">:</span>n] <span class="sc">-</span> yhatmat1[,<span class="dv">1</span><span class="sc">:</span>n]  <span class="co"># Los residuales son iguales a observados - estimados</span></span>
<span id="cb567-2"><a href="análisis-de-datos-funcionales.html#cb567-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(Residuales1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb567-3"><a href="análisis-de-datos-funcionales.html#cb567-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-4"><a href="análisis-de-datos-funcionales.html#cb567-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-5"><a href="análisis-de-datos-funcionales.html#cb567-5" aria-hidden="true" tabindex="-1"></a>SigmaRed1E   <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">t</span>(Residuales1))</span>
<span id="cb567-6"><a href="análisis-de-datos-funcionales.html#cb567-6" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(SigmaRed1E, <span class="at">xlab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars34-3.png" width="672" /></p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="análisis-de-datos-funcionales.html#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(SigmaRed1E)</span></code></pre></div>
<pre><code>## [1] 350 350</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="análisis-de-datos-funcionales.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb570-2"><a href="análisis-de-datos-funcionales.html#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de dsviación estandar de los residuales del modelo reducido</span></span>
<span id="cb570-3"><a href="análisis-de-datos-funcionales.html#cb570-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb570-4"><a href="análisis-de-datos-funcionales.html#cb570-4" aria-hidden="true" tabindex="-1"></a>cexval <span class="ot">=</span> <span class="fl">1.2</span></span>
<span id="cb570-5"><a href="análisis-de-datos-funcionales.html#cb570-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)<span class="sc">+</span>cexval<span class="sc">+</span><span class="dv">2</span>, <span class="at">pty=</span><span class="st">&quot;m&quot;</span>)</span>
<span id="cb570-6"><a href="análisis-de-datos-funcionales.html#cb570-6" aria-hidden="true" tabindex="-1"></a>stddevRed1E <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(SigmaRed1E))</span>
<span id="cb570-7"><a href="análisis-de-datos-funcionales.html#cb570-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, stddevRed1E, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>,</span>
<span id="cb570-8"><a href="análisis-de-datos-funcionales.html#cb570-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Desviacion estandar (Voltios)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars34-4.png" width="672" /></p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="análisis-de-datos-funcionales.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb571-2"><a href="análisis-de-datos-funcionales.html#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba F de Fareway para comparar modelo lleno menos modelo reducido</span></span>
<span id="cb571-3"><a href="análisis-de-datos-funcionales.html#cb571-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb571-4"><a href="análisis-de-datos-funcionales.html#cb571-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-5"><a href="análisis-de-datos-funcionales.html#cb571-5" aria-hidden="true" tabindex="-1"></a>Num <span class="ot">=</span>( <span class="fu">sum</span>(<span class="fu">diag</span>(SigmaRed1E<span class="sc">-</span>SigmaE))<span class="sc">/</span>(p<span class="sc">-</span>q1))</span>
<span id="cb571-6"><a href="análisis-de-datos-funcionales.html#cb571-6" aria-hidden="true" tabindex="-1"></a>Den <span class="ot">=</span> (<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE))<span class="sc">/</span>(n<span class="sc">-</span>p))</span>
<span id="cb571-7"><a href="análisis-de-datos-funcionales.html#cb571-7" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">=</span> Num<span class="sc">/</span>Den</span>
<span id="cb571-8"><a href="análisis-de-datos-funcionales.html#cb571-8" aria-hidden="true" tabindex="-1"></a>factor <span class="ot">=</span> (((<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE)))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span> (<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb571-9"><a href="análisis-de-datos-funcionales.html#cb571-9" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> factor<span class="sc">*</span>(p<span class="sc">-</span>q1)</span>
<span id="cb571-10"><a href="análisis-de-datos-funcionales.html#cb571-10" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> factor<span class="sc">*</span>(n<span class="sc">-</span>p)</span>
<span id="cb571-11"><a href="análisis-de-datos-funcionales.html#cb571-11" aria-hidden="true" tabindex="-1"></a>Fteo1<span class="ot">&lt;-</span><span class="fu">qf</span>(<span class="fl">0.95</span>,f1,f2)</span>
<span id="cb571-12"><a href="análisis-de-datos-funcionales.html#cb571-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-13"><a href="análisis-de-datos-funcionales.html#cb571-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-14"><a href="análisis-de-datos-funcionales.html#cb571-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-15"><a href="análisis-de-datos-funcionales.html#cb571-15" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb571-16"><a href="análisis-de-datos-funcionales.html#cb571-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación del modelo reducido 2: Solo los géneros</span></span>
<span id="cb571-17"><a href="análisis-de-datos-funcionales.html#cb571-17" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb571-18"><a href="análisis-de-datos-funcionales.html#cb571-18" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-19"><a href="análisis-de-datos-funcionales.html#cb571-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Nombre de los estímulos</span></span>
<span id="cb571-20"><a href="análisis-de-datos-funcionales.html#cb571-20" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-21"><a href="análisis-de-datos-funcionales.html#cb571-21" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb571-22"><a href="análisis-de-datos-funcionales.html#cb571-22" aria-hidden="true" tabindex="-1"></a>fdh2 <span class="ot">=</span> <span class="fu">Data2fd</span>(time, BASETOTALT, basis6)</span>
<span id="cb571-23"><a href="análisis-de-datos-funcionales.html#cb571-23" aria-hidden="true" tabindex="-1"></a>estimulos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Efecto global&quot;</span>, <span class="st">&quot;Hombres&quot;</span>, <span class="st">&quot;Mujeres&quot;</span>)</span>
<span id="cb571-24"><a href="análisis-de-datos-funcionales.html#cb571-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-25"><a href="análisis-de-datos-funcionales.html#cb571-25" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-26"><a href="análisis-de-datos-funcionales.html#cb571-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Indices para los estimulos </span></span>
<span id="cb571-27"><a href="análisis-de-datos-funcionales.html#cb571-27" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-28"><a href="análisis-de-datos-funcionales.html#cb571-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-29"><a href="análisis-de-datos-funcionales.html#cb571-29" aria-hidden="true" tabindex="-1"></a>Hombres1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">58</span>,<span class="dv">1</span>)</span>
<span id="cb571-30"><a href="análisis-de-datos-funcionales.html#cb571-30" aria-hidden="true" tabindex="-1"></a>Mujeres1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">59</span>,<span class="dv">92</span>,<span class="dv">1</span>)</span>
<span id="cb571-31"><a href="análisis-de-datos-funcionales.html#cb571-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-32"><a href="análisis-de-datos-funcionales.html#cb571-32" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-33"><a href="análisis-de-datos-funcionales.html#cb571-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz diseño</span></span>
<span id="cb571-34"><a href="análisis-de-datos-funcionales.html#cb571-34" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-35"><a href="análisis-de-datos-funcionales.html#cb571-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-36"><a href="análisis-de-datos-funcionales.html#cb571-36" aria-hidden="true" tabindex="-1"></a>zmat2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">92</span>,<span class="dv">3</span>)</span>
<span id="cb571-37"><a href="análisis-de-datos-funcionales.html#cb571-37" aria-hidden="true" tabindex="-1"></a>zmat2[        ,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb571-38"><a href="análisis-de-datos-funcionales.html#cb571-38" aria-hidden="true" tabindex="-1"></a>zmat2[Hombres1,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb571-39"><a href="análisis-de-datos-funcionales.html#cb571-39" aria-hidden="true" tabindex="-1"></a>zmat2[Mujeres1,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb571-40"><a href="análisis-de-datos-funcionales.html#cb571-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-41"><a href="análisis-de-datos-funcionales.html#cb571-41" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-42"><a href="análisis-de-datos-funcionales.html#cb571-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Generación de la fila, para garantizar la ortogonalidad</span></span>
<span id="cb571-43"><a href="análisis-de-datos-funcionales.html#cb571-43" aria-hidden="true" tabindex="-1"></a><span class="co">#y estimabilidad de los parámetros.</span></span>
<span id="cb571-44"><a href="análisis-de-datos-funcionales.html#cb571-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1,1)</span></span>
<span id="cb571-45"><a href="análisis-de-datos-funcionales.html#cb571-45" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-46"><a href="análisis-de-datos-funcionales.html#cb571-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-47"><a href="análisis-de-datos-funcionales.html#cb571-47" aria-hidden="true" tabindex="-1"></a>z932   <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb571-48"><a href="análisis-de-datos-funcionales.html#cb571-48" aria-hidden="true" tabindex="-1"></a>z932[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb571-49"><a href="análisis-de-datos-funcionales.html#cb571-49" aria-hidden="true" tabindex="-1"></a>zmat2   <span class="ot">&lt;-</span> <span class="fu">rbind</span>(zmat2, z932)</span>
<span id="cb571-50"><a href="análisis-de-datos-funcionales.html#cb571-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-51"><a href="análisis-de-datos-funcionales.html#cb571-51" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-52"><a href="análisis-de-datos-funcionales.html#cb571-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimación de la fila generada a través de las </span></span>
<span id="cb571-53"><a href="análisis-de-datos-funcionales.html#cb571-53" aria-hidden="true" tabindex="-1"></a><span class="co">#funciones base.</span></span>
<span id="cb571-54"><a href="análisis-de-datos-funcionales.html#cb571-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Fila (0,1,1,1).</span></span>
<span id="cb571-55"><a href="análisis-de-datos-funcionales.html#cb571-55" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-56"><a href="análisis-de-datos-funcionales.html#cb571-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-57"><a href="análisis-de-datos-funcionales.html#cb571-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-58"><a href="análisis-de-datos-funcionales.html#cb571-58" aria-hidden="true" tabindex="-1"></a>coef   <span class="ot">&lt;-</span> fdh2<span class="sc">$</span>coefs</span>
<span id="cb571-59"><a href="análisis-de-datos-funcionales.html#cb571-59" aria-hidden="true" tabindex="-1"></a>coef932 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coef,<span class="fu">matrix</span>(<span class="dv">0</span>,nbasis,<span class="dv">1</span>))</span>
<span id="cb571-60"><a href="análisis-de-datos-funcionales.html#cb571-60" aria-hidden="true" tabindex="-1"></a>fdh2<span class="sc">$</span>coefs <span class="ot">&lt;-</span> coef932</span>
<span id="cb571-61"><a href="análisis-de-datos-funcionales.html#cb571-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-62"><a href="análisis-de-datos-funcionales.html#cb571-62" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-63"><a href="análisis-de-datos-funcionales.html#cb571-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación de los parametros funcionales, a través </span></span>
<span id="cb571-64"><a href="análisis-de-datos-funcionales.html#cb571-64" aria-hidden="true" tabindex="-1"></a><span class="co"># de 20 funciones base y de orden 4</span></span>
<span id="cb571-65"><a href="análisis-de-datos-funcionales.html#cb571-65" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-66"><a href="análisis-de-datos-funcionales.html#cb571-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-67"><a href="análisis-de-datos-funcionales.html#cb571-67" aria-hidden="true" tabindex="-1"></a>xfdlist2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,q2)</span>
<span id="cb571-68"><a href="análisis-de-datos-funcionales.html#cb571-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q2) xfdlist2[[j]] <span class="ot">&lt;-</span> zmat2[,j]</span>
<span id="cb571-69"><a href="análisis-de-datos-funcionales.html#cb571-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-70"><a href="análisis-de-datos-funcionales.html#cb571-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-71"><a href="análisis-de-datos-funcionales.html#cb571-71" aria-hidden="true" tabindex="-1"></a>nbetabasis <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb571-72"><a href="análisis-de-datos-funcionales.html#cb571-72" aria-hidden="true" tabindex="-1"></a>betabasis <span class="ot">=</span> <span class="fu">create.bspline.basis</span>(rangeval, nbetabasis, norder)</span>
<span id="cb571-73"><a href="análisis-de-datos-funcionales.html#cb571-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-74"><a href="análisis-de-datos-funcionales.html#cb571-74" aria-hidden="true" tabindex="-1"></a>betafd    <span class="ot">&lt;-</span> <span class="fu">fd</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,nbetabasis,<span class="dv">1</span>), betabasis)</span>
<span id="cb571-75"><a href="análisis-de-datos-funcionales.html#cb571-75" aria-hidden="true" tabindex="-1"></a>estimate  <span class="ot">&lt;-</span> T</span>
<span id="cb571-76"><a href="análisis-de-datos-funcionales.html#cb571-76" aria-hidden="true" tabindex="-1"></a>lambda    <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb571-77"><a href="análisis-de-datos-funcionales.html#cb571-77" aria-hidden="true" tabindex="-1"></a>betafdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(betafd)</span>
<span id="cb571-78"><a href="análisis-de-datos-funcionales.html#cb571-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-79"><a href="análisis-de-datos-funcionales.html#cb571-79" aria-hidden="true" tabindex="-1"></a>betalist2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,q2)</span>
<span id="cb571-80"><a href="análisis-de-datos-funcionales.html#cb571-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q2) betalist2[[j]] <span class="ot">&lt;-</span> betafdPar</span>
<span id="cb571-81"><a href="análisis-de-datos-funcionales.html#cb571-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-82"><a href="análisis-de-datos-funcionales.html#cb571-82" aria-hidden="true" tabindex="-1"></a>fRegressList2 <span class="ot">&lt;-</span> <span class="fu">fRegress</span>(fdh2, xfdlist2, betalist2)</span>
<span id="cb571-83"><a href="análisis-de-datos-funcionales.html#cb571-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-84"><a href="análisis-de-datos-funcionales.html#cb571-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-85"><a href="análisis-de-datos-funcionales.html#cb571-85" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-86"><a href="análisis-de-datos-funcionales.html#cb571-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de parámetros funcionales (betas) estimados</span></span>
<span id="cb571-87"><a href="análisis-de-datos-funcionales.html#cb571-87" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-88"><a href="análisis-de-datos-funcionales.html#cb571-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-89"><a href="análisis-de-datos-funcionales.html#cb571-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-90"><a href="análisis-de-datos-funcionales.html#cb571-90" aria-hidden="true" tabindex="-1"></a>betaestlist2 <span class="ot">&lt;-</span> fRegressList2<span class="sc">$</span>betaestlist</span>
<span id="cb571-91"><a href="análisis-de-datos-funcionales.html#cb571-91" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb571-92"><a href="análisis-de-datos-funcionales.html#cb571-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>q2) </span>
<span id="cb571-93"><a href="análisis-de-datos-funcionales.html#cb571-93" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb571-94"><a href="análisis-de-datos-funcionales.html#cb571-94" aria-hidden="true" tabindex="-1"></a>  betaestParfdj <span class="ot">&lt;-</span> betaestlist2[[j]]</span>
<span id="cb571-95"><a href="análisis-de-datos-funcionales.html#cb571-95" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot(betaestParfdj$fd, xlab=&quot;Tiempo (milisegundos)&quot;, ylab=&quot;Voltaje (Voltios)&quot;, main=estimulos[j])</span></span>
<span id="cb571-96"><a href="análisis-de-datos-funcionales.html#cb571-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb571-97"><a href="análisis-de-datos-funcionales.html#cb571-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-98"><a href="análisis-de-datos-funcionales.html#cb571-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-99"><a href="análisis-de-datos-funcionales.html#cb571-99" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-100"><a href="análisis-de-datos-funcionales.html#cb571-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de funciones predichas</span></span>
<span id="cb571-101"><a href="análisis-de-datos-funcionales.html#cb571-101" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-102"><a href="análisis-de-datos-funcionales.html#cb571-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-103"><a href="análisis-de-datos-funcionales.html#cb571-103" aria-hidden="true" tabindex="-1"></a>yfdpar2 <span class="ot">&lt;-</span> fRegressList2<span class="sc">$</span>yfdpar</span>
<span id="cb571-104"><a href="análisis-de-datos-funcionales.html#cb571-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-105"><a href="análisis-de-datos-funcionales.html#cb571-105" aria-hidden="true" tabindex="-1"></a>yhatfdobj2 <span class="ot">&lt;-</span> fRegressList2<span class="sc">$</span>yhatfdobj</span>
<span id="cb571-106"><a href="análisis-de-datos-funcionales.html#cb571-106" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(yhatfdobj2)</span></span>
<span id="cb571-107"><a href="análisis-de-datos-funcionales.html#cb571-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-108"><a href="análisis-de-datos-funcionales.html#cb571-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-109"><a href="análisis-de-datos-funcionales.html#cb571-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-110"><a href="análisis-de-datos-funcionales.html#cb571-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-111"><a href="análisis-de-datos-funcionales.html#cb571-111" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb571-112"><a href="análisis-de-datos-funcionales.html#cb571-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la matriz de residuales y obtención de</span></span>
<span id="cb571-113"><a href="análisis-de-datos-funcionales.html#cb571-113" aria-hidden="true" tabindex="-1"></a><span class="co"># la matriz de varianza y covarianza del modelo reducido 1: Solo estimulos</span></span>
<span id="cb571-114"><a href="análisis-de-datos-funcionales.html#cb571-114" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb571-115"><a href="análisis-de-datos-funcionales.html#cb571-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-116"><a href="análisis-de-datos-funcionales.html#cb571-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-117"><a href="análisis-de-datos-funcionales.html#cb571-117" aria-hidden="true" tabindex="-1"></a>yhatmat2  <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time,yhatfdobj2)      <span class="co"># Valores estimados</span></span>
<span id="cb571-118"><a href="análisis-de-datos-funcionales.html#cb571-118" aria-hidden="true" tabindex="-1"></a><span class="co">#matplot(yhatmat2[,1:n], col=2, type=&quot;l&quot;)</span></span>
<span id="cb571-119"><a href="análisis-de-datos-funcionales.html#cb571-119" aria-hidden="true" tabindex="-1"></a>ymat2     <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(time, fdh)              <span class="co"># Valores observados </span></span>
<span id="cb571-120"><a href="análisis-de-datos-funcionales.html#cb571-120" aria-hidden="true" tabindex="-1"></a><span class="co">#matplot(time,ymat2[,1:n], type=&quot;l&quot;)</span></span>
<span id="cb571-121"><a href="análisis-de-datos-funcionales.html#cb571-121" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> betaestlist2[[<span class="dv">1</span>]]                              </span>
<span id="cb571-122"><a href="análisis-de-datos-funcionales.html#cb571-122" aria-hidden="true" tabindex="-1"></a>alpha    <span class="ot">&lt;-</span>  <span class="fu">eval.fd</span>(time,alfa<span class="sc">$</span>fd)          <span class="co"># Constantes (Media) estimada</span></span>
<span id="cb571-123"><a href="análisis-de-datos-funcionales.html#cb571-123" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(alfa$fd, xlab=&quot;Tiempo&quot;, ylab=&quot;Voltaje&quot;)</span></span>
<span id="cb571-124"><a href="análisis-de-datos-funcionales.html#cb571-124" aria-hidden="true" tabindex="-1"></a>Residuales2 <span class="ot">&lt;-</span> ymat2[,<span class="dv">1</span><span class="sc">:</span>n] <span class="sc">-</span> yhatmat2[,<span class="dv">1</span><span class="sc">:</span>n]  <span class="co"># Los residuales son iguales a observados - estimados</span></span>
<span id="cb571-125"><a href="análisis-de-datos-funcionales.html#cb571-125" aria-hidden="true" tabindex="-1"></a><span class="co">#matplot(Residuales2, type = &quot;l&quot;)</span></span>
<span id="cb571-126"><a href="análisis-de-datos-funcionales.html#cb571-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-127"><a href="análisis-de-datos-funcionales.html#cb571-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb571-128"><a href="análisis-de-datos-funcionales.html#cb571-128" aria-hidden="true" tabindex="-1"></a>SigmaRed2E   <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">t</span>(Residuales2))</span>
<span id="cb571-129"><a href="análisis-de-datos-funcionales.html#cb571-129" aria-hidden="true" tabindex="-1"></a><span class="co">#contour(SigmaRed2E, xlab=&quot;Milisegundos&quot;, ylab=&quot;Milisegundos&quot;, cex=1.2)</span></span>
<span id="cb571-130"><a href="análisis-de-datos-funcionales.html#cb571-130" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(SigmaRed2E)</span></code></pre></div>
<pre><code>## [1] 350 350</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="análisis-de-datos-funcionales.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb573-2"><a href="análisis-de-datos-funcionales.html#cb573-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de dsviación estandar de los residuales del modelo reducido</span></span>
<span id="cb573-3"><a href="análisis-de-datos-funcionales.html#cb573-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb573-4"><a href="análisis-de-datos-funcionales.html#cb573-4" aria-hidden="true" tabindex="-1"></a>cexval <span class="ot">=</span> <span class="fl">1.2</span></span>
<span id="cb573-5"><a href="análisis-de-datos-funcionales.html#cb573-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)<span class="sc">+</span>cexval<span class="sc">+</span><span class="dv">2</span>, <span class="at">pty=</span><span class="st">&quot;m&quot;</span>)</span>
<span id="cb573-6"><a href="análisis-de-datos-funcionales.html#cb573-6" aria-hidden="true" tabindex="-1"></a>stddevRed2E <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(SigmaRed2E))</span>
<span id="cb573-7"><a href="análisis-de-datos-funcionales.html#cb573-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, stddevRed2E, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">cex=</span><span class="fl">1.2</span>,</span>
<span id="cb573-8"><a href="análisis-de-datos-funcionales.html#cb573-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Milisegundos&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Desviacion estandar (Voltios)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars34-5.png" width="672" /></p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="análisis-de-datos-funcionales.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb574-2"><a href="análisis-de-datos-funcionales.html#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba F de Fareway para comparar modelo lleno menos modelo reducido</span></span>
<span id="cb574-3"><a href="análisis-de-datos-funcionales.html#cb574-3" aria-hidden="true" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb574-4"><a href="análisis-de-datos-funcionales.html#cb574-4" aria-hidden="true" tabindex="-1"></a>Num <span class="ot">=</span>( <span class="fu">sum</span>(<span class="fu">diag</span>(SigmaRed2E<span class="sc">-</span>SigmaE))<span class="sc">/</span>(p<span class="sc">-</span>q2))</span>
<span id="cb574-5"><a href="análisis-de-datos-funcionales.html#cb574-5" aria-hidden="true" tabindex="-1"></a>Den <span class="ot">=</span> (<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE))<span class="sc">/</span>(n<span class="sc">-</span>p))</span>
<span id="cb574-6"><a href="análisis-de-datos-funcionales.html#cb574-6" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">=</span> Num<span class="sc">/</span>Den</span>
<span id="cb574-7"><a href="análisis-de-datos-funcionales.html#cb574-7" aria-hidden="true" tabindex="-1"></a>factor <span class="ot">=</span> (((<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE)))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span> (<span class="fu">sum</span>(<span class="fu">diag</span>(SigmaE<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb574-8"><a href="análisis-de-datos-funcionales.html#cb574-8" aria-hidden="true" tabindex="-1"></a>f12 <span class="ot">=</span> factor<span class="sc">*</span>(p<span class="sc">-</span>q2)</span>
<span id="cb574-9"><a href="análisis-de-datos-funcionales.html#cb574-9" aria-hidden="true" tabindex="-1"></a>f22 <span class="ot">=</span> factor<span class="sc">*</span>(n<span class="sc">-</span>p)</span>
<span id="cb574-10"><a href="análisis-de-datos-funcionales.html#cb574-10" aria-hidden="true" tabindex="-1"></a>Fteo2<span class="ot">&lt;-</span><span class="fu">qf</span>(<span class="fl">0.95</span>,f12,f22)</span></code></pre></div>
</div>
</div>
</div>
<div id="estadística-espacial" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Estadística Espacial<a href="análisis-de-datos-funcionales.html#estadística-espacial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El enfoque bajo el cual se desarrolla la metodología de predicción y estimación de la estructura de dependencia espacial, se centra en una rama de la estadística que en los últimos tiempos ha cobrado importancia en muchas áreas del conocimiento: .</p>
<p>La Estadística espacial, es la reunión de un conjunto de metodologías apropiadas para el análisis de datos que corresponden a la medición de variables aleatorias en diversos sitios (puntos del espacio o agregaciones espaciales) de una región. En general se consideran tres subaréas dentro de su estudio que se diferencian por las características del espacio en el cual tienen aplicación: Geoestadística, datos en Laticce y patrones puntuales. Para el caso de aplicación de esta guía, la rama específica se centra en Geoestadística, dado que las curvas son medidas en diferentes ubicaciones en un dominio continuo.</p>
<div id="metodología-de-predicción-espacial-con-datos-funcionales" class="section level3 hasAnchor" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Metodología de predicción espacial con datos funcionales<a href="análisis-de-datos-funcionales.html#metodología-de-predicción-espacial-con-datos-funcionales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se considera un proceso aleatorio funcional: <span class="math display">\[\chi_s : s \in D \subset R^d \]</span></p>
<p>Tal que <span class="math inline">\(\chi_s\)</span> es una variable aleatoria funcional. Sean <span class="math inline">\(s_1, s_2,..., s_n\)</span> puntos aleatorios en D, en cada uno de los cuales se observa una realización del proceso aleatorio (<span class="math inline">\(\chi_s\)</span>: <span class="math inline">\(\chi_{s_1},\chi_{s_2},..., \chi_{s_n}\)</span>).</p>
<p>Además, se asume que este proceso es estacionario de segundo orden e isótropico, es decir que la función de media y de varianza son constantes y la covarianza solo depende de la distancia entre dos puntos muestreados. Formalmente se asume:</p>
<p>La función <span class="math inline">\(\gamma(h;t)\)</span> es una función de <span class="math inline">\(h\)</span> que comúnmente se conoce con el nombre de semivariograma asociado a <span class="math inline">\(\chi(t)\)</span>. El objetivo al igual que en el caso de geoestadística univariada o multivariada es predecir el valor de la variable en un lugar no muestreado <span class="math inline">\(s_0\)</span>.</p>
<p>En este caso la variable es una curva completa y no un escalar o un vector como lo relacionado con geoestadística univariada o multivariada; así, para establecer la respectiva predicción, se considera la familia de predictores lineales de la forma:<span class="math display">\[\widehat{\chi}_{s_0} = \sum_{i=1} ^n \lambda_i \chi_{s_i} \text{ $\lambda_1,...,\lambda_n \in R$}\]</span></p>
<p>Este predictor tiene la misma expresión que para el caso de ordinario, sin embargo se debe notar que los objetos estudiados corresponden a curvas y no a variables escalares, es decir, la curva predicha es una combinación lineal de curvas observadas. Este predictor fue considerado inicialmente por Goulard <span class="math inline">\(\&amp;\)</span> Voltz (1993), sin embargo el enfoque bajo el cual se trabaja en esta tesis se basa en el presentado por Giraldo (2008). Bajo este enfoque, los pesos <span class="math inline">\(\lambda_i\)</span> óptimos para la predicción se obtienen al solucionar la ecuación:</p>
<p><span class="math display">\[\begin{eqnarray}
\begin{pmatrix}
\int_t \gamma_{s_1,s_1}(t)dt &amp; \dots  &amp; \int_t \gamma_{s_1,s_n}(t)dt &amp;1\\
... &amp;... &amp; ... &amp; ...\\
\int_t \gamma_{s_n,s_1}(t)dt &amp; \dots &amp; \int_t \gamma_{s_n,s_n}(t)dt &amp; 1\\
1&amp;\dots&amp;1&amp;0\\
\end{pmatrix}
\begin{pmatrix}
\lambda_1\\
...\\
\lambda_n\\
-\mu\\
\end{pmatrix} =
\begin{pmatrix}
\int_t \gamma_{s_0,s_1}(t)dt\\
...\\
\int_t \gamma_{s_0,s_n}(t)dt\\
1\\
\end{pmatrix}
\end{eqnarray}\]</span></p>
<p>La función <span class="math inline">\(\gamma(h) = \int_t \gamma_{s_is_j}(t) dt = \frac{1}{2}\int_t V(\chi_{s_i}(t) - \chi_{s_j}(t)) dt\)</span>, <span class="math inline">\(h = \|s_i-s_j\|\)</span>, se denomina traza-variograma, y corresponde a la extensión del semivariograma al caso en el que las mediciones son curvas (Giraldo, 2008). Con el fin de establecer la solución para la ecuación, es necesario encontrar un estimador del traza-variograma (<span class="math inline">\(\int_t \gamma_{si,sj}(t)dt\)</span>) y dado que el proceso se asume estacionario:</p>
<p><span class="math display">\[ V(\chi_{si}(t) - \chi_{sj}(t)) = E((\chi_{si}(t) - \chi_{sj}(t))^2)\]</span>
es posible utilizar el teorema de Fubini:<span class="math display">\[\gamma(h) =  \frac{1}{2}\int_t E((\chi_{si}(t) - \chi_{sj}(t))^2) dt = \frac{1}{2} E\left[\int_t (\chi_{si}(t) - \chi_{sj}(t))^2 dt\right]\]</span>
Finalmente con esta representación y realizando una adaptación del estimador de momentos clásico (MoM) del semivariograma se obtiene el estimador del traza-variograma:<span class="math display">\[\hat{\gamma}(h) = \frac{\sum_{i,j \in N(h)} \int_T [ \chi_{s_i}(t) -\chi_{s_j}(t)]^2 dt}{2|N(h)|}\]</span></p>
<p>dónde <span class="math inline">\(N(h) = \{(s_i, s_j) : \|s_i-s_j\| = h\}\)</span>, y <span class="math inline">\(|N(h)|\)</span> es el número de elementos distintos en <span class="math inline">\(N(h)\)</span>.</p>
<p>Una vez estimado el traza variograma para cada variable de interés y para una secuencia de K valores <span class="math inline">\(h_k\)</span>, se propone ajustar un modelo paramétrico (de los conocidos como por ejemplo el exponencial), a los puntos <span class="math inline">\((h_k, \widehat{\gamma}(h_k))\)</span>, y finalmente si <span class="math inline">\(\gamma_{\widehat{\alpha}}(h_k)\)</span> denota la estimación del traza variograma, esta forma funcional es utilizada para estimar la estructura de correlación espacial a través de la equivalencia entre el variograma y la covarianza de procesos estacionarios:<span class="math display">\[ C(h) = \sigma^2 - \gamma(h)\]</span>
<span class="math display">\[\int_T C_{l,q}(s_i,s_j)(t) = \int_T \sigma_{l,q}^2(t) - \int_T \gamma_{l,q}(s_i,s_j)(t)\]</span></p>
</div>
<div id="ilustración" class="section level3 hasAnchor" number="13.5.2">
<h3><span class="header-section-number">13.5.2</span> Ilustración<a href="análisis-de-datos-funcionales.html#ilustración" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se aplica la metodología para las mediciones de temperatura registradas en 35 estaciones meteorológicas ubicadas en las Provincias Marítimas Canadienses de tres provincias: Nueva Escocia (NS), Nuevo Brunswick (NB) y la Isla del Príncipe Eduardo (PEI).</p>
<p>La función principal de geofd es okfd. Esta función permite realizar predicciones por kriging ordinario para datos suavizados con diferentes bases (B-spline y Fourier). Dentro de esta función se realizan los procesos de suavizamiento y la estimación del traza-variograma.</p>
<div id="lectura-y-gráfica-de-las-curvas-y-las-coordenadas" class="section level4 hasAnchor" number="13.5.2.1">
<h4><span class="header-section-number">13.5.2.1</span> Lectura y gráfica de las curvas y las coordenadas<a href="análisis-de-datos-funcionales.html#lectura-y-gráfica-de-las-curvas-y-las-coordenadas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="análisis-de-datos-funcionales.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb575-2"><a href="análisis-de-datos-funcionales.html#cb575-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geofd)</span>
<span id="cb575-3"><a href="análisis-de-datos-funcionales.html#cb575-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(maritimes.data)</span>
<span id="cb575-4"><a href="análisis-de-datos-funcionales.html#cb575-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(maritimes.coords)</span>
<span id="cb575-5"><a href="análisis-de-datos-funcionales.html#cb575-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(maritimes.data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]  [,4]
## [1,] -7.9 -4.4 -3.8 -8.60
## [2,] -7.5 -4.2 -3.5 -8.32
## [3,] -9.3 -5.3 -4.6 -9.87
## [4,] -8.7 -5.4 -5.0 -9.55
## [5,] -9.1 -5.6 -4.1 -9.58</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="análisis-de-datos-funcionales.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(maritimes.data,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Temperatuta (°C)&quot;</span>)</span>
<span id="cb577-2"><a href="análisis-de-datos-funcionales.html#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars35-1.png" width="672" /></p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="análisis-de-datos-funcionales.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maritimes.coords)</span>
<span id="cb578-2"><a href="análisis-de-datos-funcionales.html#cb578-2" aria-hidden="true" tabindex="-1"></a>coord.cero <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">64.06</span>, <span class="fl">45.79</span>),<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb578-3"><a href="análisis-de-datos-funcionales.html#cb578-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(coord.cero, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars35-2.png" width="672" /></p>
</div>
<div id="suavizamiento-a-través-de-b-splines" class="section level4 hasAnchor" number="13.5.2.2">
<h4><span class="header-section-number">13.5.2.2</span> Suavizamiento a través de B-splines<a href="análisis-de-datos-funcionales.html#suavizamiento-a-través-de-b-splines" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="análisis-de-datos-funcionales.html#cb579-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">dim</span>(maritimes.data)[<span class="dv">1</span>]</span>
<span id="cb579-2"><a href="análisis-de-datos-funcionales.html#cb579-2" aria-hidden="true" tabindex="-1"></a>argvals<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb579-3"><a href="análisis-de-datos-funcionales.html#cb579-3" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="dv">35</span></span>
<span id="cb579-4"><a href="análisis-de-datos-funcionales.html#cb579-4" aria-hidden="true" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(argvals)</span>
<span id="cb579-5"><a href="análisis-de-datos-funcionales.html#cb579-5" aria-hidden="true" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb579-6"><a href="análisis-de-datos-funcionales.html#cb579-6" aria-hidden="true" tabindex="-1"></a>nbasis <span class="ot">&lt;-</span> <span class="dv">65</span></span>
<span id="cb579-7"><a href="análisis-de-datos-funcionales.html#cb579-7" aria-hidden="true" tabindex="-1"></a>bspl.basis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(rangeval, nbasis, norder)</span>
<span id="cb579-8"><a href="análisis-de-datos-funcionales.html#cb579-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb579-9"><a href="análisis-de-datos-funcionales.html#cb579-9" aria-hidden="true" tabindex="-1"></a>datafdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bspl.basis, <span class="at">Lfdobj=</span><span class="dv">2</span>, lambda)</span>
<span id="cb579-10"><a href="análisis-de-datos-funcionales.html#cb579-10" aria-hidden="true" tabindex="-1"></a>smfd <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(argvals,maritimes.data,datafdPar)</span>
<span id="cb579-11"><a href="análisis-de-datos-funcionales.html#cb579-11" aria-hidden="true" tabindex="-1"></a>datafd <span class="ot">&lt;-</span> smfd<span class="sc">$</span>fd</span>
<span id="cb579-12"><a href="análisis-de-datos-funcionales.html#cb579-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datafd, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Temperatura (°C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars36-1.png" width="672" /></p>
<pre><code>## [1] &quot;done&quot;</code></pre>
</div>
<div id="estimación-de-la-traza-variograma-y-ajuste-de-modelos" class="section level4 hasAnchor" number="13.5.2.3">
<h4><span class="header-section-number">13.5.2.3</span> Estimación de la traza-variograma y ajuste de modelos<a href="análisis-de-datos-funcionales.html#estimación-de-la-traza-variograma-y-ajuste-de-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="análisis-de-datos-funcionales.html#cb581-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">bsplinepen</span>(bspl.basis,<span class="at">Lfdobj=</span><span class="dv">0</span>)</span>
<span id="cb581-2"><a href="análisis-de-datos-funcionales.html#cb581-2" aria-hidden="true" tabindex="-1"></a>L2norm <span class="ot">&lt;-</span> <span class="fu">l2.norm</span>(s, datafd, M)</span>
<span id="cb581-3"><a href="análisis-de-datos-funcionales.html#cb581-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-4"><a href="análisis-de-datos-funcionales.html#cb581-4" aria-hidden="true" tabindex="-1"></a>dista<span class="ot">=</span><span class="fu">max</span>(<span class="fu">dist</span>(maritimes.coords))<span class="sc">*</span><span class="fl">0.9</span></span>
<span id="cb581-5"><a href="análisis-de-datos-funcionales.html#cb581-5" aria-hidden="true" tabindex="-1"></a>tracev<span class="ot">=</span><span class="fu">trace.variog</span>(maritimes.coords, L2norm, <span class="at">bin=</span><span class="cn">FALSE</span>,<span class="at">max.dist=</span>dista,<span class="at">uvec=</span><span class="st">&quot;default&quot;</span>,<span class="at">breaks=</span><span class="st">&quot;default&quot;</span>,nugget.tolerance)</span>
<span id="cb581-6"><a href="análisis-de-datos-funcionales.html#cb581-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(tracev<span class="sc">$</span>u, tracev<span class="sc">$</span>v)</span>
<span id="cb581-7"><a href="análisis-de-datos-funcionales.html#cb581-7" aria-hidden="true" tabindex="-1"></a>models<span class="ot">=</span><span class="fu">fit.tracevariog</span>(tracev, <span class="at">models=</span><span class="fu">c</span>(<span class="st">&quot;spherical&quot;</span>,<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;gaussian&quot;</span>,<span class="st">&quot;matern&quot;</span>),<span class="at">sigma2.0=</span><span class="dv">2000</span>, <span class="at">phi.0=</span><span class="dv">4</span>, <span class="at">fix.nugget=</span><span class="cn">FALSE</span>, <span class="at">nugget=</span><span class="dv">0</span>, <span class="at">fix.kappa=</span><span class="cn">TRUE</span>, <span class="at">kappa=</span><span class="dv">1</span>, <span class="at">max.dist.variogram=</span>dista)</span>
<span id="cb581-8"><a href="análisis-de-datos-funcionales.html#cb581-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb581-9"><a href="análisis-de-datos-funcionales.html#cb581-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tracev<span class="sc">$</span>u, tracev<span class="sc">$</span>v, <span class="at">xlab=</span><span class="st">&quot;Distancia&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Traza-Variograma tipo Cloud&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars37-1.png" width="672" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="análisis-de-datos-funcionales.html#cb582-1" aria-hidden="true" tabindex="-1"></a>tracevbin<span class="ot">=</span><span class="fu">trace.variog</span>(maritimes.coords, L2norm, <span class="at">bin=</span><span class="cn">TRUE</span>, <span class="at">max.dist=</span>dista)</span>
<span id="cb582-2"><a href="análisis-de-datos-funcionales.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tracevbin<span class="sc">$</span>u, tracevbin<span class="sc">$</span>v, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3000</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">xlab=</span><span class="st">&quot;Distance&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Traza-Variograma tipo Bin&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars37-2.png" width="672" /></p>
</div>
<div id="modelos" class="section level4 hasAnchor" number="13.5.2.4">
<h4><span class="header-section-number">13.5.2.4</span> Modelos<a href="análisis-de-datos-funcionales.html#modelos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="análisis-de-datos-funcionales.html#cb583-1" aria-hidden="true" tabindex="-1"></a>models</span></code></pre></div>
<pre><code>## $best
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: matern with fixed kappa = 1
## parameter estimates:
##     tausq   sigmasq       phi 
##   64.9030 2346.8539    1.8376 
## Practical Range with cor=0.05 for asymptotic range: 7.347868
## 
## variofit: minimised sum of squares = 514347277
## 
## $fitted
## $fitted[[1]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: spherical
## parameter estimates:
##     tausq   sigmasq       phi 
##    0.0000 2112.1217    5.6607 
## Practical Range with cor=0.05 for asymptotic range: 5.660719
## 
## variofit: minimised sum of squares = 517375905
## 
## $fitted[[2]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: exponential
## parameter estimates:
##     tausq   sigmasq       phi 
##    0.0000 3333.3219    5.1272 
## Practical Range with cor=0.05 for asymptotic range: 15.35984
## 
## variofit: minimised sum of squares = 516012113
## 
## $fitted[[3]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: gaussian
## parameter estimates:
##     tausq   sigmasq       phi 
##  222.1683 1810.9009    2.5149 
## Practical Range with cor=0.05 for asymptotic range: 4.352856
## 
## variofit: minimised sum of squares = 515245956
## 
## $fitted[[4]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: matern with fixed kappa = 1
## parameter estimates:
##     tausq   sigmasq       phi 
##   64.9030 2346.8539    1.8376 
## Practical Range with cor=0.05 for asymptotic range: 7.347868
## 
## variofit: minimised sum of squares = 514347277</code></pre>
</div>
<div id="predicciones-espaciales-en-una-ubicación-no-muestreada" class="section level4 hasAnchor" number="13.5.2.5">
<h4><span class="header-section-number">13.5.2.5</span> Predicciones espaciales en una ubicación no muestreada<a href="análisis-de-datos-funcionales.html#predicciones-espaciales-en-una-ubicación-no-muestreada" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="análisis-de-datos-funcionales.html#cb585-1" aria-hidden="true" tabindex="-1"></a>okfd.res<span class="ot">&lt;-</span><span class="fu">okfd</span>(<span class="at">new.coords=</span>coord.cero, <span class="at">coords=</span>maritimes.coords,<span class="at">cov.model=</span><span class="st">&quot;exponential&quot;</span>, <span class="at">data=</span>maritimes.data, <span class="at">nbasis=</span><span class="dv">65</span>, <span class="at">argvals=</span>argvals, <span class="at">fix.nugget=</span><span class="cn">TRUE</span>)</span>
<span id="cb585-2"><a href="análisis-de-datos-funcionales.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(okfd.res<span class="sc">$</span>datafd, <span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">8</span>, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Temperatura (grados °C)&quot;</span>,<span class="at">main=</span><span class="st">&quot;Predicción en Moncton&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;done&quot;</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="análisis-de-datos-funcionales.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(okfd.res<span class="sc">$</span>argvals, okfd.res<span class="sc">$</span>krig.new.data, <span class="at">col=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">&quot;Predicciones&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Temperatura (grados °C)&quot;</span>)</span>
<span id="cb587-2"><a href="análisis-de-datos-funcionales.html#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">data</span>(maritimes.avg), <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>,<span class="at">cex=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars39-1.png" width="672" /></p>
</div>
<div id="uso-de-bases-de-fourier" class="section level4 hasAnchor" number="13.5.2.6">
<h4><span class="header-section-number">13.5.2.6</span> Uso de bases de Fourier<a href="análisis-de-datos-funcionales.html#uso-de-bases-de-fourier" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="análisis-de-datos-funcionales.html#cb588-1" aria-hidden="true" tabindex="-1"></a>argvals<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,n, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb588-2"><a href="análisis-de-datos-funcionales.html#cb588-2" aria-hidden="true" tabindex="-1"></a>col1<span class="ot">&lt;-</span><span class="fu">sample</span>((<span class="fu">min</span>(maritimes.coords[,<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>)<span class="sc">:</span>(<span class="fu">max</span>(maritimes.coords[,<span class="dv">1</span>])<span class="sc">*</span><span class="dv">100</span>),<span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb588-3"><a href="análisis-de-datos-funcionales.html#cb588-3" aria-hidden="true" tabindex="-1"></a>col2<span class="ot">&lt;-</span><span class="fu">sample</span>((<span class="fu">min</span>(maritimes.coords[,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">100</span>)<span class="sc">:</span>(<span class="fu">max</span>(maritimes.coords[,<span class="dv">2</span>])<span class="sc">*</span><span class="dv">100</span>),<span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb588-4"><a href="análisis-de-datos-funcionales.html#cb588-4" aria-hidden="true" tabindex="-1"></a>new.coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(col1,col2)</span>
<span id="cb588-5"><a href="análisis-de-datos-funcionales.html#cb588-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb588-6"><a href="análisis-de-datos-funcionales.html#cb588-6" aria-hidden="true" tabindex="-1"></a>okfd.res<span class="ot">&lt;-</span><span class="fu">okfd</span>(<span class="at">new.coords=</span>new.coords, <span class="at">coords=</span>maritimes.coords, <span class="at">data=</span>maritimes.data, <span class="at">smooth.type=</span><span class="st">&quot;fourier&quot;</span>, <span class="at">nbasis=</span><span class="dv">65</span>,<span class="at">argvals=</span>argvals, <span class="at">kappa=</span><span class="fl">0.7</span>)</span>
<span id="cb588-7"><a href="análisis-de-datos-funcionales.html#cb588-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(okfd.res)</span></code></pre></div>
<pre><code>##  [1] &quot;coords&quot;                     &quot;data&quot;                       &quot;argvals&quot;                   
##  [4] &quot;nbasis&quot;                     &quot;lambda&quot;                     &quot;new.coords&quot;                
##  [7] &quot;emp.trace.vari&quot;             &quot;trace.vari&quot;                 &quot;new.Eu.d&quot;                  
## [10] &quot;functional.kriging.weights&quot; &quot;krig.new.data&quot;              &quot;pred.var&quot;                  
## [13] &quot;trace.vari.array&quot;           &quot;datafd&quot;</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="análisis-de-datos-funcionales.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(okfd.res, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6000</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars40-1.png" width="672" /></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="análisis-de-datos-funcionales.html#cb591-1" aria-hidden="true" tabindex="-1"></a>trace.variog.bin<span class="ot">&lt;-</span><span class="fu">trace.variog</span>(okfd.res<span class="sc">$</span>coords,okfd.res<span class="sc">$</span>emp.trace.vari<span class="sc">$</span>L2norm, <span class="at">bin=</span><span class="cn">TRUE</span>)</span>
<span id="cb591-2"><a href="análisis-de-datos-funcionales.html#cb591-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(trace.variog.bin<span class="sc">$</span>u,trace.variog.bin<span class="sc">$</span>v , <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6000</span>), <span class="at">xlab=</span><span class="st">&quot;Distancia&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Traza-variograma&quot;</span>, <span class="at">main=</span><span class="st">&quot;Traza-variogram tipo Bin&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars40-2.png" width="672" /></p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="análisis-de-datos-funcionales.html#cb592-1" aria-hidden="true" tabindex="-1"></a>okfd.res<span class="sc">$</span>trace.vari.array</span></code></pre></div>
<pre><code>## [[1]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: spherical
## parameter estimates:
##       tausq     sigmasq         phi 
##    178.3065 483450.0697   1745.6510 
## Practical Range with cor=0.05 for asymptotic range: 1745.651
## 
## variofit: minimised sum of squares = 539799729
## 
## [[2]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: exponential
## parameter estimates:
##      tausq    sigmasq        phi 
##   109.9120 11006.6310    23.1468 
## Practical Range with cor=0.05 for asymptotic range: 69.34151
## 
## variofit: minimised sum of squares = 539566326
## 
## [[3]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: gaussian
## parameter estimates:
##     tausq   sigmasq       phi 
##  369.1311 2103.8708    3.3617 
## Practical Range with cor=0.05 for asymptotic range: 5.818405
## 
## variofit: minimised sum of squares = 552739397
## 
## [[4]]
## variofit: model parameters estimated by OLS (ordinary least squares):
## covariance model is: matern with fixed kappa = 0.7
## parameter estimates:
##     tausq   sigmasq       phi 
##  200.4891 4486.5508    5.8947 
## Practical Range with cor=0.05 for asymptotic range: 20.31812
## 
## variofit: minimised sum of squares = 541310787</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="análisis-de-datos-funcionales.html#cb594-1" aria-hidden="true" tabindex="-1"></a>okfd.res[<span class="dv">11</span>]</span></code></pre></div>
<pre><code>## $krig.new.data
##               [,1]       [,2]        [,3]         [,4]          [,5]        [,6]         [,7]         [,8]
##   [1,] -5.12079753 -3.8124510 -3.64515081  -9.59594821  -8.332494956 -5.51620591  -6.94823916  -8.15570060
##   [2,] -5.22446551 -3.8831771 -3.77626642  -9.78744394  -8.384757619 -5.63838899  -6.96381276  -8.31207498
##   [3,] -5.42041839 -4.0073009 -3.92101761 -10.05908036  -8.479568969 -5.82925059  -7.17977969  -8.59104427
##   [4,] -5.71065900 -4.1949442 -4.08940921 -10.39765545  -8.630971975 -6.10068541  -7.59353947  -8.98086752
##   [5,] -6.07424481 -4.4402097 -4.28114673 -10.77433759  -8.840609551 -6.44465498  -8.15607522  -9.44404464
##   [6,] -6.47173397 -4.7218837 -4.48630849 -11.15000333  -9.097145596 -6.83320221  -8.78489236  -9.92508278
##   [7,] -6.85490547 -5.0086470 -4.68919270 -11.48364152  -9.379743651 -7.22433566  -9.38532579 -10.36332717
##   [8,] -7.17914212 -5.2674262 -4.87396189 -11.74170882  -9.664386806 -7.57220088  -9.87447432 -10.70748634
##   [9,] -7.41501827 -5.4725364 -5.03016068 -11.90592848  -9.930896568 -7.83865511 -10.20134791 -10.92790361
##  [10,] -7.55575896 -5.6129258 -5.15624160 -11.97732840 -10.168269608 -8.00289153 -10.35788576 -11.02314927
##  [11,] -7.61832611 -5.6952837 -5.25987927 -11.97525896 -10.376483842 -8.06626990 -10.37803013 -11.01901245
##  [12,] -7.63765460 -5.7418865 -5.35488889 -11.93147682 -10.564074299 -8.05086653 -10.32532593 -10.96005409
##  [13,] -7.65552022 -5.7835626 -5.45567619 -11.88076168 -10.742194598 -7.99207527 -10.27265928 -10.89597090
##  [14,] -7.70711851 -5.8496192 -5.57099139 -11.85056143 -10.917119862 -7.92734948 -10.27988470 -10.86652644
##  [15,] -7.80920179 -5.9575725 -5.69907440 -11.85253479 -11.083811414 -7.88435908 -10.37563740 -10.88929467
##  [16,] -7.95331990 -6.1057541 -5.82595098 -11.87845006 -11.223017077 -7.87209188 -10.54843592 -10.95377465
##  [17,] -8.10638997 -6.2712207 -5.92775124 -11.90179004 -11.303428941 -7.87765967 -10.74958621 -11.02373860
##  [18,] -8.21882496 -6.4140190 -5.97672077 -11.88488906 -11.288915460 -7.86997827 -10.90711607 -11.04742069
##  [19,] -8.23831801 -6.4871068 -5.94943155 -11.78989425 -11.149218341 -7.80951586 -10.94690511 -10.97295256
##  [20,] -8.12570313 -6.4495775 -5.83492172 -11.59072006 -10.871244825 -7.66150246 -10.81516952 -10.76491403
##  [21,] -7.86856868 -6.2797509 -5.64034558 -11.28277094 -10.467593682 -7.40888601 -10.49605984 -10.41742738
##  [22,] -7.48872263 -5.9844956 -5.39226675 -10.88766996  -9.979421460 -7.06123559 -10.01943705  -9.96002254
##  [23,] -7.04111065 -5.6019413 -5.13284604 -10.45144841  -9.472104270 -6.65678071  -9.45654234  -9.45434102
##  [24,] -6.60398769 -5.1963435 -4.91156278 -10.03631608  -9.024040551 -6.25658244  -8.90453887  -8.98214646
##  [25,] -6.26246056 -4.8458729 -4.77437908  -9.70780903  -8.710861904 -5.93197082  -8.46388928  -8.62742947
##  [26,] -6.08933047 -4.6259968 -4.75305027  -9.52035826  -8.588731917 -5.74826747  -8.21443269  -8.45701102
##  [27,] -6.12797715 -4.5923846 -4.85736334  -9.50480319  -8.680898803 -5.74891652  -8.19633833  -8.50452374
##  [28,] -6.38160845 -4.7675505 -5.07240768  -9.66095258  -8.971052664 -5.94415691  -8.40077543  -8.76185081
##  [29,] -6.81164933 -5.1346379 -5.36171550  -9.95707514  -9.405448082 -6.30726586  -8.77253503  -9.18023370
##  [30,] -7.34576097 -5.6400488 -5.67558765 -10.33649377  -9.903585769 -6.77947649  -9.22369355  -9.68081546
##  [31,] -7.89356292 -6.2044423 -5.96255352 -10.72970272 -10.375069838 -7.28243488  -9.65457441 -10.17200752
##  [32,] -8.36621182 -6.7395432 -6.18107515 -11.06907831 -10.738651679 -7.73511590  -9.97649864 -10.56937877
##  [33,] -8.69506826 -7.1667475 -6.30852843 -11.30265404 -10.938875471 -8.07098459 -10.13056226 -10.81319990
##  [34,] -8.84499231 -7.4330757 -6.34520587 -11.40372765 -10.956325744 -8.25117169 -10.09796292 -10.87946771
##  [35,] -8.81925312 -7.5207180 -6.31239848 -11.37417089 -10.809100393 -8.27052590  -9.89982324 -10.78198248
##  [36,] -8.65522321 -7.4480614 -6.24517685 -11.24092755 -10.545369794 -8.15530870  -9.58732790 -10.56538079
##  [37,] -8.41237117 -7.2622540 -6.18188333 -11.04688609 -10.229144818 -7.95349012  -9.22550856 -10.29131556
##  [38,] -8.15594922 -7.0254778 -6.15319307 -10.83866364  -9.923067034 -7.72049438  -8.87549999 -10.02162724
##  [39,] -7.94071383 -6.7986249 -6.17367626 -10.65450066  -9.672710641 -7.50433069  -8.58018316  -9.80294969
##  [40,] -7.79879668 -6.6266020 -6.23808034 -10.51529133  -9.496378189 -7.33405047  -8.35685711  -9.65661447
##  [41,] -7.73455392 -6.5289128 -6.32324750 -10.42083640  -9.382829015 -7.21441994  -8.19835244  -9.57614839
##  [42,] -7.72724003 -6.4976532 -6.39504609 -10.35197040  -9.297223908 -7.12789611  -8.08147943  -9.53254676
##  [43,] -7.74023206 -6.5030197 -6.41834214 -10.27767459  -9.193383923 -7.04295232  -7.97961946  -9.48542848
##  [44,] -7.73384258 -6.5044341 -6.36723452 -10.16504183  -9.028827925 -6.92608106  -7.87519924  -9.39668984
##  [45,] -7.67794529 -6.4639557 -6.23273544  -9.98932295  -8.778397584 -6.75386880  -7.76800691  -9.24274864
##  [46,] -7.56088497 -6.3581569 -6.02580224  -9.74139331  -8.442756448 -6.52162864  -7.67671675  -9.02201654
##  [47,] -7.39234636 -6.1852009 -5.77491036  -9.43077469  -8.049510571 -6.24614216  -7.63314468  -8.75567142
##  [48,] -7.19965210 -5.9652888 -5.51884806  -9.08359042  -7.646730253 -5.96178520  -7.67101688  -8.48170633
##  [49,] -7.01883280 -5.7345446 -5.29670347  -8.73617764  -7.290699537 -5.71120124  -7.81273710  -8.24407795
##  [50,] -6.88324157 -5.5342391 -5.13775592  -8.42617240  -7.031234138 -5.53321467  -8.05829712  -8.08006997
##  [51,] -6.81309124 -5.3985197 -5.05398427  -8.18344938  -6.898497754 -5.45142686  -8.37990846  -8.00939389
##  [52,] -6.80893036 -5.3441736 -5.03717202  -8.02321793  -6.894777214 -5.46671915  -8.72431701  -8.02799291
##  [53,] -6.85087572 -5.3653232 -5.06133415  -7.94290547  -6.993302411 -5.55577739  -9.02256786  -8.10817451
##  [54,] -6.90374352 -5.4345286 -5.08975833  -7.92340737  -7.144309191 -5.67607667  -9.20484815  -8.20496187
##  [55,] -6.92654928 -5.5099559 -5.08473494  -7.93414487  -7.286659597 -5.77599502  -9.21655898  -8.26690252
##  [56,] -6.88364708 -5.5465769 -5.01736989  -7.94045286  -7.361953406 -5.80734926  -9.03136768  -8.24844396
##  [57,] -6.75437303 -5.5082633 -4.87490498  -7.91134115  -7.327534965 -5.73703306  -8.65777218  -8.12066247
##  [58,] -6.53853958 -5.3774237 -4.66369009  -7.82573178  -7.165226715 -5.55473578  -8.13744152  -7.87766800
##  [59,] -6.25633760 -5.1595486 -4.40714933  -7.67581428  -6.883851990 -5.27482646  -7.53578683  -7.53722675
##  [60,] -5.94278515 -4.8814746 -4.13942640  -7.46700370  -6.515282886 -4.93207679  -6.92725459  -7.13569105
##  [61,] -5.63836385 -4.5839280 -3.89651597  -7.21488488  -6.105400451 -4.57252510  -6.37915951  -6.71877772
##  [62,] -5.37848850 -4.3104795 -3.70729110  -6.94024068  -5.702549085 -4.24200630  -5.93814066  -6.33071192
##  [63,] -5.18469705 -4.0959958 -3.58677366  -6.66361811  -5.346514929 -3.97537548  -5.62248571  -6.00452020
##  [64,] -5.05988089 -3.9577539 -3.53330167  -6.40082514  -5.060686121 -3.78912592  -5.42188578  -5.75578212
##  [65,] -4.98868213 -3.8915852 -3.53013325  -6.16032976  -4.849013989 -3.67907009  -5.30414738  -5.58110398
##  [66,] -4.94271835 -3.8739697 -3.55080885  -5.94290433  -4.698012631 -3.62332605  -5.22656954  -5.46127326
##  [67,] -4.88897518 -3.8693274 -3.56660808  -5.74321664  -4.582706831 -3.58943930  -5.14858821  -5.36785290
##  [68,] -4.79889877 -3.8403221 -3.55394888  -5.55259342  -4.474520293 -3.54345545  -5.04217208  -5.27119389
##  [69,] -4.65563462 -3.7582036 -3.49970211  -5.36198739  -4.348805529 -3.45840039  -4.89731777  -5.14766228
##  [70,] -4.45749537 -3.6102771 -3.40307987  -5.16428593  -4.190081021 -3.31998225  -4.72155093  -4.98429878
##  [71,] -4.21689478 -3.4024732 -3.27378987  -4.95544092  -3.993902709 -3.12826436  -4.53412451  -4.77999461
##  [72,] -3.95531180 -3.1564363 -3.12723151  -4.73434536  -3.765368673 -2.89527301  -4.35709869  -4.54330482
##  [73,] -3.69596400 -2.9021310 -2.97833285  -4.50178408  -3.515213495 -2.63964055  -4.20627321  -4.28793119
##  [74,] -3.45646045 -2.6682404 -2.83596652  -4.25902654  -3.255025510 -2.38012511  -4.08482499  -4.02744645
##  [75,] -3.24361741 -2.4732282 -2.69965131  -4.00665088  -2.993181618 -2.13000562  -3.98155081  -3.77088056
##  [76,] -3.05190126 -2.3197027 -2.55952350  -3.74401061  -2.732668725 -1.89391679  -3.87413386  -3.52037198
##  [77,] -2.86583775 -2.1937273 -2.39956501  -3.46945880  -2.471220686 -1.66782644  -3.73629676  -3.27136151
##  [78,] -2.66553370 -2.0692557 -2.20309453  -3.18114353  -2.203399837 -1.44184784  -3.54653013  -3.01500551
##  [79,] -2.43354578 -1.9163680 -1.95884569  -2.87798779  -1.923648683 -1.20473233  -3.29563310  -2.74184940
##  [80,] -2.16096229 -1.7108609 -1.66576690  -2.56043150  -1.629107252 -0.94844884  -2.99068522  -2.44550542
##  [81,] -1.85083468 -1.4423437 -1.33503232  -2.23064385  -1.321183371 -0.67133906  -2.65416019  -2.12518288
##  [82,] -1.51791662 -1.1184080 -0.98855017  -1.89215417  -1.005386976 -0.37888945  -2.31835635  -1.78636561
##  [83,] -1.18478950 -0.7635690 -0.65426367  -1.54910359  -0.689602230 -0.08199158  -2.01672088  -1.43956001
##  [84,] -0.87554167 -0.4131850 -0.35947544  -1.20548803  -0.381541775  0.20660025  -1.77457480  -1.09764520
##  [85,] -0.60890366 -0.1040258 -0.12401957  -0.86477903  -0.086412686  0.47632686  -1.60193595  -0.77275745
##  [86,] -0.39290960  0.1358495  0.04481084  -0.53015853   0.194269788  0.72196738  -1.49054146  -0.47372192
##  [87,] -0.22270841  0.2950039  0.15412809  -0.20533678   0.462221578  0.94477053  -1.41596739  -0.20479708
##  [88,] -0.08221907  0.3820189  0.22352242   0.10436669   0.720412433  1.15117133  -1.34428574   0.03398614
##  [89,]  0.05081524  0.4233239  0.27980205   0.39120195   0.970306092  1.34952389  -1.24140683   0.24516323
##  [90,]  0.19783756  0.4559840  0.34978874   0.64497788   1.209418287  1.54598232  -1.08249691   0.43157178
##  [91,]  0.37261435  0.5174075  0.45311242   0.85423262   1.430282663  1.74100410  -0.85884528   0.59439802
##  [92,]  0.57656435  0.6348386  0.59697436   1.00860354   1.621511291  1.92781465  -0.58027934   0.73233180
##  [93,]  0.79774461  0.8176013  0.77433394   1.10198785   1.770952976  2.09358855  -0.27247539   0.84223883
##  [94,]  1.01392427  1.0543246  0.96605433   1.13571540   1.870200126  2.22324206   0.03006884   0.92122129
##  [95,]  1.19899734  1.3160118  1.14646727   1.12077265   1.919118007  2.30485444   0.29344709   0.96942307
##  [96,]  1.33099691  1.5641830  1.29087618   1.07820271   1.928870882  2.33511492   0.49355898   0.99260942
##  [97,]  1.39945729  1.7618905  1.38296734   1.03716961   1.922191713  2.32303214   0.62263230   1.00352214
##  [98,]  1.40997951  1.8845677  1.42009241   1.03073961   1.930337510  2.29051484   0.69133033   1.02130153
##  [99,]  1.38456821  1.9276746  1.41492835   1.09005731   1.987109256  2.26925029   0.72594490   1.06879895
## [100,]  1.35743362  1.9089435  1.39297174   1.23810638   2.121227234  2.29435014   0.76150687   1.16822933
##                  [,9]        [,10]
##   [1,] -3.98104283898 -3.748137631
##   [2,] -4.05239305028 -3.816478740
##   [3,] -4.18780729809 -3.936320473
##   [4,] -4.39672955573 -4.118754740
##   [5,] -4.67068504929 -4.358987159
##   [6,] -4.98446550882 -4.636767534
##   [7,] -5.30211332480 -4.921388466
##   [8,] -5.58616328563 -5.179927478
##   [9,] -5.80759065175 -5.386391893
##  [10,] -5.95360662963 -5.529064423
##  [11,] -6.03095193062 -5.613770814
##  [12,] -6.06355002509 -5.661904722
##  [13,] -6.08497262743 -5.703551401
##  [14,] -6.12769935884 -5.767528037
##  [15,] -6.21218147347 -5.871174711
##  [16,] -6.33893247758 -6.012971678
##  [17,] -6.48617212650 -6.170421048
##  [18,] -6.61410325432 -6.304255928
##  [19,] -6.67507827184 -6.368284613
##  [20,] -6.62720749434 -6.322520284
##  [21,] -6.44785292335 -6.146158031
##  [22,] -6.14326848534 -5.846770419
##  [23,] -5.75147703911 -5.462892783
##  [24,] -5.33712756982 -5.058782082
##  [25,] -4.97913494634 -4.712151379
##  [26,] -4.75382998169 -4.497574358
##  [27,] -4.71762205855 -4.469507699
##  [28,] -4.89344553826 -4.649138545
##  [29,] -5.26443090992 -5.018433536
##  [30,] -5.77650889795 -5.523038304
##  [31,] -6.34945894977 -6.083488584
##  [32,] -6.89381841178 -6.612112005
##  [33,] -7.32961874737 -7.031568488
##  [34,] -7.60248697677 -7.290575059
##  [35,] -7.69335338150 -7.373096394
##  [36,] -7.61965315102 -7.298963985
##  [37,] -7.42806644910 -7.116072848
##  [38,] -7.18094436652 -6.886421264
##  [39,] -6.94007344749 -6.669753415
##  [40,] -6.75195916482 -6.509053074
##  [41,] -6.63824240630 -6.421505677
##  [42,] -6.59337718806 -6.396982411
##  [43,] -6.58970708676 -6.404036171
##  [44,] -6.58812246726 -6.401396265
##  [45,] -6.55107928239 -6.351542101
##  [46,] -6.45427147721 -6.232492209
##  [47,] -6.29377744010 -6.044563246
##  [48,] -6.08687407419 -5.810343454
##  [49,] -5.86653285110 -5.568061471
##  [50,] -5.67137154397 -5.360374521
##  [51,] -5.53405314670 -5.221844631
##  [52,] -5.47147930514 -5.168685094
##  [53,] -5.47954297650 -5.193671188
##  [54,] -5.53386748906 -5.267626171
##  [55,] -5.59625426532 -5.347039212
##  [56,] -5.62496984078 -5.385666333
##  [57,] -5.58596357653 -5.346880014
##  [58,] -5.46189760052 -5.213360316
##  [59,] -5.25653134329 -4.991495437
##  [60,] -4.99333336126 -4.709353598
##  [61,] -4.70880980338 -4.408875713
##  [62,] -4.44248673396 -4.134518297
##  [63,] -4.22636346880 -3.921512371
##  [64,] -4.07673313272 -3.786946540
##  [65,] -3.99053975845 -3.726033587
##  [66,] -3.94712839730 -3.714431725
##  [67,] -3.91472518073 -3.715790843
##  [68,] -3.85968751128 -3.692260523
##  [69,] -3.75584893310 -3.614927963
##  [70,] -3.59133677261 -3.471254727
##  [71,] -3.37103133548 -3.267507994
##  [72,] -3.11412420265 -3.025658494
##  [73,] -2.84764484497 -2.775815706
##  [74,] -2.59795641758 -2.546534230
##  [75,] -2.38275681817 -2.355897487
##  [76,] -2.20591828674 -2.206011012
##  [77,] -2.05662863780 -2.082505372
##  [78,] -1.91301942029 -1.959162203
##  [79,] -1.74915336913 -1.806267429
##  [80,] -1.54327317090 -1.600198999
##  [81,] -1.28486113835 -1.331387300
##  [82,] -0.97842039429 -1.008249953
##  [83,] -0.64285283252 -0.655865043
##  [84,] -0.30659549540 -0.309673739
##  [85,]  0.00008724653 -0.005955762
##  [86,]  0.25342902748  0.228218804
##  [87,]  0.44269263264  0.382668733
##  [88,]  0.57300707324  0.467160235
##  [89,]  0.66367228623  0.508886613
##  [90,]  0.74240027979  0.544992737
##  [91,]  0.83713974763  0.612190339
##  [92,]  0.96784230984  0.736367388
##  [93,]  1.14056684709  0.925138770
##  [94,]  1.34566895468  1.165496261
##  [95,]  1.56066575756  1.427307931
##  [96,]  1.75702731719  1.671780647
##  [97,]  1.90900311786  1.862591230
##  [98,]  2.00197112346  1.976607993
##  [99,]  2.03787853065  2.011189444
## [100,]  2.03611269727  1.985950589
##  [ reached getOption(&quot;max.print&quot;) -- omitted 265 rows ]</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="análisis-de-datos-funcionales.html#cb596-1" aria-hidden="true" tabindex="-1"></a>okfd.res[<span class="dv">12</span>]</span></code></pre></div>
<pre><code>## $pred.var
##  [1] 4157.310 4420.736 4244.882 4158.817 4258.427 4160.441 4170.696 4159.506 4230.533 4549.958</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="análisis-de-datos-funcionales.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(okfd.res<span class="sc">$</span>argvals, okfd.res<span class="sc">$</span>krig.new.data, <span class="at">col=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">main=</span><span class="st">&quot;Predicciones&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Día&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Temperatura (grados °C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars40-3.png" width="672" /></p>
</div>
</div>
</div>
<div id="patrones-puntuales" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Patrones Puntuales<a href="análisis-de-datos-funcionales.html#patrones-puntuales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El análisis de patrones puntuales (PP) estudia la distribución espacial de los puntos (Boots &amp; Getis, 1988). En el análisis se utiliza la densidad, la dispersión y la homogeneidad de conjuntos de datos de puntos para evaluar, cuantificar y caracterizar su distribución. Durante los últimos cincuenta años, se han desarrollado varios métodos y medidas para analizar, modelar, visualizar e interpretar estas propiedades de los patrones puntuales (Qiang et al, 2020).</p>
<p>Hay tres categorías principales de técnicas que se pueden aplicar en PP:</p>
<ol style="list-style-type: decimal">
<li>Estadísticas descriptivas</li>
<li>Métodos basados en densidades</li>
<li>Métodos basados en distancias</li>
</ol>
<p>El uso de estadísticas descriptivas proporciona un resumen de las características básicas del patrón, como su tendencia central y dispersión. Las estadísticas descriptivas brindan una manera simple de visualizar un conjunto de datos como un todo, a partir de estadísticas como la mediana o la media o con medidas de dispersión tales como el eclipse de desviación estándar para aquellos conjuntos de datos que muestran un patrón direccional.</p>
<p>Sin embargo, las estadísticas descriptivas son algo limitadas en lo que pueden comunicar sobre el patrón de un conjunto de datos. Así, se han desarrollado técnicas más poderosas para explorar patrones, que se basan en la densidad o en la distancia, según las propiedades espaciales que la técnica esté considerando (Gimond, 2020).</p>
<p>Los métodos basados en densidades se centran en las propiedades de primer orden de un conjunto de datos, es decir, la variación en las ubicaciones individuales de los puntos del conjunto de datos en el área de interés, y caracterizan la distribución del conjunto de datos en términos de densidad.</p>
<p>Los métodos basados en distancias se centran en las propiedades de segundo orden de un conjunto de datos, es decir, las interacciones entre puntos, la forma de distriburirse o la tendencia a formar grupos, y caracterizan la distribución del conjunto de datos en términos de dispersión.</p>
<div id="datos" class="section level3 hasAnchor" number="13.6.1">
<h3><span class="header-section-number">13.6.1</span> Datos<a href="análisis-de-datos-funcionales.html#datos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La base de datos que se trabaja en esta guía presenta información de la intensidad de sismos en el territorio colombiano en el 2009. Se cuenta con las coordanadas planas y la intensidad del sismo.</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="análisis-de-datos-funcionales.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb599-2"><a href="análisis-de-datos-funcionales.html#cb599-2" aria-hidden="true" tabindex="-1"></a><span class="co">#paquetes necesarios</span></span>
<span id="cb599-3"><a href="análisis-de-datos-funcionales.html#cb599-3" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb599-4"><a href="análisis-de-datos-funcionales.html#cb599-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span> (sp)</span>
<span id="cb599-5"><a href="análisis-de-datos-funcionales.html#cb599-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb599-6"><a href="análisis-de-datos-funcionales.html#cb599-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb599-7"><a href="análisis-de-datos-funcionales.html#cb599-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splancs)</span>
<span id="cb599-8"><a href="análisis-de-datos-funcionales.html#cb599-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb599-9"><a href="análisis-de-datos-funcionales.html#cb599-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mctest)</span>
<span id="cb599-10"><a href="análisis-de-datos-funcionales.html#cb599-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb599-11"><a href="análisis-de-datos-funcionales.html#cb599-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb599-12"><a href="análisis-de-datos-funcionales.html#cb599-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb599-13"><a href="análisis-de-datos-funcionales.html#cb599-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecodist)</span>
<span id="cb599-14"><a href="análisis-de-datos-funcionales.html#cb599-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb599-15"><a href="análisis-de-datos-funcionales.html#cb599-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-16"><a href="análisis-de-datos-funcionales.html#cb599-16" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb599-17"><a href="análisis-de-datos-funcionales.html#cb599-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Lectura datos</span></span>
<span id="cb599-18"><a href="análisis-de-datos-funcionales.html#cb599-18" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb599-19"><a href="análisis-de-datos-funcionales.html#cb599-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-20"><a href="análisis-de-datos-funcionales.html#cb599-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos = Datos_Sismos_2009</span></span>
<span id="cb599-21"><a href="análisis-de-datos-funcionales.html#cb599-21" aria-hidden="true" tabindex="-1"></a>Datos<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data_11_PatronesPuntuales/6_PatronesPuntuales/Datos/Datos_Sismos_2009.txt&quot;</span>,<span class="at">dec=</span><span class="st">&quot;,&quot;</span>,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb599-22"><a href="análisis-de-datos-funcionales.html#cb599-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Datos)</span></code></pre></div>
<pre><code>##        X                 Y              Magnitud    
##  Min.   : 465013   Min.   : 537163   Min.   :1.000  
##  1st Qu.: 789186   1st Qu.: 890133   1st Qu.:1.600  
##  Median : 929859   Median :1095527   Median :2.000  
##  Mean   : 915088   Mean   :1078983   Mean   :2.105  
##  3rd Qu.:1035149   3rd Qu.:1250936   3rd Qu.:2.500  
##  Max.   :1331751   Max.   :1843089   Max.   :5.500</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="análisis-de-datos-funcionales.html#cb601-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">readShapePoly</span>(<span class="st">&quot;data_11_PatronesPuntuales/6_PatronesPuntuales/Datos/Colombia.shp&quot;</span>)</span>
<span id="cb601-2"><a href="análisis-de-datos-funcionales.html#cb601-2" aria-hidden="true" tabindex="-1"></a>SP <span class="ot">&lt;-</span> <span class="fu">as</span>(S, <span class="st">&quot;SpatialPolygons&quot;</span>)</span>
<span id="cb601-3"><a href="análisis-de-datos-funcionales.html#cb601-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-4"><a href="análisis-de-datos-funcionales.html#cb601-4" aria-hidden="true" tabindex="-1"></a>sismos<span class="ot">=</span><span class="fu">ppp</span>(Datos<span class="sc">$</span>X,Datos<span class="sc">$</span>Y,<span class="at">marks=</span>Datos<span class="sc">$</span>Magnitud,<span class="at">window=</span><span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">450433</span>,<span class="dv">1806815</span>),<span class="fu">c</span>(<span class="fl">22875.5</span>,<span class="fl">1870870.5</span>)))</span>
<span id="cb601-5"><a href="análisis-de-datos-funcionales.html#cb601-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unitname</span>(sismos)<span class="ot">=</span><span class="st">&quot;meter&quot;</span></span></code></pre></div>
<div id="análisis-descriptivo" class="section level4 hasAnchor" number="13.6.1.1">
<h4><span class="header-section-number">13.6.1.1</span> Análisis descriptivo<a href="análisis-de-datos-funcionales.html#análisis-descriptivo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A continuación, se presentan los respectivos histogramas.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="análisis-de-datos-funcionales.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb602-2"><a href="análisis-de-datos-funcionales.html#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráficas básicas</span></span>
<span id="cb602-3"><a href="análisis-de-datos-funcionales.html#cb602-3" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb602-4"><a href="análisis-de-datos-funcionales.html#cb602-4" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb602-5"><a href="análisis-de-datos-funcionales.html#cb602-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars42-1.png" width="672" /></p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="análisis-de-datos-funcionales.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb603-2"><a href="análisis-de-datos-funcionales.html#cb603-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb603-3"><a href="análisis-de-datos-funcionales.html#cb603-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sismos<span class="sc">$</span>x,<span class="at">xlab=</span><span class="st">&quot;Este&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb603-4"><a href="análisis-de-datos-funcionales.html#cb603-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sismos<span class="sc">$</span>y,<span class="at">xlab=</span><span class="st">&quot;Norte&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars42-2.png" width="672" /></p>
</div>
<div id="pruebas-de-aleatoriedad-basadas-en-cuadrantes" class="section level4 hasAnchor" number="13.6.1.2">
<h4><span class="header-section-number">13.6.1.2</span> Pruebas de Aleatoriedad basadas en cuadrantes<a href="análisis-de-datos-funcionales.html#pruebas-de-aleatoriedad-basadas-en-cuadrantes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Al observar la distribución de los puntos en el conjunto de datos y los patrones respectivos que muestran, la pregunta clave que a menudo es necesario responder es: ¿los puntos en el conjunto de datos están agrupados, distribuidos aleatoriamente (es decir, muestran una aleatoriedad espacial completa), uniformes o dispersos?</p>
<p>Si bien es posible evaluar visualmente esta distribución, para poder cuantificar estadísticamente la distribución de los datos, es posible comparar su distribución con la distribución de Poisson (la distribución de Poisson describe la probabilidad o tasa de que ocurra un evento en un intervalo fijo de tiempo o espacio).</p>
<p>Esencialmente, si los datos no se ajustan al modelo de Poisson, entonces se puede inferir que algo interesante podría estar sucediendo y que nuestros eventos podrían no ser independientes entre sí. En cambio, pueden estar agrupados o dispersos y es probable que haya procesos subyacentes que influyan en estos patrones.</p>
<p>La prueba más básica de aleatoriedad espacial se puede completar con los resultados de una análisis por cuadrantes. La idea de esta prueba es comparar los cuadrantes construidos con la base de datos y compararlos con una distribución de Poisson para los mismos cuadrantes; es decir, se verifica si la distribución de puntos en el área de estudio difiere de la aleatoriedad espacial completa y si se encuentran algunos grupos presentes. Así, es posible llevar a cabo una prueba de chi-cuadrado. Esta prueba permitirá evidenciar si los datos observados se distribuyen bajo la hipótesis nula de aleatoriedad</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="análisis-de-datos-funcionales.html#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb604-2"><a href="análisis-de-datos-funcionales.html#cb604-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Por medio de cuadrados</span></span>
<span id="cb604-3"><a href="análisis-de-datos-funcionales.html#cb604-3" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb604-4"><a href="análisis-de-datos-funcionales.html#cb604-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-5"><a href="análisis-de-datos-funcionales.html#cb604-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Prueba Chi-cuadrado</span></span>
<span id="cb604-6"><a href="análisis-de-datos-funcionales.html#cb604-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Ho: la intensidad es homogenea</span></span>
<span id="cb604-7"><a href="análisis-de-datos-funcionales.html#cb604-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Ha: la intensidad no es homogenea</span></span>
<span id="cb604-8"><a href="análisis-de-datos-funcionales.html#cb604-8" aria-hidden="true" tabindex="-1"></a><span class="co">#sismos.split &lt;- split(sismos)</span></span>
<span id="cb604-9"><a href="análisis-de-datos-funcionales.html#cb604-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb604-10"><a href="análisis-de-datos-funcionales.html#cb604-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Cuadricula 4x4</span></span>
<span id="cb604-11"><a href="análisis-de-datos-funcionales.html#cb604-11" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##                      x
## y                     [4.5e+05,7.9e+05) [7.9e+05,1.13e+06) [1.13e+06,1.47e+06) [1.47e+06,1.81e+06]
##   [1.41e+06,1.87e+06]                 2                 83                  12                   0
##   [9.47e+05,1.41e+06)               160                506                  85                   0
##   [4.85e+05,9.47e+05)               148                232                   7                   0
##   [2.29e+04,4.85e+05)                 0                  0                   0                   0</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="análisis-de-datos-funcionales.html#cb606-1" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">=</span> <span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span>
<span id="cb606-2"><a href="análisis-de-datos-funcionales.html#cb606-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb606-3"><a href="análisis-de-datos-funcionales.html#cb606-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">&quot;+&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb606-4"><a href="análisis-de-datos-funcionales.html#cb606-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q4, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb606-5"><a href="análisis-de-datos-funcionales.html#cb606-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-1.png" width="672" /></p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="análisis-de-datos-funcionales.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(sismos, <span class="at">nx =</span> <span class="dv">4</span>, <span class="at">ny =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  sismos
## X2 = 3580.2, df = 15, p-value &lt; 0.00000000000000022
## alternative hypothesis: two.sided
## 
## Quadrats: 4 by 4 grid of tiles</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="análisis-de-datos-funcionales.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cuadricula 5x5</span></span>
<span id="cb609-2"><a href="análisis-de-datos-funcionales.html#cb609-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##                      x
## y                     [4.5e+05,7.22e+05) [7.22e+05,9.93e+05) [9.93e+05,1.26e+06) [1.26e+06,1.54e+06)
##   [1.5e+06,1.87e+06]                   0                   8                  52                   0
##   [1.13e+06,1.5e+06)                  59                 173                 247                   1
##   [7.62e+05,1.13e+06)                 64                 366                 123                   1
##   [3.92e+05,7.62e+05)                 50                  80                  11                   0
##   [2.29e+04,3.92e+05)                  0                   0                   0                   0
##                      x
## y                     [1.54e+06,1.81e+06]
##   [1.5e+06,1.87e+06]                    0
##   [1.13e+06,1.5e+06)                    0
##   [7.62e+05,1.13e+06)                   0
##   [3.92e+05,7.62e+05)                   0
##   [2.29e+04,3.92e+05)                   0</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="análisis-de-datos-funcionales.html#cb611-1" aria-hidden="true" tabindex="-1"></a>Q5 <span class="ot">=</span> <span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">5</span>)</span>
<span id="cb611-2"><a href="análisis-de-datos-funcionales.html#cb611-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb611-3"><a href="análisis-de-datos-funcionales.html#cb611-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">&quot;+&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb611-4"><a href="análisis-de-datos-funcionales.html#cb611-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q5, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb611-5"><a href="análisis-de-datos-funcionales.html#cb611-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-2.png" width="672" /></p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="análisis-de-datos-funcionales.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(sismos, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  sismos
## X2 = 4015.8, df = 24, p-value &lt; 0.00000000000000022
## alternative hypothesis: two.sided
## 
## Quadrats: 5 by 5 grid of tiles</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="análisis-de-datos-funcionales.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cuadricula 6x6</span></span>
<span id="cb614-2"><a href="análisis-de-datos-funcionales.html#cb614-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>##                      x
## y                     [4.5e+05,6.76e+05) [6.76e+05,9.03e+05) [9.03e+05,1.13e+06) [1.13e+06,1.35e+06)
##   [1.56e+06,1.87e+06]                  0                   2                  26                   6
##   [1.25e+06,1.56e+06)                 17                  79                 133                  35
##   [9.47e+05,1.25e+06)                  9                 157                 328                  56
##   [6.39e+05,9.47e+05)                 44                 197                 118                   7
##   [3.31e+05,6.39e+05)                 17                   4                   0                   0
##   [2.29e+04,3.31e+05)                  0                   0                   0                   0
##                      x
## y                     [1.35e+06,1.58e+06) [1.58e+06,1.81e+06]
##   [1.56e+06,1.87e+06]                   0                   0
##   [1.25e+06,1.56e+06)                   0                   0
##   [9.47e+05,1.25e+06)                   0                   0
##   [6.39e+05,9.47e+05)                   0                   0
##   [3.31e+05,6.39e+05)                   0                   0
##   [2.29e+04,3.31e+05)                   0                   0</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="análisis-de-datos-funcionales.html#cb616-1" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">=</span> <span class="fu">quadratcount</span>(sismos, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span>
<span id="cb616-2"><a href="análisis-de-datos-funcionales.html#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb616-3"><a href="análisis-de-datos-funcionales.html#cb616-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="st">&quot;+&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb616-4"><a href="análisis-de-datos-funcionales.html#cb616-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q4, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex =</span> <span class="fl">0.8</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb616-5"><a href="análisis-de-datos-funcionales.html#cb616-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-3.png" width="672" /></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="análisis-de-datos-funcionales.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(sismos, <span class="at">nx =</span> <span class="dv">6</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  sismos
## X2 = 5079.8, df = 35, p-value &lt; 0.00000000000000022
## alternative hypothesis: two.sided
## 
## Quadrats: 6 by 6 grid of tiles</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="análisis-de-datos-funcionales.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lamda Retícula 4X4</span></span>
<span id="cb619-2"><a href="análisis-de-datos-funcionales.html#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos, <span class="at">main=</span><span class="st">&quot;Eventos&quot;</span>, <span class="at">pch=</span><span class="dv">18</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-4.png" width="672" /></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="análisis-de-datos-funcionales.html#cb620-1" aria-hidden="true" tabindex="-1"></a>lambda1<span class="ot">&lt;-</span><span class="fu">quadratcount</span>(sismos, <span class="at">nx=</span><span class="dv">4</span>,<span class="at">ny=</span><span class="dv">4</span>)</span>
<span id="cb620-2"><a href="análisis-de-datos-funcionales.html#cb620-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda1, <span class="at">main=</span><span class="st">&quot; Intensidad reticula 4*4&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-5.png" width="672" /></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="análisis-de-datos-funcionales.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lamda Retícula 5X5</span></span>
<span id="cb621-2"><a href="análisis-de-datos-funcionales.html#cb621-2" aria-hidden="true" tabindex="-1"></a>lambda2<span class="ot">&lt;-</span><span class="fu">quadratcount</span>(sismos, <span class="at">nx=</span><span class="dv">5</span>,<span class="at">ny=</span><span class="dv">5</span>)</span>
<span id="cb621-3"><a href="análisis-de-datos-funcionales.html#cb621-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda2, <span class="at">main=</span><span class="st">&quot; Intensidad reticula 5*5&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-6.png" width="672" /></p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="análisis-de-datos-funcionales.html#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lamda 6X6</span></span>
<span id="cb622-2"><a href="análisis-de-datos-funcionales.html#cb622-2" aria-hidden="true" tabindex="-1"></a>lambda3<span class="ot">&lt;-</span><span class="fu">quadratcount</span>(sismos, <span class="at">nx=</span><span class="dv">6</span>,<span class="at">ny=</span><span class="dv">6</span>)</span>
<span id="cb622-3"><a href="análisis-de-datos-funcionales.html#cb622-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda3, <span class="at">main=</span><span class="st">&quot;Intensidad reticula 6*6&quot;</span>, <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars43-7.png" width="672" /></p>
</div>
<div id="pruebas-de-aleatoriedad-basadas-en-distancias" class="section level4 hasAnchor" number="13.6.1.3">
<h4><span class="header-section-number">13.6.1.3</span> Pruebas de Aleatoriedad basadas en distancias<a href="análisis-de-datos-funcionales.html#pruebas-de-aleatoriedad-basadas-en-distancias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El análisis de aleatoriedad permite identificar si los datos de se distribuyen aleatoriamente y visualizar e identificar áreas de alta y baja densidad, mostrando si están agrupados y dónde. Sin embargo, también existen algunos mmétodos basados en distancias que permiten cuantificar las propiedades de segundo orden de los datos, es decir, la influencia que de acuerdo con la ubicación tiene unos datos sobre otros.</p>
<p>Las medidas basadas en la distancia analizan la distribución espacial de los puntos usando distancias entre pares de puntos, y la mayoría usa la distancia euclidiana, para determinar cuantitativamente si los datos están, nuevamente, distribuidos al azar o muestran signos de agrupamiento o dispersión.</p>
<p>Estos métodos son una alternativa más rigurosa al uso del enfoque de análisis de cuadrantes y permiten evaluar el agrupamiento dentro del conjunto de datos puntuales tanto a escala global como local.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="análisis-de-datos-funcionales.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co">#=================================================================</span></span>
<span id="cb623-2"><a href="análisis-de-datos-funcionales.html#cb623-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráficas de las funciones de distribución empíricas G-hat y F-hat</span></span>
<span id="cb623-3"><a href="análisis-de-datos-funcionales.html#cb623-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=================================================================</span></span>
<span id="cb623-4"><a href="análisis-de-datos-funcionales.html#cb623-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sismos<span class="sc">$</span>x)</span>
<span id="cb623-5"><a href="análisis-de-datos-funcionales.html#cb623-5" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb623-6"><a href="análisis-de-datos-funcionales.html#cb623-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb623-7"><a href="análisis-de-datos-funcionales.html#cb623-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-8"><a href="análisis-de-datos-funcionales.html#cb623-8" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb623-9"><a href="análisis-de-datos-funcionales.html#cb623-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Para calcular la función G</span></span>
<span id="cb623-10"><a href="análisis-de-datos-funcionales.html#cb623-10" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb623-11"><a href="análisis-de-datos-funcionales.html#cb623-11" aria-hidden="true" tabindex="-1"></a>sismos.ghat <span class="ot">&lt;-</span> <span class="fu">Gest</span>(sismos)</span>
<span id="cb623-12"><a href="análisis-de-datos-funcionales.html#cb623-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos.ghat,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Ghat(r)&quot;</span>)</span>
<span id="cb623-13"><a href="análisis-de-datos-funcionales.html#cb623-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-14"><a href="análisis-de-datos-funcionales.html#cb623-14" aria-hidden="true" tabindex="-1"></a>Genv<span class="ot">&lt;-</span><span class="fu">envelope</span>(sismos,<span class="at">fun=</span><span class="st">&quot;Gest&quot;</span>,<span class="at">nsim=</span><span class="dv">999</span>,<span class="at">nrank=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Generating 999 simulations of CSR  ...
## 1, 2, 3, ......10.........20.........30.........40.........50.........60.........70.........80.........90.........
## 100.........110.........120.........130.........140.........150.........160.........170.........180.........190........
## .200.........210.........220.........230.........240.........250.........260.........270.........280.........290.......
## ..300.........310.........320.........330.........340.........350.........360.........370.........380.........390......
## ...400.........410.........420.........430.........440.........450.........460.........470.........480.........490.....
## ....500.........510.........520.........530.........540.........550.........560.........570.........580.........590....
## .....600.........610.........620.........630.........640.........650.........660.........670.........680.........690...
## ......700.........710.........720.........730.........740.........750.........760.........770.........780.........790..
## .......800.........810.........820.........830.........840.........850.........860.........870.........880.........890.
## ........900.........910.........920.........930.........940.........950.........960.........970.........980.........990
## ........ 999.
## 
## Done.</code></pre>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="análisis-de-datos-funcionales.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Genv,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Ghat(r)&quot;</span>,<span class="at">cex.lab=</span><span class="fl">1.6</span>,<span class="at">cex.axis=</span><span class="fl">1.5</span>,<span class="at">main=</span><span class="st">&quot;G-Hat&quot;</span>,<span class="at">cex.main=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars44-1.png" width="672" /></p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="análisis-de-datos-funcionales.html#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test Hopkins-Skellam</span></span>
<span id="cb626-2"><a href="análisis-de-datos-funcionales.html#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ho: El patrón espacial es completamente aleatorizado</span></span>
<span id="cb626-3"><a href="análisis-de-datos-funcionales.html#cb626-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Ha: El patrón espacial no es completamente aleatorizado</span></span>
<span id="cb626-4"><a href="análisis-de-datos-funcionales.html#cb626-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Nivel de significancia (alpha=0.05)</span></span>
<span id="cb626-5"><a href="análisis-de-datos-funcionales.html#cb626-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-6"><a href="análisis-de-datos-funcionales.html#cb626-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hopskel.test</span>(sismos, <span class="at">method =</span> <span class="st">&quot;MonteCarlo&quot;</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
##  Hopkins-Skellam test of CSR
##  Monte Carlo test based on 999 simulations of CSR with fixed n
## 
## data:  sismos
## A = 0.0018746, p-value = 0.002
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="análisis-de-datos-funcionales.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb628-2"><a href="análisis-de-datos-funcionales.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Para calcular la función F</span></span>
<span id="cb628-3"><a href="análisis-de-datos-funcionales.html#cb628-3" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb628-4"><a href="análisis-de-datos-funcionales.html#cb628-4" aria-hidden="true" tabindex="-1"></a>sismos.fhat <span class="ot">&lt;-</span> <span class="fu">Fest</span>(sismos)    </span>
<span id="cb628-5"><a href="análisis-de-datos-funcionales.html#cb628-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos.fhat,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Fhat(r)&quot;</span>)</span>
<span id="cb628-6"><a href="análisis-de-datos-funcionales.html#cb628-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-7"><a href="análisis-de-datos-funcionales.html#cb628-7" aria-hidden="true" tabindex="-1"></a>Fenv<span class="ot">&lt;-</span><span class="fu">envelope</span>(sismos,<span class="at">fun=</span><span class="st">&quot;Fest&quot;</span>,<span class="at">nsim=</span><span class="dv">999</span>,<span class="at">nrank=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Generating 999 simulations of CSR  ...
## 1, 2, 3, ......10.........20.........30.........40.........50.........60.........70.........80.........90.........
## 100.........110.........120.........130.........140.........150.........160.........170.........180.........190........
## .200.........210.........220.........230.........240.........250.........260.........270.........280.........290.......
## ..300.........310.........320.........330.........340.........350.........360.........370.........380.........390......
## ...400.........410.........420.........430.........440.........450.........460.........470.........480.........490.....
## ....500.........510.........520.........530.........540.........550.........560.........570.........580.........590....
## .....600.........610.........620.........630.........640.........650.........660.........670.........680.........690...
## ......700.........710.........720.........730.........740.........750.........760.........770.........780.........790..
## .......800.........810.........820.........830.........840.........850.........860.........870.........880.........890.
## ........900.........910.........920.........930.........940.........950.........960.........970.........980.........990
## ........ 999.
## 
## Done.</code></pre>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="análisis-de-datos-funcionales.html#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Fenv,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Fhat(r)&quot;</span>,<span class="at">cex.lab=</span><span class="fl">1.6</span>,<span class="at">cex.axis=</span><span class="fl">1.5</span>,<span class="at">main=</span><span class="st">&quot;F-Hat&quot;</span>,<span class="at">cex.main=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars44-2.png" width="672" /></p>
<div id="funciones-de-ripley" class="section level5 hasAnchor" number="13.6.1.3.1">
<h5><span class="header-section-number">13.6.1.3.1</span> Funciones de Ripley<a href="análisis-de-datos-funcionales.html#funciones-de-ripley" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>La función K de Ripley analiza la distancia entre un punto y “todas las distancias” a otros puntos y la compara automáticamente con un patrón de puntos de distribución de Poisson. Esta función esencialmente resume la distancia entre puntos para todas las distancias usando bandas de distancia radial. El cálculo es relativamente sencillo:</p>
<ol style="list-style-type: decimal">
<li>Para el evento de punto A, cuente el número de puntos dentro de un búfer (radio) de cierto tamaño. Luego cuente el número de puntos dentro de un búfer (radio) un poco más grande.</li>
<li>Repita esto para cada evento de punto en el conjunto de datos.</li>
<li>Calcule el número medio de puntos en cada zona de influencia (radio) y divídalo por la densidad total de puntos.</li>
<li>Repita esto utilizando puntos extraídos de un modelo aleatorio de Poisson para el mismo conjunto de zonas de influencia.</li>
<li>Compare la distribución observada con la distribución con la distribución de Poisson.</li>
</ol>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="análisis-de-datos-funcionales.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co">#=================================================================</span></span>
<span id="cb631-2"><a href="análisis-de-datos-funcionales.html#cb631-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráficas de las funciones K y L de Ripley </span></span>
<span id="cb631-3"><a href="análisis-de-datos-funcionales.html#cb631-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=================================================================</span></span>
<span id="cb631-4"><a href="análisis-de-datos-funcionales.html#cb631-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-5"><a href="análisis-de-datos-funcionales.html#cb631-5" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb631-6"><a href="análisis-de-datos-funcionales.html#cb631-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Para calcular la función K</span></span>
<span id="cb631-7"><a href="análisis-de-datos-funcionales.html#cb631-7" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb631-8"><a href="análisis-de-datos-funcionales.html#cb631-8" aria-hidden="true" tabindex="-1"></a>sismos.khat <span class="ot">&lt;-</span> <span class="fu">Kest</span>(sismos)</span>
<span id="cb631-9"><a href="análisis-de-datos-funcionales.html#cb631-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos.khat<span class="sc">$</span>r,sismos.khat<span class="sc">$</span>iso,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Ripley&#39;s K&quot;</span>)</span>
<span id="cb631-10"><a href="análisis-de-datos-funcionales.html#cb631-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(sismos.khat<span class="sc">$</span>r,sismos.khat<span class="sc">$</span>theo,<span class="at">lty=</span><span class="dv">8</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars45-1.png" width="672" /></p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="análisis-de-datos-funcionales.html#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb632-2"><a href="análisis-de-datos-funcionales.html#cb632-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Para calcular la función L</span></span>
<span id="cb632-3"><a href="análisis-de-datos-funcionales.html#cb632-3" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb632-4"><a href="análisis-de-datos-funcionales.html#cb632-4" aria-hidden="true" tabindex="-1"></a>sismos.lhat <span class="ot">&lt;-</span> <span class="fu">Lest</span>(sismos)</span>
<span id="cb632-5"><a href="análisis-de-datos-funcionales.html#cb632-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sismos.lhat<span class="sc">$</span>r,sismos.lhat<span class="sc">$</span>iso,<span class="at">xlab=</span><span class="st">&quot;r&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Ripley&#39;s L&quot;</span>)</span>
<span id="cb632-6"><a href="análisis-de-datos-funcionales.html#cb632-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(sismos.lhat<span class="sc">$</span>r,sismos.lhat<span class="sc">$</span>theo,<span class="at">lty=</span><span class="dv">8</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars45-2.png" width="672" /></p>
</div>
</div>
<div id="estimación-de-la-intensidad" class="section level4 hasAnchor" number="13.6.1.4">
<h4><span class="header-section-number">13.6.1.4</span> Estimación de la intensidad<a href="análisis-de-datos-funcionales.html#estimación-de-la-intensidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Las técnicas basadas en la densidad se utilizan para caracterizar el patrón de un conjunto de datos utilizando su distribución general.Es posible calcular densidades tanto a escala global como local. Sin embargo, en el análisis de patrones puntuales, la densidad global realmente no dice mucho sobre la distribución de los datos, en términos de áreas de alta y baja densidad, por ejemplo.</p>
<p>Aquí es donde las técnicas de densidad local, como la estimación de la densidad y la intensidad, pueden ayudar a visualizar estas diferencias en la distribución de los datos.Dentro del análisis espacial, la estimación de la densidad produce una superficie (ráster) que detalla la distribución estimada de los datos en el espacio. Cada celda dentro del ráster contiene un valor que corresponde con la densidad estimada en esa ubicación; cuando se visualiza en su totalidad el ráster completo, se puede identificar rápidamente áreas de alta y baja densidad, es decir, dónde están ubicados los grupos en el conjunto de datos.</p>
<p>Un kernel define la forma y el tamaño de la ventana y también puede ponderar los puntos, utilizando una función de kernel definida (Gimond, 2020). La función kernel más simple es un kernel básico donde a cada punto de la ventana del kernel se le asigna el mismo peso. La superficie resultante se crea a partir de estos valores de densidad calculados localmente de forma individual.</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="análisis-de-datos-funcionales.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co">#==========================================================================</span></span>
<span id="cb633-2"><a href="análisis-de-datos-funcionales.html#cb633-2" aria-hidden="true" tabindex="-1"></a><span class="do">########################Estimación de la intensidad########################</span></span>
<span id="cb633-3"><a href="análisis-de-datos-funcionales.html#cb633-3" aria-hidden="true" tabindex="-1"></a><span class="co">#==========================================================================</span></span>
<span id="cb633-4"><a href="análisis-de-datos-funcionales.html#cb633-4" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb633-5"><a href="análisis-de-datos-funcionales.html#cb633-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Por medio de kernel Gaussiano</span></span>
<span id="cb633-6"><a href="análisis-de-datos-funcionales.html#cb633-6" aria-hidden="true" tabindex="-1"></a><span class="co">#================================================</span></span>
<span id="cb633-7"><a href="análisis-de-datos-funcionales.html#cb633-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Ancho de banda ideal (mínimo mse)</span></span>
<span id="cb633-8"><a href="análisis-de-datos-funcionales.html#cb633-8" aria-hidden="true" tabindex="-1"></a>banda <span class="ot">&lt;-</span> <span class="fl">18939.72936</span></span>
<span id="cb633-9"><a href="análisis-de-datos-funcionales.html#cb633-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-10"><a href="análisis-de-datos-funcionales.html#cb633-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-11"><a href="análisis-de-datos-funcionales.html#cb633-11" aria-hidden="true" tabindex="-1"></a>dengaus<span class="ot">=</span><span class="fu">density</span>(sismos,<span class="at">kernel=</span><span class="st">&quot;gaussian&quot;</span>, <span class="at">bw =</span> banda)</span>
<span id="cb633-12"><a href="análisis-de-datos-funcionales.html#cb633-12" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb633-13"><a href="análisis-de-datos-funcionales.html#cb633-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dengaus)</span>
<span id="cb633-14"><a href="análisis-de-datos-funcionales.html#cb633-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb633-15"><a href="análisis-de-datos-funcionales.html#cb633-15" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(dengaus, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-1.png" width="672" /></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="análisis-de-datos-funcionales.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb634-2"><a href="análisis-de-datos-funcionales.html#cb634-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dengaus)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-2.png" width="672" /></p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="análisis-de-datos-funcionales.html#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(dengaus)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-3.png" width="672" /></p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="análisis-de-datos-funcionales.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb636-2"><a href="análisis-de-datos-funcionales.html#cb636-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(dengaus)</span>
<span id="cb636-3"><a href="análisis-de-datos-funcionales.html#cb636-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-4.png" width="672" /></p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="análisis-de-datos-funcionales.html#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Marcas según la intensidad del sismo</span></span>
<span id="cb637-2"><a href="análisis-de-datos-funcionales.html#cb637-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Menor a 3.5 en la escala de Richter</span></span>
<span id="cb637-3"><a href="análisis-de-datos-funcionales.html#cb637-3" aria-hidden="true" tabindex="-1"></a><span class="co">#y entre 3.5 y 5.5 en la escala de Richter</span></span>
<span id="cb637-4"><a href="análisis-de-datos-funcionales.html#cb637-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-5"><a href="análisis-de-datos-funcionales.html#cb637-5" aria-hidden="true" tabindex="-1"></a>Datos1<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data_11_PatronesPuntuales/6_PatronesPuntuales/Datos/Datos_Sismos_2009_1.txt&quot;</span>,<span class="at">dec=</span><span class="st">&quot;,&quot;</span>,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb637-6"><a href="análisis-de-datos-funcionales.html#cb637-6" aria-hidden="true" tabindex="-1"></a>sismos1<span class="ot">=</span><span class="fu">ppp</span>(Datos1<span class="sc">$</span>X,Datos1<span class="sc">$</span>Y,<span class="at">marks=</span>Datos1<span class="sc">$</span>Marcas,<span class="at">window=</span><span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">450433</span>,<span class="dv">1806815</span>),<span class="fu">c</span>(<span class="fl">22875.5</span>,<span class="fl">1870870.5</span>)))</span>
<span id="cb637-7"><a href="análisis-de-datos-funcionales.html#cb637-7" aria-hidden="true" tabindex="-1"></a>Datos1<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Datos1<span class="sc">$</span>Marcas)</span>
<span id="cb637-8"><a href="análisis-de-datos-funcionales.html#cb637-8" aria-hidden="true" tabindex="-1"></a>mpp<span class="ot">=</span><span class="fu">ppp</span>(Datos1<span class="sc">$</span>X,Datos1<span class="sc">$</span>Y,<span class="at">marks=</span>Datos1<span class="sc">$</span>cat,<span class="at">window=</span><span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">450433</span>,<span class="dv">1806815</span>),<span class="fu">c</span>(<span class="fl">22875.5</span>,<span class="fl">1870870.5</span>)))</span>
<span id="cb637-9"><a href="análisis-de-datos-funcionales.html#cb637-9" aria-hidden="true" tabindex="-1"></a>spp <span class="ot">&lt;-</span> <span class="fu">split</span>(mpp)</span>
<span id="cb637-10"><a href="análisis-de-datos-funcionales.html#cb637-10" aria-hidden="true" tabindex="-1"></a>dengaus1<span class="ot">=</span><span class="fu">density</span>(spp[<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>],<span class="at">kernel=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb637-11"><a href="análisis-de-datos-funcionales.html#cb637-11" aria-hidden="true" tabindex="-1"></a>dengaus2<span class="ot">=</span><span class="fu">density</span>(spp[<span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>],<span class="at">kernel=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb637-12"><a href="análisis-de-datos-funcionales.html#cb637-12" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb637-13"><a href="análisis-de-datos-funcionales.html#cb637-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dengaus1)</span>
<span id="cb637-14"><a href="análisis-de-datos-funcionales.html#cb637-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-5.png" width="672" /></p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="análisis-de-datos-funcionales.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dengaus2)</span>
<span id="cb638-2"><a href="análisis-de-datos-funcionales.html#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(S,<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cars46-6.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ilustración-del-kriging-simple-espacio-tiempo-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/edit/master/11-PatronesPuntuales.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/blob/master/11-PatronesPuntuales.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
