<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 4 Kriging | Cuadernos Estadística Espacial</title>
  <meta name="description" content="Capítulo 4 Kriging | Cuadernos Estadística Espacial" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 4 Kriging | Cuadernos Estadística Espacial" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 4 Kriging | Cuadernos Estadística Espacial" />
  
  
  

<meta name="author" content="Martha Bohorquez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="geoestadística-univariada-con-geor.html"/>
<link rel="next" href="simulación-to-do.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cuadernos R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#indice"><i class="fa fa-check"></i><b>1.1</b> Indice</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html"><i class="fa fa-check"></i><b>2</b> Geoestadística con <code>sgeostat</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#data-load"><i class="fa fa-check"></i><b>2.1</b> Data Load</a></li>
<li class="chapter" data-level="2.2" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#libraries"><i class="fa fa-check"></i><b>2.2</b> Libraries</a></li>
<li class="chapter" data-level="2.3" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#including-plots"><i class="fa fa-check"></i><b>2.3</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html"><i class="fa fa-check"></i><b>3</b> Geoestadística univariada con <code>geoR</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#parte-descriptiva"><i class="fa fa-check"></i><b>3.1</b> Parte descriptiva</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#librerías"><i class="fa fa-check"></i><b>3.1.1</b> Librerías</a></li>
<li class="chapter" data-level="3.1.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#lectura-de-datos"><i class="fa fa-check"></i><b>3.1.2</b> Lectura de datos</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#geo_data"><i class="fa fa-check"></i><b>3.2</b> GEO_Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#convertir-aquifer-a-un-objeto-geodata-geor-obj"><i class="fa fa-check"></i><b>3.2.1</b> Convertir aquifer a un objeto geodata (geoR obj)</a></li>
<li class="chapter" data-level="3.2.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráfico-de-objeto-geodata"><i class="fa fa-check"></i><b>3.2.2</b> Gráfico de objeto geodata</a></li>
<li class="chapter" data-level="3.2.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráficos-descriptivos-interpolación"><i class="fa fa-check"></i><b>3.2.3</b> Gráficos descriptivos interpolación</a></li>
<li class="chapter" data-level="3.2.4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráficos-de-contorno"><i class="fa fa-check"></i><b>3.2.4</b> Gráficos de contorno</a></li>
<li class="chapter" data-level="3.2.5" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#funciones-y-gráficas-a-partir-de-la-función-outer"><i class="fa fa-check"></i><b>3.2.5</b> Funciones y gráficas a partir de la función outer</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#modelando-la-media-con-regresión-polinomial"><i class="fa fa-check"></i><b>3.3</b> Modelando la media con regresión polinomial</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#primer-modelo"><i class="fa fa-check"></i><b>3.3.1</b> Primer modelo</a></li>
<li class="chapter" data-level="3.3.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#segundo-modelo"><i class="fa fa-check"></i><b>3.3.2</b> Segundo modelo</a></li>
<li class="chapter" data-level="3.3.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#tercer-modelo"><i class="fa fa-check"></i><b>3.3.3</b> Tercer modelo</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#estimación-del-semivariograma-empírico"><i class="fa fa-check"></i><b>3.4</b> Estimación del semivariograma empírico</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-estimación-clásica-removiendo-tendencia"><i class="fa fa-check"></i><b>3.4.1</b> Explorando estimación clásica, removiendo tendencia</a></li>
<li class="chapter" data-level="3.4.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-estimación-resistente-a-datos-atípicos-y-removiendo-tendencia"><i class="fa fa-check"></i><b>3.4.2</b> Explorando estimación resistente a datos atípicos y removiendo tendencia</a></li>
<li class="chapter" data-level="3.4.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-anisotropía"><i class="fa fa-check"></i><b>3.4.3</b> Explorando anisotropía</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#estimación-teórica-del-semivariograma"><i class="fa fa-check"></i><b>3.5</b> Estimación teórica del semivariograma</a></li>
<li class="chapter" data-level="3.6" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#resultados"><i class="fa fa-check"></i><b>3.6</b> Resultados</a></li>
<li class="chapter" data-level="3.7" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#pulimiento-de-medianas"><i class="fa fa-check"></i><b>3.7</b> Pulimiento de medianas</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#cargar-librerias"><i class="fa fa-check"></i><b>3.7.1</b> Cargar librerias</a></li>
<li class="chapter" data-level="3.7.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#grilla-de-las-ubicaciones-espaciales."><i class="fa fa-check"></i><b>3.7.2</b> Grilla de las ubicaciones espaciales.</a></li>
<li class="chapter" data-level="3.7.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#definición-de-objeto-vgm"><i class="fa fa-check"></i><b>3.7.3</b> Definición de objeto VGM</a></li>
<li class="chapter" data-level="3.7.4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#matriz-de-varianza-dadas-coordenadas."><i class="fa fa-check"></i><b>3.7.4</b> Matriz de varianza dadas coordenadas.</a></li>
<li class="chapter" data-level="3.7.5" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#simulación."><i class="fa fa-check"></i><b>3.7.5</b> Simulación.</a></li>
<li class="chapter" data-level="3.7.6" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#pulimiento-de-medianas-1"><i class="fa fa-check"></i><b>3.7.6</b> Pulimiento de medianas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="kriging.html"><a href="kriging.html"><i class="fa fa-check"></i><b>4</b> Kriging</a>
<ul>
<li class="chapter" data-level="4.1" data-path="kriging.html"><a href="kriging.html#introducción-kriging"><i class="fa fa-check"></i><b>4.1</b> Introducción Kriging</a></li>
<li class="chapter" data-level="4.2" data-path="kriging.html"><a href="kriging.html#kriging-simple"><i class="fa fa-check"></i><b>4.2</b> Kriging Simple</a></li>
<li class="chapter" data-level="4.3" data-path="kriging.html"><a href="kriging.html#kriging-ordinario"><i class="fa fa-check"></i><b>4.3</b> Kriging Ordinario</a></li>
<li class="chapter" data-level="4.4" data-path="kriging.html"><a href="kriging.html#kriging-universal"><i class="fa fa-check"></i><b>4.4</b> Kriging Universal</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulación-to-do.html"><a href="simulación-to-do.html"><i class="fa fa-check"></i><b>5</b> Simulación (TO-DO)</a></li>
<li class="chapter" data-level="6" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html"><i class="fa fa-check"></i><b>6</b> Modelos de regresión espacial</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#estudio-de-mercadeo"><i class="fa fa-check"></i><b>6.1</b> Estudio de Mercadeo</a></li>
<li class="chapter" data-level="6.2" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#paquetes"><i class="fa fa-check"></i><b>6.2</b> Paquetes</a></li>
<li class="chapter" data-level="6.3" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#lectura-de-datos-1"><i class="fa fa-check"></i><b>6.3</b> Lectura de Datos</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#cruce-de-información-y-arreglo-de-coordenadas"><i class="fa fa-check"></i><b>6.3.1</b> Cruce de información y arreglo de coordenadas</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#matriz-de-vecindades"><i class="fa fa-check"></i><b>6.4</b> Matriz de vecindades</a></li>
<li class="chapter" data-level="6.5" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#mapa-de-valores-observados"><i class="fa fa-check"></i><b>6.5</b> Mapa de valores observados</a></li>
<li class="chapter" data-level="6.6" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#pruebas-de-autocorrelación"><i class="fa fa-check"></i><b>6.6</b> Pruebas de Autocorrelación</a></li>
<li class="chapter" data-level="6.7" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#mapas"><i class="fa fa-check"></i><b>6.7</b> Mapas</a></li>
<li class="chapter" data-level="6.8" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#resumen-de-modelos"><i class="fa fa-check"></i><b>6.8</b> Resumen de modelos</a></li>
<li class="chapter" data-level="6.9" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#calculo-de-varibles-significativas"><i class="fa fa-check"></i><b>6.9</b> Calculo de varibles significativas</a></li>
<li class="chapter" data-level="6.10" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#mapa-estimado"><i class="fa fa-check"></i><b>6.10</b> Mapa Estimado</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html"><i class="fa fa-check"></i><b>7</b> Spatial modeling leukemia</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#mortality"><i class="fa fa-check"></i><b>7.1</b> <strong>Mortality</strong></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-mortality"><i class="fa fa-check"></i><b>7.1.1</b> <em>Packages Mortality</em></a></li>
<li class="chapter" data-level="7.1.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-mortality"><i class="fa fa-check"></i><b>7.1.2</b> <em>Code Mortality</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#incidence"><i class="fa fa-check"></i><b>7.2</b> Incidence</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-incidence"><i class="fa fa-check"></i><b>7.2.1</b> <strong>Packages Incidence</strong></a></li>
<li class="chapter" data-level="7.2.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-incidence"><i class="fa fa-check"></i><b>7.2.2</b> <em>Code Incidence</em></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cuadernos Estadística Espacial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="kriging" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capítulo 4</span> Kriging<a href="kriging.html#kriging" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Kriging es una técnica de interpolación espacial que permite estimar valores desconocidos en una superficie a partir de los valores conocidos en ubicaciones cercanas. Es especialmente útil para datos de alta densidad y para datos con estructuras espaciales complejas. En este cuaderno, vamos a explorar los diferentes tipos de Kriging y cómo implementarlos en R.</p>
<p>Antes de comenzar, asegúrate de tener instalados los siguientes paquetes de R: “gstat”, “sp”, “raster” y “ggplot2”. Si no los tienes, puedes instalarlos mediante el siguiente código:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="kriging.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(c(&quot;gstat&quot;, &quot;sp&quot;, &quot;raster&quot;, &quot;ggplot2&quot;, &quot;phylin&quot;))</span></span></code></pre></div>
<div id="introducción-kriging" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Introducción Kriging<a href="kriging.html#introducción-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Kriging es una técnica de interpolación espacial que se basa en la teoría de la estadística espacial. La idea fundamental detrás de Kriging es que la estimación del valor desconocido en una ubicación dada se hace como una combinación lineal ponderada de los valores conocidos en las ubicaciones vecinas. Los pesos de esta combinación se determinan utilizando la información de covarianza entre los puntos en el espacio. Esta técnica se utiliza comúnmente en estadística espacial, geología, minería, geofísica, oceanografía y otros campos que involucran la toma de medidas en lugares dispersos en el espacio.</p>
<p>El nombre “Kriging” proviene del geólogo Danie G. Krige, quien fue el primero en aplicar esta técnica para la exploración de minerales en Sudáfrica en la década de 1950</p>
</div>
<div id="kriging-simple" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Kriging Simple<a href="kriging.html#kriging-simple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección se explica el método de kriging simple, que es una técnica de interpolación espacial que utiliza una función de tendencia conocida y un modelo de variograma ajustado a los datos. El objetivo es estimar el valor de una variable Z en una ubicación s0 a partir de los valores observados en n ubicaciones si cercanas. El kriging simple asume que la variable Z se puede descomponer como:</p>
<p><span class="math display">\[Z(s) = μ(s) + ε(s),\]</span></p>
<p>donde <span class="math inline">\(μ(s)\)</span> es la función de tendencia conocida y <span class="math inline">\(ε(s)\)</span> es un proceso espacial aleatorio con media cero y covarianza <span class="math inline">\(C(s_i,s_j) = Cov(ε(s_i),ε(s_j))\)</span>. El predictor del kriging simple es una combinación lineal de los valores observados:</p>
<p><span class="math display">\[p(Z,s_0) = μ(s_0) + ∑_{i=1}^n λ_i (Z(s_i) - μ(s_i)),\]</span></p>
<p>donde los pesos <span class="math inline">\(λ_i\)</span> se obtienen resolviendo el sistema de ecuaciones:</p>
<p><span class="math display">\[∑_{j=1}^n λ_j C(s_i,s_j) - C(s_i,s_0) = 0, \  i = 1,...,n.\]</span></p>
<p>El kriging simple minimiza el error cuadrático medio entre el valor estimado y el verdadero, que se denomina varianza kriging y se calcula como:</p>
<p><span class="math display">\[σ^2 KS(s_0) = C(s_0,s_0) - ∑_{i=1}^n ∑_{j=1}^n λ_i λ_j C(s_i,s_j).\]</span></p>
<p>Para implementar el kriging simple en R se puede utilizar la función krig del paquete phylin, que requiere como argumentos los valores observados, las coordenadas de las ubicaciones muestreadas y las ubicaciones a interpolar, el modelo de variograma ajustado y el valor conocido de la media (o NA para usar kriging ordinario). A continuación se muestra un ejemplo con datos simulados:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="kriging.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To-Do</span></span></code></pre></div>
</div>
<div id="kriging-ordinario" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Kriging Ordinario<a href="kriging.html#kriging-ordinario" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El kriging ordinario es el tipo más general y más utilizado de kriging. Presupone que el valor medio constante es desconocido y lo estima a partir de los datos disponibles. Esta es una suposición razonable a menos que haya una razón científica para rechazarla.</p>
<p>El kriging ordinario se puede expresar como:</p>
<p><span class="math display">\[Z^*(x_0) = \sum_{i=1}^n \lambda_i Z(x_i)\]</span></p>
<p>Donde <span class="math inline">\(Z^*(x_0)\)</span> es el valor estimado en el punto <span class="math inline">\(x_0\)</span>, <span class="math inline">\(Z(x_i)\)</span> son los valores medidos en los puntos <span class="math inline">\(x_i\)</span>, <span class="math inline">\(n\)</span> es el número de puntos medidos y <span class="math inline">\(\lambda_i\)</span> son los pesos óptimos que minimizan la varianza del error de estimación.</p>
<p>Los pesos óptimos se obtienen resolviendo un sistema de ecuaciones lineales conocido como sistema krigiano:</p>
<p><span class="math display">\[
\begin{bmatrix}
\gamma_{11} &amp; \gamma_{12} &amp; \cdots &amp; \gamma_{1n} &amp; 1 \\
\gamma_{21} &amp; \gamma_{22} &amp; \cdots &amp; \gamma_{2n} &amp; 1 \\
\vdots      &amp; \vdots      &amp; \ddots &amp; \vdots      &amp; 1 \\
\gamma_{n1} &amp; \gamma_{n2} &amp; \cdots &amp; \gamma_{nn} &amp; 1 \\
1           &amp; 1           &amp; \cdots &amp; 1           &amp; 0
\end{bmatrix}
\begin{bmatrix}
\lambda_1 \\
\lambda_2 \\
\vdots    \\
\lambda_n \\
m
\end{bmatrix}
=
\begin{bmatrix}
\gamma(x_0,x_1) \\
\gamma(x_0,x_2) \\
\vdots          \\
\gamma(x_0,x_n) \\
-1
\end{bmatrix}
\]</span></p>
<p>Donde <span class="math inline">\(\gamma_{ij}\)</span> son los semivariogramas entre los puntos medidos, <span class="math inline">\(\gamma(x_0,x_i)\)</span> son los semivariogramas entre el punto a estimar y los puntos medidos y <span class="math inline">\(m\)</span> es un multiplicador lagrangeano que representa la estimación del valor medio constante.</p>
<p>Para implementar el kriging ordinario en R, se pueden utilizar las librerías “gstat” o “kriging”. A continuación se muestra un ejemplo usando la librería “gstat”.</p>
</div>
<div id="kriging-universal" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Kriging Universal<a href="kriging.html#kriging-universal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El kriging universal es una variante del kriging que permite incorporar variables auxiliares que influyen en la variable de interés. Por ejemplo, si queremos interpolar la temperatura en una región, podemos usar como variables auxiliares la altitud, la latitud o la distancia al mar. El kriging universal asume que la variable de interés se puede expresar como una combinación lineal de las variables auxiliares más un error espacialmente correlacionado. Es decir:</p>
<p><span class="math display">\[
Z(s) = p ∑_{j=0} X_j(s)β_j +ε(s),
\]</span></p>
<p>donde <span class="math inline">\(Z(s)\)</span> es la variable de interés en el punto <span class="math inline">\(s\)</span>, <span class="math inline">\(X_j(s)\)</span> son las variables auxiliares (incluyendo una constante), βj son los coeficientes desconocidos y ε(s) es el error espacial con variograma conocido.</p>
<p>Para estimar <span class="math inline">\(Z(s_0)\)</span> en un punto no observado <span class="math inline">\(s_0\)</span>, se usa el predictor del kriging universal:</p>
<p><span class="math display">\[
p(Z,s_0) = ∑_{i=1}^n λ_iZ(s_i),
\]</span></p>
<p>donde <span class="math inline">\(λ_i\)</span> son los pesos que minimizan el error cuadrático medio de predicción sujeto a las restricciones:</p>
<p><span class="math display">\[λ^⊤X = x^⊤ 0,\]</span></p>
<p>donde <span class="math inline">\(X\)</span> es una matriz con las variables auxiliares en los puntos observados y <span class="math inline">\(x_0\)</span> es un vector con las variables auxiliares en el punto <span class="math inline">\(s_0\)</span>.</p>
<p>Para implementar el kriging universal en R, podemos usar el paquete gstat y la función krige. Esta función requiere una fórmula que defina la variable dependiente como un modelo lineal de las variables independientes, un objeto espacial con las coordenadas y los datos observados, un objeto espacial con las coordenadas de los puntos a predecir y un modelo de variograma para el error espacial.</p>
<p>A continuación se muestra un ejemplo de cómo usar krige para realizar kriging universal con dos variables auxiliares: <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geoestadística-univariada-con-geor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulación-to-do.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/edit/master/04-OtrosTiposDeKriging.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/blob/master/04-OtrosTiposDeKriging.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
