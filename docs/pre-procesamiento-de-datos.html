<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Pre-procesamiento de datos | Cokriging</title>
  <meta name="description" content="Chapter 4 Pre-procesamiento de datos | Cokriging" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Pre-procesamiento de datos | Cokriging" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Pre-procesamiento de datos | Cokriging" />
  
  
  

<meta name="author" content="…." />


<meta name="date" content="2022-11-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-de-regresión-espacial.html"/>
<link rel="next" href="ilustración-del-kriging-simple-espacio-tiempo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cuadernos R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Simulación Proceso Espacio Temporal</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#funciones"><i class="fa fa-check"></i><b>1.1</b> Funciones</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#ch-1-no-separable"><i class="fa fa-check"></i><b>1.2</b> CH 1 no separable</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#ch3-no-separable"><i class="fa fa-check"></i><b>1.3</b> CH3 no separable</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ch-4"><i class="fa fa-check"></i><b>1.4</b> CH 4</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html"><i class="fa fa-check"></i><b>2</b> Spatial modeling leukemia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#mortality"><i class="fa fa-check"></i><b>2.1</b> <strong>Mortality</strong></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-mortality"><i class="fa fa-check"></i><b>2.1.1</b> <em>Packages Mortality</em></a></li>
<li class="chapter" data-level="2.1.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-mortality"><i class="fa fa-check"></i><b>2.1.2</b> <em>Code Mortality</em></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#incidence"><i class="fa fa-check"></i><b>2.2</b> Incidence</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-incidence"><i class="fa fa-check"></i><b>2.2.1</b> <strong>Packages Incidence</strong></a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-incidence"><i class="fa fa-check"></i><b>2.2.2</b> <em>Code Incidence</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html"><i class="fa fa-check"></i><b>3</b> Modelos de regresión espacial</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#estudio-de-mercadeo"><i class="fa fa-check"></i><b>3.1</b> Estudio de Mercadeo</a></li>
<li class="chapter" data-level="3.2" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#paquetes"><i class="fa fa-check"></i><b>3.2</b> Paquetes</a></li>
<li class="chapter" data-level="3.3" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#lectura-de-datos"><i class="fa fa-check"></i><b>3.3</b> Lectura de Datos</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modelos-de-regresión-espacial.html"><a href="modelos-de-regresión-espacial.html#cruce-de-información-y-arreglo-de-coordenadas"><i class="fa fa-check"></i><b>3.3.1</b> Cruce de información y arreglo de coordenadas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html"><i class="fa fa-check"></i><b>4</b> Pre-procesamiento de datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#matriz-de-vecindades"><i class="fa fa-check"></i><b>4.1</b> Matriz de vecindades</a></li>
<li class="chapter" data-level="4.2" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapa-de-valores-observados"><i class="fa fa-check"></i><b>4.2</b> Mapa de valores observados</a></li>
<li class="chapter" data-level="4.3" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#pruebas-de-autocorrelación"><i class="fa fa-check"></i><b>4.3</b> Pruebas de Autocorrelación</a></li>
<li class="chapter" data-level="4.4" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapas"><i class="fa fa-check"></i><b>4.4</b> Mapas</a></li>
<li class="chapter" data-level="4.5" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#resumen-de-modelos"><i class="fa fa-check"></i><b>4.5</b> Resumen de modelos</a></li>
<li class="chapter" data-level="4.6" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#calculo-de-varibles-significativas"><i class="fa fa-check"></i><b>4.6</b> Calculo de varibles significativas</a></li>
<li class="chapter" data-level="4.7" data-path="pre-procesamiento-de-datos.html"><a href="pre-procesamiento-de-datos.html#mapa-estimado"><i class="fa fa-check"></i><b>4.7</b> Mapa Estimado</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html"><i class="fa fa-check"></i><b>5</b> Ilustración del kriging simple espacio tiempo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#librerías"><i class="fa fa-check"></i><b>5.1</b> librerías</a></li>
<li class="chapter" data-level="5.2" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#simulación-no-condicional-de-una-realización-de-un-campo-aleatorio-espacio-temporal-no-separable-usando-el-modelo-de-covarianza-cressie1"><i class="fa fa-check"></i><b>5.2</b> <strong>Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1</strong></a></li>
<li class="chapter" data-level="5.3" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#algunas-funciones-de-covarianza-espacio-temporal-no-separables"><i class="fa fa-check"></i><b>5.3</b> <strong>Algunas funciones de covarianza espacio temporal no separables</strong></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#c-r-e-s-s-i-e---h-u-a-n-g-1999"><i class="fa fa-check"></i><b>5.3.1</b> C R E S S I E - H U A N G (1999)</a></li>
<li class="chapter" data-level="5.3.2" data-path="ilustración-del-kriging-simple-espacio-tiempo.html"><a href="ilustración-del-kriging-simple-espacio-tiempo.html#gneiting-2002-combina-fun1-fun2-y-psi-en-gneiting"><i class="fa fa-check"></i><b>5.3.2</b> Gneiting (2002), combina fun1, fun2 y psi en Gneiting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html"><i class="fa fa-check"></i><b>6</b> Pulimiento de medianas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#cargar-librerias"><i class="fa fa-check"></i><b>6.1</b> Cargar librerias</a></li>
<li class="chapter" data-level="6.2" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#grilla-de-las-ubicaciones-espaciales."><i class="fa fa-check"></i><b>6.2</b> Grilla de las ubicaciones espaciales.</a></li>
<li class="chapter" data-level="6.3" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#definición-de-objeto-vgm"><i class="fa fa-check"></i><b>6.3</b> Definición de objeto VGM</a></li>
<li class="chapter" data-level="6.4" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#matriz-de-varianza-dadas-coordenadas."><i class="fa fa-check"></i><b>6.4</b> Matriz de varianza dadas coordenadas.</a></li>
<li class="chapter" data-level="6.5" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#simulación."><i class="fa fa-check"></i><b>6.5</b> Simulación.</a></li>
<li class="chapter" data-level="6.6" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#pulimiento-de-medianas-1"><i class="fa fa-check"></i><b>6.6</b> Pulimiento de medianas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html"><i class="fa fa-check"></i><b>7</b> Introducción proceso espacial bivariado</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#librerías-1"><i class="fa fa-check"></i><b>7.1</b> Librerías</a></li>
<li class="chapter" data-level="7.2" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#ubicaciones-en-este-caso-se-supone-que-ambos-procesos-están-observados-en-los-mismos-lugares"><i class="fa fa-check"></i><b>7.2</b> Ubicaciones: En este caso se supone que ambos procesos están observados en los mismos lugares</a></li>
<li class="chapter" data-level="7.3" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#modelo-lineal-de-coregionalización"><i class="fa fa-check"></i><b>7.3</b> Modelo lineal de coregionalización</a></li>
<li class="chapter" data-level="7.4" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#simulación-de-un-proceso-espacial-gaussiano-bivariado"><i class="fa fa-check"></i><b>7.4</b> Simulación de un proceso espacial Gaussiano bivariado</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html"><i class="fa fa-check"></i><b>8</b> Geoestadística con sgeostat</a>
<ul>
<li class="chapter" data-level="8.1" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#data-load"><i class="fa fa-check"></i><b>8.1</b> Data Load</a></li>
<li class="chapter" data-level="8.2" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#libraries"><i class="fa fa-check"></i><b>8.2</b> Libraries</a></li>
<li class="chapter" data-level="8.3" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#including-plots"><i class="fa fa-check"></i><b>8.3</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cokriging.html"><a href="cokriging.html"><i class="fa fa-check"></i><b>9</b> Cokriging</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cokriging.html"><a href="cokriging.html#librerías-2"><i class="fa fa-check"></i><b>9.1</b> Librerías</a></li>
<li class="chapter" data-level="9.2" data-path="cokriging.html"><a href="cokriging.html#descripción-de-los-datos"><i class="fa fa-check"></i><b>9.2</b> Descripción de los datos</a></li>
<li class="chapter" data-level="9.3" data-path="cokriging.html"><a href="cokriging.html#matrices-de-coregionalización."><i class="fa fa-check"></i><b>9.3</b> Matrices de coregionalización.</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cokriging.html"><a href="cokriging.html#matriz-definida-positiva-para-el-modelo-esférico."><i class="fa fa-check"></i><b>9.3.1</b> Matriz definida positiva para el modelo Esférico.</a></li>
<li class="chapter" data-level="9.3.2" data-path="cokriging.html"><a href="cokriging.html#matriz-definida-positiva-para-el-modelo-efecto-hueco."><i class="fa fa-check"></i><b>9.3.2</b> Matriz definida positiva para el modelo efecto Hueco.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="cokriging.html"><a href="cokriging.html#definición-de-objeto-en-gstat"><i class="fa fa-check"></i><b>9.4</b> Definición de objeto en gstat</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cokriging.html"><a href="cokriging.html#semivariogramas-univariados"><i class="fa fa-check"></i><b>9.4.1</b> Semivariogramas univariados</a></li>
<li class="chapter" data-level="9.4.2" data-path="cokriging.html"><a href="cokriging.html#semivarogramas-cruzados-bivariados"><i class="fa fa-check"></i><b>9.4.2</b> Semivarogramas cruzados (Bivariados)</a></li>
<li class="chapter" data-level="9.4.3" data-path="cokriging.html"><a href="cokriging.html#gstat"><i class="fa fa-check"></i><b>9.4.3</b> gstat</a></li>
<li class="chapter" data-level="9.4.4" data-path="cokriging.html"><a href="cokriging.html#estimación-del-semivariograma"><i class="fa fa-check"></i><b>9.4.4</b> Estimación del semivariograma</a></li>
<li class="chapter" data-level="9.4.5" data-path="cokriging.html"><a href="cokriging.html#mapas-de-predicción-de-o3-con-las-covariables-espaciales-no2-y-nox"><i class="fa fa-check"></i><b>9.4.5</b> Mapas de predicción de O3 con las covariables espaciales NO2 y NOX</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cokriging</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pre-procesamiento-de-datos" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Pre-procesamiento de datos<a href="pre-procesamiento-de-datos.html#pre-procesamiento-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="pre-procesamiento-de-datos.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cruce de información con el shape cargado</span></span>
<span id="cb140-2"><a href="pre-procesamiento-de-datos.html#cb140-2" aria-hidden="true" tabindex="-1"></a>Insumo <span class="ot">=</span> <span class="fu">merge</span>(Colombia, BASE, <span class="at">by.x=</span><span class="st">&quot;COD_DANE&quot;</span>, <span class="at">by.y=</span><span class="st">&quot;Cod&quot;</span>)</span>
<span id="cb140-3"><a href="pre-procesamiento-de-datos.html#cb140-3" aria-hidden="true" tabindex="-1"></a>Insumo <span class="ot">=</span> <span class="fu">subset</span>(Insumo[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>,<span class="dv">33</span>),])</span>
<span id="cb140-4"><a href="pre-procesamiento-de-datos.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversión a Coordenadas UTM</span></span>
<span id="cb140-5"><a href="pre-procesamiento-de-datos.html#cb140-5" aria-hidden="true" tabindex="-1"></a>Crs.geo <span class="ot">=</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=tmerc +lat_0=4.599047222222222 +lon_0=-74.08091666666667 +k=1 +x_0=1000000 +y_0=1000000 +ellps=intl +towgs84=307,304,-318,0,0,0,0 +units=m +no_defs&quot;</span>)  </span>
<span id="cb140-6"><a href="pre-procesamiento-de-datos.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(Insumo) <span class="ot">&lt;-</span> Crs.geo </span>
<span id="cb140-7"><a href="pre-procesamiento-de-datos.html#cb140-7" aria-hidden="true" tabindex="-1"></a>Insumo.utm <span class="ot">=</span> <span class="fu">spTransform</span>(Insumo, <span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:3724 +units=km&quot;</span>))</span></code></pre></div>
<div id="matriz-de-vecindades" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Matriz de vecindades<a href="pre-procesamiento-de-datos.html#matriz-de-vecindades" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="pre-procesamiento-de-datos.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb141-2"><a href="pre-procesamiento-de-datos.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MATRIZ DE VECINDADES (W)</span></span>
<span id="cb141-3"><a href="pre-procesamiento-de-datos.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb141-4"><a href="pre-procesamiento-de-datos.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Centroides de las Áreas</span></span>
<span id="cb141-5"><a href="pre-procesamiento-de-datos.html#cb141-5" aria-hidden="true" tabindex="-1"></a>Centros <span class="ot">=</span> <span class="fu">getSpPPolygonsLabptSlots</span>(Insumo.utm)</span>
<span id="cb141-6"><a href="pre-procesamiento-de-datos.html#cb141-6" aria-hidden="true" tabindex="-1"></a>Centroids <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(<span class="at">coords =</span> Centros, <span class="at">data=</span>Insumo.utm<span class="sc">@</span>data, </span>
<span id="cb141-7"><a href="pre-procesamiento-de-datos.html#cb141-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">proj4string=</span><span class="fu">CRS</span>(<span class="st">&quot;+init=epsg:3724 +units=km&quot;</span>))</span>
<span id="cb141-8"><a href="pre-procesamiento-de-datos.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de Distancias entre los Centriodes</span></span>
<span id="cb141-9"><a href="pre-procesamiento-de-datos.html#cb141-9" aria-hidden="true" tabindex="-1"></a>Wdist <span class="ot">=</span> <span class="fu">dist</span>(Centros, <span class="at">up=</span>T)</span>
<span id="cb141-10"><a href="pre-procesamiento-de-datos.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz W de vecindades</span></span>
<span id="cb141-11"><a href="pre-procesamiento-de-datos.html#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pgirmess)</span>
<span id="cb141-12"><a href="pre-procesamiento-de-datos.html#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HistogramTools)</span>
<span id="cb141-13"><a href="pre-procesamiento-de-datos.html#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb141-14"><a href="pre-procesamiento-de-datos.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb141-15"><a href="pre-procesamiento-de-datos.html#cb141-15" aria-hidden="true" tabindex="-1"></a>Insumo.nb <span class="ot">=</span> <span class="fu">poly2nb</span>(Insumo.utm, <span class="at">queen=</span>T)</span>
<span id="cb141-16"><a href="pre-procesamiento-de-datos.html#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="co">#n &lt;- max(sapply(Insumo.nb, length))</span></span>
<span id="cb141-17"><a href="pre-procesamiento-de-datos.html#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="co">#ll &lt;- lapply(Insumo.nb, function(X) {</span></span>
<span id="cb141-18"><a href="pre-procesamiento-de-datos.html#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="co">#  c(as.numeric(X), rep(0, times = n - length(X)))</span></span>
<span id="cb141-19"><a href="pre-procesamiento-de-datos.html#cb141-19" aria-hidden="true" tabindex="-1"></a><span class="co">#})</span></span>
<span id="cb141-20"><a href="pre-procesamiento-de-datos.html#cb141-20" aria-hidden="true" tabindex="-1"></a><span class="co">#out &lt;- do.call(cbind, ll)</span></span>
<span id="cb141-21"><a href="pre-procesamiento-de-datos.html#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Departamentos&lt;-Insumo$Departamento</span></span>
<span id="cb141-22"><a href="pre-procesamiento-de-datos.html#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="co">#MatW&lt;-matrix(NA,32,32)</span></span>
<span id="cb141-23"><a href="pre-procesamiento-de-datos.html#cb141-23" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:8) {</span></span>
<span id="cb141-24"><a href="pre-procesamiento-de-datos.html#cb141-24" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (j in 1:32) {</span></span>
<span id="cb141-25"><a href="pre-procesamiento-de-datos.html#cb141-25" aria-hidden="true" tabindex="-1"></a><span class="co">#    if (out[i,j]!=0) {</span></span>
<span id="cb141-26"><a href="pre-procesamiento-de-datos.html#cb141-26" aria-hidden="true" tabindex="-1"></a><span class="co">#      MatW[out[i,j],j]&lt;-1</span></span>
<span id="cb141-27"><a href="pre-procesamiento-de-datos.html#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    } else{MatW[out[i,j],j]&lt;-0}</span></span>
<span id="cb141-28"><a href="pre-procesamiento-de-datos.html#cb141-28" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb141-29"><a href="pre-procesamiento-de-datos.html#cb141-29" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb141-30"><a href="pre-procesamiento-de-datos.html#cb141-30" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:32) {</span></span>
<span id="cb141-31"><a href="pre-procesamiento-de-datos.html#cb141-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (j in 1:32) {</span></span>
<span id="cb141-32"><a href="pre-procesamiento-de-datos.html#cb141-32" aria-hidden="true" tabindex="-1"></a><span class="co">#    if (is.na(MatW[i,j])) {</span></span>
<span id="cb141-33"><a href="pre-procesamiento-de-datos.html#cb141-33" aria-hidden="true" tabindex="-1"></a><span class="co">#      MatW[i,j]&lt;-0</span></span>
<span id="cb141-34"><a href="pre-procesamiento-de-datos.html#cb141-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    }</span></span>
<span id="cb141-35"><a href="pre-procesamiento-de-datos.html#cb141-35" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb141-36"><a href="pre-procesamiento-de-datos.html#cb141-36" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb141-37"><a href="pre-procesamiento-de-datos.html#cb141-37" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(MatW)&lt;-Departamentos</span></span>
<span id="cb141-38"><a href="pre-procesamiento-de-datos.html#cb141-38" aria-hidden="true" tabindex="-1"></a><span class="co">#rownames(MatW)&lt;-Departamentos</span></span>
<span id="cb141-39"><a href="pre-procesamiento-de-datos.html#cb141-39" aria-hidden="true" tabindex="-1"></a><span class="co">#MatW1&lt;-MatW[,1:16]</span></span>
<span id="cb141-40"><a href="pre-procesamiento-de-datos.html#cb141-40" aria-hidden="true" tabindex="-1"></a><span class="co">#MatW2&lt;-MatW[,17:32]</span></span>
<span id="cb141-41"><a href="pre-procesamiento-de-datos.html#cb141-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Martiz W (Estilos)</span></span>
<span id="cb141-42"><a href="pre-procesamiento-de-datos.html#cb141-42" aria-hidden="true" tabindex="-1"></a>Insumo.lw <span class="ot">=</span> <span class="fu">nb2listw</span>(Insumo.nb)</span>
<span id="cb141-43"><a href="pre-procesamiento-de-datos.html#cb141-43" aria-hidden="true" tabindex="-1"></a>Insumo.lwb <span class="ot">=</span> <span class="fu">nb2listw</span>(Insumo.nb, <span class="at">style=</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb141-44"><a href="pre-procesamiento-de-datos.html#cb141-44" aria-hidden="true" tabindex="-1"></a>Insumo.lwc <span class="ot">=</span> <span class="fu">nb2listw</span>(Insumo.nb, <span class="at">style=</span><span class="st">&quot;C&quot;</span>)</span>
<span id="cb141-45"><a href="pre-procesamiento-de-datos.html#cb141-45" aria-hidden="true" tabindex="-1"></a>Insumo.lwu <span class="ot">=</span> <span class="fu">nb2listw</span>(Insumo.nb, <span class="at">style=</span><span class="st">&quot;U&quot;</span>)</span>
<span id="cb141-46"><a href="pre-procesamiento-de-datos.html#cb141-46" aria-hidden="true" tabindex="-1"></a>Insumo.lww <span class="ot">=</span> <span class="fu">nb2listw</span>(Insumo.nb, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span></code></pre></div>
</div>
<div id="mapa-de-valores-observados" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Mapa de valores observados<a href="pre-procesamiento-de-datos.html#mapa-de-valores-observados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="pre-procesamiento-de-datos.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Mapa de Valores Observados</span></span>
<span id="cb142-2"><a href="pre-procesamiento-de-datos.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new() #windows()</span></span>
<span id="cb142-3"><a href="pre-procesamiento-de-datos.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">choropleth</span>(Insumo, Insumo<span class="sc">$</span>CAP_BAC)</span>
<span id="cb142-4"><a href="pre-procesamiento-de-datos.html#cb142-4" aria-hidden="true" tabindex="-1"></a>shad <span class="ot">=</span> <span class="fu">auto.shading</span>(Insumo<span class="sc">$</span>CAP_BAC, <span class="at">n=</span><span class="dv">5</span>, <span class="at">cols=</span>(<span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)), <span class="at">cutter =</span> quantileCuts)</span>
<span id="cb142-5"><a href="pre-procesamiento-de-datos.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">choro.legend</span>(<span class="dv">1555874</span>,<span class="fl">535165.5</span>, shad, <span class="at">fmt=</span><span class="st">&quot;%1.1f&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Valores Locales&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">under =</span> <span class="st">&quot;Menos de&quot;</span>, <span class="at">between =</span> <span class="st">&quot;a&quot;</span>, <span class="at">over =</span> <span class="st">&quot;Mas de&quot;</span>)</span>
<span id="cb142-6"><a href="pre-procesamiento-de-datos.html#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Valores Observados para las captaciones del banco agrario </span></span>
<span id="cb142-7"><a href="pre-procesamiento-de-datos.html#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="st">       en Colombia, cuarto trimestre 2020&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb142-8"><a href="pre-procesamiento-de-datos.html#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map.scale</span>(<span class="dv">755874</span>,<span class="fl">335165.5</span>, <span class="dv">250000</span>, <span class="st">&quot;km&quot;</span>, <span class="dv">2</span>, <span class="dv">50</span>, <span class="at">sfcol=</span><span class="st">&#39;brown&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="pruebas-de-autocorrelación" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Pruebas de Autocorrelación<a href="pre-procesamiento-de-datos.html#pruebas-de-autocorrelación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="pre-procesamiento-de-datos.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------</span></span>
<span id="cb143-2"><a href="pre-procesamiento-de-datos.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  PRUEBAS DE AUTOCORRELACION</span></span>
<span id="cb143-3"><a href="pre-procesamiento-de-datos.html#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------</span></span>
<span id="cb143-4"><a href="pre-procesamiento-de-datos.html#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="pre-procesamiento-de-datos.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran</span></span>
<span id="cb143-6"><a href="pre-procesamiento-de-datos.html#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Insumo<span class="sc">$</span>CAP_BAC, Insumo.lw)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  Insumo$CAP_BAC  
## weights: Insumo.lw    
## 
## Moran I statistic standard deviate = 2.0024, p-value
## = 0.02262
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.153081266      -0.032258065       0.008566935</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="pre-procesamiento-de-datos.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dispersograma de Moran</span></span>
<span id="cb145-2"><a href="pre-procesamiento-de-datos.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new() #windows()</span></span>
<span id="cb145-3"><a href="pre-procesamiento-de-datos.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(Insumo<span class="sc">$</span>CAP_BAC, Insumo.lw, <span class="at">labels=</span><span class="fu">as.character</span>(Insumo<span class="sc">$</span>Departamento), <span class="at">xlab=</span><span class="st">&quot;Captaciones BAC&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Captaciones BAC rezagado&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb145-4"><a href="pre-procesamiento-de-datos.html#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;I de Moran: 0.1530&quot;</span>, <span class="st">&quot;Valor P:      0.02262&quot;</span>), <span class="at">cex=</span><span class="dv">1</span>,<span class="at">bg=</span><span class="st">&#39;lightgreen&#39;</span>)</span>
<span id="cb145-5"><a href="pre-procesamiento-de-datos.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Dispersograma de Moran para las captaciones del banco agrario en </span></span>
<span id="cb145-6"><a href="pre-procesamiento-de-datos.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="st">los Departamentos de Colombia, cuarto trimestre 2020&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="pre-procesamiento-de-datos.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Local G</span></span>
<span id="cb146-2"><a href="pre-procesamiento-de-datos.html#cb146-2" aria-hidden="true" tabindex="-1"></a>nearng <span class="ot">=</span> <span class="fu">dnearneigh</span>(<span class="fu">coordinates</span>(Insumo.utm), <span class="dv">0</span>, <span class="dv">550</span>)</span>
<span id="cb146-3"><a href="pre-procesamiento-de-datos.html#cb146-3" aria-hidden="true" tabindex="-1"></a>Insumo.lw.g <span class="ot">=</span> <span class="fu">nb2listw</span>(nearng, <span class="at">style=</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb146-4"><a href="pre-procesamiento-de-datos.html#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="pre-procesamiento-de-datos.html#cb146-5" aria-hidden="true" tabindex="-1"></a>localG <span class="ot">=</span> <span class="fu">localG</span>(Insumo<span class="sc">$</span>CAP_BAC, Insumo.lw.g); localG</span></code></pre></div>
<pre><code>##  [1]  1.66525050  0.02608278  1.33032949  1.15892050
##  [5]  1.85852161  0.68445519  1.49486468  0.10163662
##  [9]  1.64717068  1.32714028  2.53361281  2.21899396
## [13] -0.71311540  0.50952811  1.48899277  0.81676480
## [17]  0.98434717  2.09087184  2.08725553  1.05493906
## [21]  1.32486118  2.09147517  2.16305539  1.89323276
## [25]  1.52155929  0.84992902 -1.19798594 -1.33847805
## [29]  0.29701426 -1.60300117  1.67015910  1.96543367
## attr(,&quot;cluster&quot;)
##  [1] High Low  Low  High Low  Low  High Low  Low  High Low 
## [12] High Low  Low  Low  High High Low  Low  High Low  High
## [23] High Low  Low  Low  Low  Low  Low  Low  Low  High
## Levels: Low High
## attr(,&quot;gstari&quot;)
## [1] FALSE
## attr(,&quot;call&quot;)
## localG(x = Insumo$CAP_BAC, listw = Insumo.lw.g)
## attr(,&quot;class&quot;)
## [1] &quot;localG&quot;</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="pre-procesamiento-de-datos.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulaci?n montecarlo</span></span>
<span id="cb148-2"><a href="pre-procesamiento-de-datos.html#cb148-2" aria-hidden="true" tabindex="-1"></a>sim.G <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">32</span>)</span>
<span id="cb148-3"><a href="pre-procesamiento-de-datos.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) sim.G[i,] <span class="ot">=</span> <span class="fu">localG</span>(<span class="fu">sample</span>(Insumo<span class="sc">$</span>CAP_BAC),Insumo.lw.g)</span>
<span id="cb148-4"><a href="pre-procesamiento-de-datos.html#cb148-4" aria-hidden="true" tabindex="-1"></a>mc.pvalor.G <span class="ot">=</span> (<span class="fu">colSums</span>(<span class="fu">sweep</span>(sim.G,<span class="dv">2</span>,localG,<span class="st">&quot;&gt;=&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">nrow</span>(sim.G)<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb148-5"><a href="pre-procesamiento-de-datos.html#cb148-5" aria-hidden="true" tabindex="-1"></a>mc.pvalor.G</span></code></pre></div>
<pre><code>##  [1] 0.009990010 0.438561439 0.086913087 0.114885115
##  [5] 0.001998002 0.288711289 0.067932068 0.442557443
##  [9] 0.031968032 0.055944056 0.000999001 0.001998002
## [13] 0.709290709 0.303696304 0.034965035 0.235764236
## [17] 0.168831169 0.000999001 0.000999001 0.127872128
## [21] 0.090909091 0.000999001 0.004995005 0.016983017
## [25] 0.051948052 0.228771229 0.969030969 0.963036963
## [29] 0.430569431 0.994005994 0.053946054 0.000999001</code></pre>
</div>
<div id="mapas" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Mapas<a href="pre-procesamiento-de-datos.html#mapas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="pre-procesamiento-de-datos.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapas</span></span>
<span id="cb150-2"><a href="pre-procesamiento-de-datos.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb150-3"><a href="pre-procesamiento-de-datos.html#cb150-3" aria-hidden="true" tabindex="-1"></a>shadeg <span class="ot">=</span> <span class="fu">auto.shading</span>(localG, <span class="at">n=</span><span class="dv">5</span>, <span class="at">cols=</span>(<span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Purples&quot;</span>)), <span class="at">cutter=</span>quantileCuts)</span>
<span id="cb150-4"><a href="pre-procesamiento-de-datos.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new() #windows()</span></span>
<span id="cb150-5"><a href="pre-procesamiento-de-datos.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">choropleth</span>(Insumo, localG, <span class="at">shading=</span>shadeg)</span>
<span id="cb150-6"><a href="pre-procesamiento-de-datos.html#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="fu">choro.legend</span>(<span class="dv">1555874</span>,<span class="fl">535165.5</span>, shadeg, <span class="at">fmt=</span><span class="st">&quot;%1.2f&quot;</span>, <span class="at">title =</span> <span class="st">&quot;G&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">under =</span> <span class="st">&quot;Menos de&quot;</span>, <span class="at">between =</span> <span class="st">&quot;a&quot;</span>, <span class="at">over =</span> <span class="st">&quot;Mas de&quot;</span>)</span>
<span id="cb150-7"><a href="pre-procesamiento-de-datos.html#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;G Getis Ord Local para las captaciones del banco agrario </span></span>
<span id="cb150-8"><a href="pre-procesamiento-de-datos.html#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="st">       en Colombia, cuarto trimestre 2020&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb150-9"><a href="pre-procesamiento-de-datos.html#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="fu">map.scale</span>(<span class="dv">755874</span>,<span class="fl">335165.5</span>, <span class="dv">250000</span>, <span class="st">&quot;km&quot;</span>, <span class="dv">2</span>, <span class="dv">50</span>, <span class="at">sfcol=</span><span class="st">&#39;brown&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="pre-procesamiento-de-datos.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa de P-values</span></span>
<span id="cb151-2"><a href="pre-procesamiento-de-datos.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new() #windows()</span></span>
<span id="cb151-3"><a href="pre-procesamiento-de-datos.html#cb151-3" aria-hidden="true" tabindex="-1"></a>shadegp <span class="ot">=</span> <span class="fu">shading</span>(<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>), <span class="at">cols =</span> (<span class="fu">brewer.pal</span>(<span class="dv">4</span>,<span class="st">&quot;Spectral&quot;</span>)))</span>
<span id="cb151-4"><a href="pre-procesamiento-de-datos.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">choropleth</span>(Insumo, mc.pvalor.G, <span class="at">shading=</span>shadegp)</span>
<span id="cb151-5"><a href="pre-procesamiento-de-datos.html#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">choro.legend</span>(<span class="dv">1555874</span>,<span class="fl">535165.5</span>, shadegp, <span class="at">fmt=</span><span class="st">&quot;%1.2f&quot;</span>, <span class="at">title =</span> <span class="st">&quot;P-valor de G&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">under =</span> <span class="st">&quot;Menos de&quot;</span>, <span class="at">between =</span> <span class="st">&quot;a&quot;</span>, <span class="at">over =</span> <span class="st">&quot;Mas de&quot;</span>)</span>
<span id="cb151-6"><a href="pre-procesamiento-de-datos.html#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;P- Valor de G Getis Ord Local para las captaciones del banco agrario </span></span>
<span id="cb151-7"><a href="pre-procesamiento-de-datos.html#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="st">       en Colombia, cuarto trimestre 2020&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb151-8"><a href="pre-procesamiento-de-datos.html#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map.scale</span>(<span class="dv">755874</span>,<span class="fl">335165.5</span>, <span class="dv">250000</span>, <span class="st">&quot;km&quot;</span>, <span class="dv">2</span>, <span class="dv">50</span>, <span class="at">sfcol=</span><span class="st">&#39;brown&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>##Modelos SDEM, SDM, Manski, SARAR</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="pre-procesamiento-de-datos.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="do">####Modelos SDEM, SDM, Manski, SARAR########</span></span>
<span id="cb152-2"><a href="pre-procesamiento-de-datos.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co">#reg.eq1=CAP_BAC ~ PIB + NBI + CAP_BOG + CAP_BC + CAP_OCC + CAP_CS + Población + IPM</span></span>
<span id="cb152-3"><a href="pre-procesamiento-de-datos.html#cb152-3" aria-hidden="true" tabindex="-1"></a>reg.eq1<span class="ot">=</span>CAP_BAC <span class="sc">~</span> PIB <span class="sc">+</span> NBI <span class="sc">+</span> CAP_BOG<span class="sc">+</span>CAP_BC <span class="sc">+</span> CAP_OCC <span class="sc">+</span> CAP_CS<span class="sc">+</span> Población</span>
<span id="cb152-4"><a href="pre-procesamiento-de-datos.html#cb152-4" aria-hidden="true" tabindex="-1"></a>reg1<span class="ot">=</span><span class="fu">lm</span>(reg.eq1,<span class="at">data=</span>Insumo)                                     <span class="co">#OLS            y=XB+e,    </span></span>
<span id="cb152-5"><a href="pre-procesamiento-de-datos.html#cb152-5" aria-hidden="true" tabindex="-1"></a>reg2<span class="ot">=</span><span class="fu">lmSLX</span>(reg.eq1,<span class="at">data=</span>Insumo, Insumo.lw)                       <span class="co">#SLX            y=XB+WxT+e</span></span>
<span id="cb152-6"><a href="pre-procesamiento-de-datos.html#cb152-6" aria-hidden="true" tabindex="-1"></a>reg3<span class="ot">=</span><span class="fu">lagsarlm</span>(reg.eq1,<span class="at">data=</span> Insumo, Insumo.lw)                   <span class="co">#Lag Y          y=XB+WxT+u,   u=LWu+e</span></span>
<span id="cb152-7"><a href="pre-procesamiento-de-datos.html#cb152-7" aria-hidden="true" tabindex="-1"></a>reg4<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq1,<span class="at">data=</span>Insumo, Insumo.lw)                  <span class="co">#Spatial Error  y=pWy+XB+e   </span></span>
<span id="cb152-8"><a href="pre-procesamiento-de-datos.html#cb152-8" aria-hidden="true" tabindex="-1"></a>reg5<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq1, <span class="at">data=</span>Insumo, Insumo.lw, <span class="at">etype=</span><span class="st">&quot;emixed&quot;</span>) <span class="co">#SDEM Spatial Durbin Error Model y=XB+WxT+u,   u=LWu+e</span></span>
<span id="cb152-9"><a href="pre-procesamiento-de-datos.html#cb152-9" aria-hidden="true" tabindex="-1"></a>reg6<span class="ot">=</span><span class="fu">lagsarlm</span>(reg.eq1, <span class="at">data=</span>Insumo,Insumo.lw, <span class="at">type=</span><span class="st">&quot;mixed&quot;</span>)      <span class="co">#SDM Spatial Durbin Model (add lag X to SAR) y=pWy+XB+WXT+e </span></span>
<span id="cb152-10"><a href="pre-procesamiento-de-datos.html#cb152-10" aria-hidden="true" tabindex="-1"></a>reg7<span class="ot">=</span><span class="fu">sacsarlm</span>(reg.eq1,<span class="at">data=</span>Insumo, Insumo.lw, <span class="at">type=</span><span class="st">&quot;sacmixed&quot;</span>)   <span class="co">#Manski Model: y=pWy+XB+WXT+u,   u=LWu+e (no recomendado)</span></span>
<span id="cb152-11"><a href="pre-procesamiento-de-datos.html#cb152-11" aria-hidden="true" tabindex="-1"></a>reg8<span class="ot">=</span><span class="fu">sacsarlm</span>(reg.eq1,<span class="at">data=</span>Insumo,Insumo.lw, <span class="at">type=</span><span class="st">&quot;sac&quot;</span>)         <span class="co">#SARAR o Kelejian-Prucha, Cliff-Ord, o SAC If all T=0,y=pWy+XB+u, u=LWu+e</span></span></code></pre></div>
</div>
<div id="resumen-de-modelos" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Resumen de modelos<a href="pre-procesamiento-de-datos.html#resumen-de-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="pre-procesamiento-de-datos.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Resumen de modelos</span></span>
<span id="cb153-2"><a href="pre-procesamiento-de-datos.html#cb153-2" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span>summary</span>
<span id="cb153-3"><a href="pre-procesamiento-de-datos.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg1)<span class="co">#OLS</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = reg.eq1, data = Insumo)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -276.51  -65.60   -7.76   46.60  396.20 
## 
## Coefficients:
##                 Estimate   Std. Error t value Pr(&gt;|t|)  
## (Intercept) 148.21380364  79.80068638   1.857   0.0756 .
## PIB           0.00389642   0.00328986   1.184   0.2479  
## NBI          -1.28539812   1.73982368  -0.739   0.4672  
## CAP_BOG      -0.06643826   0.05411306  -1.228   0.2314  
## CAP_BC        0.00397406   0.00607852   0.654   0.5195  
## CAP_OCC      -0.04340185   0.02170799  -1.999   0.0570 .
## CAP_CS        0.47283237   0.31370238   1.507   0.1448  
## Población     0.00000137   0.00006700   0.020   0.9839  
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 141.6 on 24 degrees of freedom
## Multiple R-squared:  0.8807, Adjusted R-squared:  0.8459 
## F-statistic: 25.31 on 7 and 24 DF,  p-value: 0.000000001309</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="pre-procesamiento-de-datos.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg2)<span class="co">#SLX</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formula(paste(&quot;y ~ &quot;, paste(colnames(x)[-1], collapse = &quot;+&quot;))), 
##     data = as.data.frame(x), weights = weights)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -201.00  -74.99   -0.51   34.55  342.00 
## 
## Coefficients:
##                   Estimate   Std. Error t value Pr(&gt;|t|)
## (Intercept)   392.97159157 284.42668099   1.382    0.185
## PIB             0.00429319   0.00383973   1.118    0.279
## NBI            -0.57603773   2.48213535  -0.232    0.819
## CAP_BOG        -0.00703635   0.07700761  -0.091    0.928
## CAP_BC         -0.00075536   0.01003615  -0.075    0.941
## CAP_OCC        -0.05372016   0.03418522  -1.571    0.135
## CAP_CS          0.12199794   0.43670734   0.279    0.783
## Población       0.00004753   0.00012149   0.391    0.701
## lag.PIB         0.00317318   0.00943185   0.336    0.741
## lag.NBI        -6.81433196   5.99552430  -1.137    0.271
## lag.CAP_BOG    -0.06868663   0.18842513  -0.365    0.720
## lag.CAP_BC      0.00684589   0.01472675   0.465    0.648
## lag.CAP_OCC    -0.00984285   0.05447122  -0.181    0.859
## lag.CAP_CS      0.33585267   1.09533771   0.307    0.763
## lag.Población  -0.00016927   0.00017459  -0.970    0.346
## 
## Residual standard error: 151.6 on 17 degrees of freedom
## Multiple R-squared:  0.9031, Adjusted R-squared:  0.8234 
## F-statistic: 11.32 on 14 and 17 DF,  p-value: 0.000005467</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="pre-procesamiento-de-datos.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg3)<span class="co">#Lag Y</span></span></code></pre></div>
<pre><code>## 
## Call:
## lagsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -213.859  -60.238  -17.811   42.960  393.389 
## 
## Type: lag 
## Coefficients: (numerical Hessian approximate standard errors) 
##                   Estimate     Std. Error z value Pr(&gt;|z|)
## (Intercept) 77.75431737089 74.33304193262  1.0460  0.29555
## PIB          0.00330780479  0.00157831647  2.0958  0.03610
## NBI         -0.77863469452  1.48478285166 -0.5244  0.59999
## CAP_BOG     -0.05466121822  0.04352388108 -1.2559  0.20916
## CAP_BC       0.00533211204  0.00466472729  1.1431  0.25301
## CAP_OCC     -0.03421667740  0.01731007390 -1.9767  0.04808
## CAP_CS       0.40699816555  0.26036918467  1.5632  0.11802
## Población    0.00000091508            NaN     NaN      NaN
## 
## Rho: 0.22884, LR test value: 2.096, p-value: 0.14768
## Approximate (numerical Hessian) standard error: 0.15346
##     z-value: 1.4912, p-value: 0.1359
## Wald statistic: 2.2237, p-value: 0.1359
## 
## Log likelihood: -198.251 for lag model
## ML residual variance (sigma squared): 13916, (sigma: 117.97)
## Number of observations: 32 
## Number of parameters estimated: 10 
## AIC: 416.5, (AIC for lm: 416.6)</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="pre-procesamiento-de-datos.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg4)<span class="co">#Lag Error (SEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -215.7428  -56.4299   -2.2091   46.6630  425.7867 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                 Estimate   Std. Error z value Pr(&gt;|z|)
## (Intercept) 94.500067067 73.097738551  1.2928  0.19608
## PIB          0.003656790  0.002619923  1.3958  0.16279
## NBI         -0.334674368  1.408551018 -0.2376  0.81219
## CAP_BOG     -0.032484044  0.049990128 -0.6498  0.51582
## CAP_BC       0.001202333  0.005555428  0.2164  0.82866
## CAP_OCC     -0.048739698  0.019538015 -2.4946  0.01261
## CAP_CS       0.285572491  0.287233643  0.9942  0.32012
## Población    0.000040164  0.000066648  0.6026  0.54676
## 
## Lambda: 0.50692, LR test value: 3.8031, p-value: 0.051158
## Approximate (numerical Hessian) standard error: 0.21479
##     z-value: 2.3601, p-value: 0.018271
## Wald statistic: 5.57, p-value: 0.018271
## 
## Log likelihood: -197.3975 for error model
## ML residual variance (sigma squared): 12495, (sigma: 111.78)
## Number of observations: 32 
## Number of parameters estimated: 10 
## AIC: 414.79, (AIC for lm: 416.6)</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="pre-procesamiento-de-datos.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg5)<span class="co">#Durbin Error (SDEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw, 
##     etype = &quot;emixed&quot;)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -199.7723  -69.8844   -2.0075   37.9235  362.9104 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                    Estimate    Std. Error z value Pr(&gt;|z|)
## (Intercept)   248.934497490 220.997185179  1.1264  0.25999
## PIB             0.004499050   0.002763860  1.6278  0.10356
## NBI            -0.058410888   1.767448320 -0.0330  0.97364
## CAP_BOG        -0.026724643   0.054644416 -0.4891  0.62480
## CAP_BC         -0.000183348   0.007104434 -0.0258  0.97941
## CAP_OCC        -0.051006011   0.024157938 -2.1114  0.03474
## CAP_CS          0.227498808   0.309055946  0.7361  0.46166
## Población       0.000035177   0.000084525  0.4162  0.67729
## lag.PIB         0.003069904   0.007273446  0.4221  0.67297
## lag.NBI        -4.397301264   4.370216212 -1.0062  0.31432
## lag.CAP_BOG    -0.078935306   0.133353632 -0.5919  0.55390
## lag.CAP_BC      0.000970530   0.011031859  0.0880  0.92990
## lag.CAP_OCC    -0.013417109   0.040319110 -0.3328  0.73931
## lag.CAP_CS      0.374124929   0.777502427  0.4812  0.63038
## lag.Población  -0.000103911   0.000125213 -0.8299  0.40661
## 
## Lambda: 0.28217, LR test value: 0.34013, p-value: 0.55976
## Approximate (numerical Hessian) standard error: 0.43008
##     z-value: 0.6561, p-value: 0.51176
## Wald statistic: 0.43047, p-value: 0.51176
## 
## Log likelihood: -195.7931 for error model
## ML residual variance (sigma squared): 11856, (sigma: 108.89)
## Number of observations: 32 
## Number of parameters estimated: 17 
## AIC: 425.59, (AIC for lm: 423.93)</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="pre-procesamiento-de-datos.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg6)<span class="co">#Durbin (SDM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lagsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw, 
##     type = &quot;mixed&quot;)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -185.6170  -74.5630   -1.2308   34.6848  363.6597 
## 
## Type: mixed 
## Coefficients: (numerical Hessian approximate standard errors) 
##                    Estimate    Std. Error z value Pr(&gt;|z|)
## (Intercept)   259.002911178 230.104789400  1.1256   0.2603
## PIB             0.004292096   0.002709485  1.5841   0.1132
## NBI            -0.068020334   1.599249655 -0.0425   0.9661
## CAP_BOG        -0.013498834   0.053646345 -0.2516   0.8013
## CAP_BC         -0.000674466   0.006747917 -0.1000   0.9204
## CAP_OCC        -0.052995708   0.023276623 -2.2768   0.0228
## CAP_CS          0.159111963   0.305216541  0.5213   0.6022
## Población       0.000046528   0.000083888  0.5546   0.5791
## lag.PIB         0.001006280   0.006950379  0.1448   0.8849
## lag.NBI        -5.022146095   4.504322175 -1.1150   0.2649
## lag.CAP_BOG    -0.060141057   0.129919351 -0.4629   0.6434
## lag.CAP_BC      0.003372687   0.010806814  0.3121   0.7550
## lag.CAP_OCC     0.001941495   0.030122408  0.0645   0.9486
## lag.CAP_CS      0.265435969   0.754778096  0.3517   0.7251
## lag.Población  -0.000120261   0.000126709 -0.9491   0.3426
## 
## Rho: 0.28321, LR test value: 0.99104, p-value: 0.31949
## Approximate (numerical Hessian) standard error: 0.26808
##     z-value: 1.0564, p-value: 0.29077
## Wald statistic: 1.116, p-value: 0.29077
## 
## Log likelihood: -195.4676 for mixed model
## ML residual variance (sigma squared): 11616, (sigma: 107.78)
## Number of observations: 32 
## Number of parameters estimated: 17 
## AIC: 424.94, (AIC for lm: 423.93)</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="pre-procesamiento-de-datos.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg7)<span class="co">#Manski</span></span></code></pre></div>
<pre><code>## 
## Call:
## sacsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw, 
##     type = &quot;sacmixed&quot;)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -179.6048  -72.7882   -2.7818   33.8501  346.2488 
## 
## Type: sacmixed 
## Coefficients: (numerical Hessian approximate standard errors) 
##                    Estimate    Std. Error z value Pr(&gt;|z|)
## (Intercept)   307.899524851 284.687742330  1.0815  0.27946
## PIB             0.004070842   0.002887831  1.4097  0.15864
## NBI            -0.195254185   2.070147473 -0.0943  0.92486
## CAP_BOG         0.002531850   0.093292487  0.0271  0.97835
## CAP_BC         -0.001838769   0.009686163 -0.1898  0.84944
## CAP_OCC        -0.056119738   0.028995161 -1.9355  0.05293
## CAP_CS          0.071595235   0.518838438  0.1380  0.89025
## Población       0.000065749   0.000127955  0.5138  0.60736
## lag.PIB         0.000817609   0.006904128  0.1184  0.90573
## lag.NBI        -6.096432794   5.600016244 -1.0886  0.27631
## lag.CAP_BOG    -0.052377434   0.137793679 -0.3801  0.70386
## lag.CAP_BC      0.006801659   0.017044912  0.3990  0.68986
## lag.CAP_OCC     0.008763485   0.047596659  0.1841  0.85392
## lag.CAP_CS      0.219189297   0.801371640  0.2735  0.78446
## lag.Población  -0.000162608   0.000228334 -0.7122  0.47637
## 
## Rho: 0.38485
## Approximate (numerical Hessian) standard error: 0.37355
##     z-value: 1.0303, p-value: 0.30289
## Lambda: -0.26343
## Approximate (numerical Hessian) standard error: 0.83838
##     z-value: -0.31421, p-value: 0.75336
## 
## LR test value: 7.7816, p-value: 0.5563
## 
## Log likelihood: -195.4082 for sacmixed model
## ML residual variance (sigma squared): 11213, (sigma: 105.89)
## Number of observations: 32 
## Number of parameters estimated: 18 
## AIC: 426.82, (AIC for lm: 416.6)</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="pre-procesamiento-de-datos.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg8)<span class="co">#SARAR lag Y and lag e (SAC)</span></span></code></pre></div>
<pre><code>## 
## Call:
## sacsarlm(formula = reg.eq1, data = Insumo, listw = Insumo.lw, 
##     type = &quot;sac&quot;)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -203.1991  -58.2427   -4.1109   46.5336  421.1733 
## 
## Type: sac 
## Coefficients: (numerical Hessian approximate standard errors) 
##                 Estimate   Std. Error z value Pr(&gt;|z|)
## (Intercept) 73.149386015 83.375351447  0.8774  0.38030
## PIB          0.003487952  0.002657617  1.3124  0.18937
## NBI         -0.337466937  1.455345658 -0.2319  0.81663
## CAP_BOG     -0.038888663  0.051472319 -0.7555  0.44993
## CAP_BC       0.002799262  0.006135570  0.4562  0.64822
## CAP_OCC     -0.043084476  0.021726659 -1.9830  0.04736
## CAP_CS       0.320438586  0.295160199  1.0856  0.27764
## Población    0.000028476  0.000068297  0.4170  0.67671
## 
## Rho: 0.1104
## Approximate (numerical Hessian) standard error: 0.19096
##     z-value: 0.57817, p-value: 0.56315
## Lambda: 0.41973
## Approximate (numerical Hessian) standard error: 0.27372
##     z-value: 1.5334, p-value: 0.12517
## 
## LR test value: 4.1193, p-value: 0.1275
## 
## Log likelihood: -197.2394 for sac model
## ML residual variance (sigma squared): 12624, (sigma: 112.36)
## Number of observations: 32 
## Number of parameters estimated: 11 
## AIC: 416.48, (AIC for lm: 416.6)</code></pre>
</div>
<div id="calculo-de-varibles-significativas" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Calculo de varibles significativas<a href="pre-procesamiento-de-datos.html#calculo-de-varibles-significativas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="pre-procesamiento-de-datos.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculo de variables signid¿ficativas</span></span>
<span id="cb169-2"><a href="pre-procesamiento-de-datos.html#cb169-2" aria-hidden="true" tabindex="-1"></a>reg.eq2<span class="ot">=</span>CAP_BAC <span class="sc">~</span> PIB <span class="sc">+</span> CAP_BOG<span class="sc">+</span>CAP_BC <span class="sc">+</span> CAP_OCC <span class="sc">+</span> CAP_CS<span class="sc">+</span> Población</span>
<span id="cb169-3"><a href="pre-procesamiento-de-datos.html#cb169-3" aria-hidden="true" tabindex="-1"></a>reg4<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq2,<span class="at">data=</span>Insumo, Insumo.lw)</span>
<span id="cb169-4"><a href="pre-procesamiento-de-datos.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg4)<span class="co">#Lag Error (SEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq2, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -211.1287  -54.9469   -1.1316   40.5690  428.8317 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                 Estimate   Std. Error z value Pr(&gt;|z|)
## (Intercept) 82.780380448 57.200033358  1.4472  0.14784
## PIB          0.003786089  0.002550194  1.4846  0.13764
## CAP_BOG     -0.033655761  0.049317358 -0.6824  0.49497
## CAP_BC       0.001072561  0.005563108  0.1928  0.84712
## CAP_OCC     -0.049110630  0.019547548 -2.5124  0.01199
## CAP_CS       0.290079762  0.285013021  1.0178  0.30878
## Población    0.000039933  0.000066827  0.5976  0.55013
## 
## Lambda: 0.51895, LR test value: 4.4697, p-value: 0.0345
## Approximate (numerical Hessian) standard error: 0.20433
##     z-value: 2.5398, p-value: 0.011092
## Wald statistic: 6.4505, p-value: 0.011092
## 
## Log likelihood: -197.4239 for error model
## ML residual variance (sigma squared): 12470, (sigma: 111.67)
## Number of observations: 32 
## Number of parameters estimated: 9 
## AIC: 412.85, (AIC for lm: 415.32)</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="pre-procesamiento-de-datos.html#cb171-1" aria-hidden="true" tabindex="-1"></a>reg.eq3<span class="ot">=</span>CAP_BAC <span class="sc">~</span> PIB <span class="sc">+</span> CAP_BOG <span class="sc">+</span> CAP_OCC <span class="sc">+</span> CAP_CS<span class="sc">+</span> Población</span>
<span id="cb171-2"><a href="pre-procesamiento-de-datos.html#cb171-2" aria-hidden="true" tabindex="-1"></a>reg4<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq3,<span class="at">data=</span>Insumo, Insumo.lw)</span>
<span id="cb171-3"><a href="pre-procesamiento-de-datos.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg4)<span class="co">#Lag Error (SEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq3, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -214.6537  -56.5893   -1.9568   41.1618  430.2455 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                 Estimate   Std. Error z value  Pr(&gt;|z|)
## (Intercept) 76.659389371 48.733986281  1.5730 0.1157149
## PIB          0.003936351  0.002412095  1.6319 0.1026960
## CAP_BOG     -0.026724272  0.035542537 -0.7519 0.4521139
## CAP_OCC     -0.051550780  0.014822573 -3.4779 0.0005054
## CAP_CS       0.249952777  0.204318664  1.2233 0.2211984
## Población    0.000047471  0.000055107  0.8614 0.3890008
## 
## Lambda: 0.52489, LR test value: 4.7822, p-value: 0.028756
## Approximate (numerical Hessian) standard error: 0.19905
##     z-value: 2.6369, p-value: 0.0083666
## Wald statistic: 6.9533, p-value: 0.0083666
## 
## Log likelihood: -197.4421 for error model
## ML residual variance (sigma squared): 12461, (sigma: 111.63)
## Number of observations: 32 
## Number of parameters estimated: 8 
## AIC: 410.88, (AIC for lm: 413.67)</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="pre-procesamiento-de-datos.html#cb173-1" aria-hidden="true" tabindex="-1"></a>reg.eq4<span class="ot">=</span>CAP_BAC <span class="sc">~</span> PIB <span class="sc">+</span> CAP_OCC <span class="sc">+</span> CAP_CS<span class="sc">+</span> Población</span>
<span id="cb173-2"><a href="pre-procesamiento-de-datos.html#cb173-2" aria-hidden="true" tabindex="-1"></a>reg4<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq4,<span class="at">data=</span>Insumo, Insumo.lw)</span>
<span id="cb173-3"><a href="pre-procesamiento-de-datos.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg4)<span class="co">#Lag Error (SEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq4, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -200.4867  -63.5891   -8.8979   41.1675  444.7078 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                 Estimate   Std. Error z value  Pr(&gt;|z|)
## (Intercept) 78.047294926 51.760316072  1.5079 0.1315904
## PIB          0.003727043  0.002409110  1.5471 0.1218483
## CAP_OCC     -0.050131489  0.014726792 -3.4041 0.0006638
## CAP_CS       0.099564078  0.037675929  2.6426 0.0082261
## Población    0.000057480  0.000053995  1.0646 0.2870778
## 
## Lambda: 0.56286, LR test value: 6.894, p-value: 0.0086485
## Approximate (numerical Hessian) standard error: 0.17902
##     z-value: 3.1441, p-value: 0.0016662
## Wald statistic: 9.8851, p-value: 0.0016662
## 
## Log likelihood: -197.7004 for error model
## ML residual variance (sigma squared): 12505, (sigma: 111.82)
## Number of observations: 32 
## Number of parameters estimated: 7 
## AIC: 409.4, (AIC for lm: 414.29)</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="pre-procesamiento-de-datos.html#cb175-1" aria-hidden="true" tabindex="-1"></a>reg.eq5<span class="ot">=</span>CAP_BAC <span class="sc">~</span> PIB <span class="sc">+</span> CAP_OCC <span class="sc">+</span> CAP_CS</span>
<span id="cb175-2"><a href="pre-procesamiento-de-datos.html#cb175-2" aria-hidden="true" tabindex="-1"></a>reg4<span class="ot">=</span><span class="fu">errorsarlm</span>(reg.eq5,<span class="at">data=</span>Insumo, Insumo.lw)</span>
<span id="cb175-3"><a href="pre-procesamiento-de-datos.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(reg4)<span class="co">#Lag Error (SEM)</span></span></code></pre></div>
<pre><code>## 
## Call:
## errorsarlm(formula = reg.eq5, data = Insumo, listw = Insumo.lw)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -189.815  -68.002  -13.434   35.002  443.595 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                 Estimate   Std. Error z value
## (Intercept) 100.98166025  46.44259466  2.1743
## PIB           0.00611113   0.00092889  6.5789
## CAP_OCC      -0.04669321   0.01466331 -3.1844
## CAP_CS        0.07261035   0.02868558  2.5312
##                     Pr(&gt;|z|)
## (Intercept)         0.029680
## PIB         0.00000000004738
## CAP_OCC             0.001451
## CAP_CS              0.011366
## 
## Lambda: 0.54225, LR test value: 6.0083, p-value: 0.014239
## Asymptotic standard error: 0.17423
##     z-value: 3.1123, p-value: 0.0018565
## Wald statistic: 9.6862, p-value: 0.0018565
## 
## Log likelihood: -198.2513 for error model
## ML residual variance (sigma squared): 13034, (sigma: 114.17)
## Number of observations: 32 
## Number of parameters estimated: 6 
## AIC: 408.5, (AIC for lm: 412.51)</code></pre>
</div>
<div id="mapa-estimado" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Mapa Estimado<a href="pre-procesamiento-de-datos.html#mapa-estimado" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="pre-procesamiento-de-datos.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Mapa estimado</span></span>
<span id="cb177-2"><a href="pre-procesamiento-de-datos.html#cb177-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> reg4<span class="sc">$</span>fitted.values</span>
<span id="cb177-3"><a href="pre-procesamiento-de-datos.html#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.new() #windows()</span></span>
<span id="cb177-4"><a href="pre-procesamiento-de-datos.html#cb177-4" aria-hidden="true" tabindex="-1"></a>shade.fit <span class="ot">=</span> <span class="fu">shading</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">200</span>,<span class="dv">400</span>), <span class="at">cols=</span>(<span class="fu">brewer.pal</span>(<span class="dv">5</span>,<span class="st">&quot;Reds&quot;</span>)))</span>
<span id="cb177-5"><a href="pre-procesamiento-de-datos.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">choropleth</span>(Insumo, fit, <span class="at">shading=</span>shade.fit)</span>
<span id="cb177-6"><a href="pre-procesamiento-de-datos.html#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="fu">choro.legend</span>(<span class="dv">1555874</span>,<span class="fl">535165.5</span>, shade.fit, <span class="at">fmt=</span><span class="st">&quot;%1.2f&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Estimaciones&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>, <span class="at">under =</span> <span class="st">&quot;Menos de&quot;</span>, <span class="at">between =</span> <span class="st">&quot;a&quot;</span>, <span class="at">over =</span> <span class="st">&quot;Mas de&quot;</span>)</span>
<span id="cb177-7"><a href="pre-procesamiento-de-datos.html#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Valores ajustados mediante el modelo SEM para las captaciones del banco agrario </span></span>
<span id="cb177-8"><a href="pre-procesamiento-de-datos.html#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="st">       en Colombia, cuarto trimestre 2020&quot;</span>, <span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb177-9"><a href="pre-procesamiento-de-datos.html#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="fu">map.scale</span>(<span class="dv">755874</span>,<span class="fl">335165.5</span>, <span class="dv">250000</span>, <span class="st">&quot;km&quot;</span>, <span class="dv">2</span>, <span class="dv">50</span>, <span class="at">sfcol=</span><span class="st">&#39;brown&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="pre-procesamiento-de-datos.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="do">###R^2 Nagelkerke</span></span>
<span id="cb178-2"><a href="pre-procesamiento-de-datos.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary.sarlm(reg4,Nagelkerke = TRUE) TO-DO</span></span>
<span id="cb178-3"><a href="pre-procesamiento-de-datos.html#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="do">###Test de moran residuales modelo SEM</span></span>
<span id="cb178-4"><a href="pre-procesamiento-de-datos.html#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(reg4<span class="sc">$</span>residuals, Insumo.lw)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  reg4$residuals  
## weights: Insumo.lw    
## 
## Moran I statistic standard deviate = 0.83723, p-value
## = 0.2012
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##        0.05266908       -0.03225806        0.01028984</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="pre-procesamiento-de-datos.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Municipal</span></span>
<span id="cb180-2"><a href="pre-procesamiento-de-datos.html#cb180-2" aria-hidden="true" tabindex="-1"></a>ColombiaM <span class="ot">=</span> <span class="fu">readOGR</span>(<span class="at">dsn =</span> <span class="st">&quot;Trabajo Grado/Geodatabase Colombia&quot;</span>, <span class="at">layer =</span> <span class="st">&quot;municipios&quot;</span>)</span></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/home/martha/Documentos/Cursos EE UN/Trabajo Grado/Geodatabase Colombia&quot;, layer: &quot;municipios&quot;
## with 1107 features
## It has 6 fields
## Integer64 fields read as strings:  COD_MUN COD_DEPTO</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-de-regresión-espacial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ilustración-del-kriging-simple-espacio-tiempo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/edit/master/03-EstudioMercadeoEspacial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/blob/master/03-EstudioMercadeoEspacial.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
