<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Pulimiento de medianas | Ilustrcion del krigin simple espacio tiempo</title>
  <meta name="description" content="Capítulo 6 Pulimiento de medianas | Ilustrcion del krigin simple espacio tiempo" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Pulimiento de medianas | Ilustrcion del krigin simple espacio tiempo" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Pulimiento de medianas | Ilustrcion del krigin simple espacio tiempo" />
  
  
  

<meta name="author" content="Martha Bohorquez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introducción-proceso-espacial-bivariado.html"/>
<link rel="next" href="otros-tipos-de-kriging.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cuadernos R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#indice"><i class="fa fa-check"></i><b>1.1</b> Indice</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ilustración-kriging-espacial.html"><a href="ilustración-kriging-espacial.html"><i class="fa fa-check"></i><b>2</b> Ilustración Kriging Espacial</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ilustración-kriging-espacial.html"><a href="ilustración-kriging-espacial.html#to-do"><i class="fa fa-check"></i><b>2.1</b> (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html"><i class="fa fa-check"></i><b>3</b> Geoestadística con <code>sgeostat</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#data-load"><i class="fa fa-check"></i><b>3.1</b> Data Load</a></li>
<li class="chapter" data-level="3.2" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#libraries"><i class="fa fa-check"></i><b>3.2</b> Libraries</a></li>
<li class="chapter" data-level="3.3" data-path="geoestadística-con-sgeostat.html"><a href="geoestadística-con-sgeostat.html#including-plots"><i class="fa fa-check"></i><b>3.3</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html"><i class="fa fa-check"></i><b>4</b> Geoestadística univariada con <code>geoR</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#parte-descriptiva"><i class="fa fa-check"></i><b>4.1</b> Parte descriptiva</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#librerías"><i class="fa fa-check"></i><b>4.1.1</b> Librerías</a></li>
<li class="chapter" data-level="4.1.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#lectura-de-datos"><i class="fa fa-check"></i><b>4.1.2</b> Lectura de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#geo_data"><i class="fa fa-check"></i><b>4.2</b> GEO_Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#convertir-aquifer-a-un-objeto-geodata-geor-obj"><i class="fa fa-check"></i><b>4.2.1</b> Convertir aquifer a un objeto geodata (geoR obj)</a></li>
<li class="chapter" data-level="4.2.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráfico-de-objeto-geodata"><i class="fa fa-check"></i><b>4.2.2</b> Gráfico de objeto geodata</a></li>
<li class="chapter" data-level="4.2.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráficos-descriptivos-interpolación"><i class="fa fa-check"></i><b>4.2.3</b> Gráficos descriptivos interpolación</a></li>
<li class="chapter" data-level="4.2.4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#gráficos-de-contorno"><i class="fa fa-check"></i><b>4.2.4</b> Gráficos de contorno</a></li>
<li class="chapter" data-level="4.2.5" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#funciones-y-gráficas-a-partir-de-la-función-outer"><i class="fa fa-check"></i><b>4.2.5</b> Funciones y gráficas a partir de la función outer</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#modelando-la-media-con-regresión-polinomial"><i class="fa fa-check"></i><b>4.3</b> Modelando la media con regresión polinomial</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#primer-modelo"><i class="fa fa-check"></i><b>4.3.1</b> Primer modelo</a></li>
<li class="chapter" data-level="4.3.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#segundo-modelo"><i class="fa fa-check"></i><b>4.3.2</b> Segundo modelo</a></li>
<li class="chapter" data-level="4.3.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#tercer-modelo"><i class="fa fa-check"></i><b>4.3.3</b> Tercer modelo</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#estimación-del-semivariograma-empírico"><i class="fa fa-check"></i><b>4.4</b> Estimación del semivariograma empírico</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-estimación-clásica-removiendo-tendencia"><i class="fa fa-check"></i><b>4.4.1</b> Explorando estimación clásica, removiendo tendencia</a></li>
<li class="chapter" data-level="4.4.2" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-estimación-resistente-a-datos-atípicos-y-removiendo-tendencia"><i class="fa fa-check"></i><b>4.4.2</b> Explorando estimación resistente a datos atípicos y removiendo tendencia</a></li>
<li class="chapter" data-level="4.4.3" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#explorando-anisotropía"><i class="fa fa-check"></i><b>4.4.3</b> Explorando anisotropía</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#estimación-teórica-del-semivariograma"><i class="fa fa-check"></i><b>4.5</b> Estimación teórica del semivariograma</a></li>
<li class="chapter" data-level="4.6" data-path="geoestadística-univariada-con-geor.html"><a href="geoestadística-univariada-con-geor.html#resultados"><i class="fa fa-check"></i><b>4.6</b> Resultados</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html"><i class="fa fa-check"></i><b>5</b> Introducción proceso espacial bivariado</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#librerías-1"><i class="fa fa-check"></i><b>5.1</b> Librerías</a></li>
<li class="chapter" data-level="5.2" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#ubicaciones-en-este-caso-se-supone-que-ambos-procesos-están-observados-en-los-mismos-lugares"><i class="fa fa-check"></i><b>5.2</b> Ubicaciones: En este caso se supone que ambos procesos están observados en los mismos lugares</a></li>
<li class="chapter" data-level="5.3" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#modelo-lineal-de-coregionalización"><i class="fa fa-check"></i><b>5.3</b> Modelo lineal de coregionalización</a></li>
<li class="chapter" data-level="5.4" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#simulación-de-un-proceso-espacial-gaussiano-bivariado"><i class="fa fa-check"></i><b>5.4</b> Simulación de un proceso espacial Gaussiano bivariado</a></li>
<li class="chapter" data-level="5.5" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#cokriging"><i class="fa fa-check"></i><b>5.5</b> Cokriging</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#librerías-2"><i class="fa fa-check"></i><b>5.5.1</b> Librerías</a></li>
<li class="chapter" data-level="5.5.2" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#descripción-de-los-datos"><i class="fa fa-check"></i><b>5.5.2</b> Descripción de los datos</a></li>
<li class="chapter" data-level="5.5.3" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#matrices-de-coregionalización."><i class="fa fa-check"></i><b>5.5.3</b> Matrices de coregionalización.</a></li>
<li class="chapter" data-level="5.5.4" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#definición-de-objeto-en-gstat"><i class="fa fa-check"></i><b>5.5.4</b> Definición de objeto en gstat</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#kriging-en-geostad"><i class="fa fa-check"></i><b>5.6</b> Kriging en Geostad</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="introducción-proceso-espacial-bivariado.html"><a href="introducción-proceso-espacial-bivariado.html#ilustración-del-kriging-simple-espacio-tiempo"><i class="fa fa-check"></i><b>5.6.1</b> Ilustración del kriging simple espacio tiempo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html"><i class="fa fa-check"></i><b>6</b> Pulimiento de medianas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#cargar-librerias"><i class="fa fa-check"></i><b>6.1</b> Cargar librerias</a></li>
<li class="chapter" data-level="6.2" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#grilla-de-las-ubicaciones-espaciales."><i class="fa fa-check"></i><b>6.2</b> Grilla de las ubicaciones espaciales.</a></li>
<li class="chapter" data-level="6.3" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#definición-de-objeto-vgm"><i class="fa fa-check"></i><b>6.3</b> Definición de objeto VGM</a></li>
<li class="chapter" data-level="6.4" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#matriz-de-varianza-dadas-coordenadas."><i class="fa fa-check"></i><b>6.4</b> Matriz de varianza dadas coordenadas.</a></li>
<li class="chapter" data-level="6.5" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#simulación."><i class="fa fa-check"></i><b>6.5</b> Simulación.</a></li>
<li class="chapter" data-level="6.6" data-path="pulimiento-de-medianas.html"><a href="pulimiento-de-medianas.html#pulimiento-de-medianas-1"><i class="fa fa-check"></i><b>6.6</b> Pulimiento de medianas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="otros-tipos-de-kriging.html"><a href="otros-tipos-de-kriging.html"><i class="fa fa-check"></i><b>7</b> Otros Tipos de Kriging</a>
<ul>
<li class="chapter" data-level="7.1" data-path="otros-tipos-de-kriging.html"><a href="otros-tipos-de-kriging.html#to-do-1"><i class="fa fa-check"></i><b>7.1</b> (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html"><i class="fa fa-check"></i><b>8</b> Ilustración del kriging simple espacio tiempo</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#librerías-4"><i class="fa fa-check"></i><b>8.1</b> librerías</a></li>
<li class="chapter" data-level="8.2" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#simulación-no-condicional-de-una-realización-de-un-campo-aleatorio-espacio-temporal-no-separable-usando-el-modelo-de-covarianza-cressie1-1"><i class="fa fa-check"></i><b>8.2</b> <strong>Simulación no condicional de una realización de un campo aleatorio espacio temporal no separable usando el modelo de covarianza cressie1</strong></a></li>
<li class="chapter" data-level="8.3" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#algunas-funciones-de-covarianza-espacio-temporal-no-separables-1"><i class="fa fa-check"></i><b>8.3</b> <strong>Algunas funciones de covarianza espacio temporal no separables</strong></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#c-r-e-s-s-i-e---h-u-a-n-g-1999-1"><i class="fa fa-check"></i><b>8.3.1</b> C R E S S I E - H U A N G (1999)</a></li>
<li class="chapter" data-level="8.3.2" data-path="ilustración-del-kriging-simple-espacio-tiempo-1.html"><a href="ilustración-del-kriging-simple-espacio-tiempo-1.html#gneiting-2002-combina-fun1-fun2-y-psi-en-gneiting-1"><i class="fa fa-check"></i><b>8.3.2</b> Gneiting (2002), combina fun1, fun2 y psi en Gneiting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion.html"><a href="simulacion.html"><i class="fa fa-check"></i><b>9</b> Simulacion</a>
<ul>
<li class="chapter" data-level="9.1" data-path="simulacion.html"><a href="simulacion.html#simulacion-espacial"><i class="fa fa-check"></i><b>9.1</b> Simulacion Espacial</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="simulacion.html"><a href="simulacion.html#dependencias"><i class="fa fa-check"></i><b>9.1.1</b> Dependencias</a></li>
<li class="chapter" data-level="9.1.2" data-path="simulacion.html"><a href="simulacion.html#ubicaciones"><i class="fa fa-check"></i><b>9.1.2</b> Ubicaciones:</a></li>
<li class="chapter" data-level="9.1.3" data-path="simulacion.html"><a href="simulacion.html#modelo-lineal-de-coregionalización-1"><i class="fa fa-check"></i><b>9.1.3</b> Modelo lineal de coregionalización</a></li>
<li class="chapter" data-level="9.1.4" data-path="simulacion.html"><a href="simulacion.html#simulación-de-un-proceso-espacial-gaussiano-bivariado-1"><i class="fa fa-check"></i><b>9.1.4</b> simulación de un proceso espacial Gaussiano bivariado</a></li>
<li class="chapter" data-level="9.1.5" data-path="simulacion.html"><a href="simulacion.html#simulación-proceso-espacio-temporal"><i class="fa fa-check"></i><b>9.1.5</b> Simulación Proceso Espacio Temporal</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="simulacion.html"><a href="simulacion.html#simulación-condicionada-to-do"><i class="fa fa-check"></i><b>9.2</b> Simulación Condicionada (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regresión-espacial.html"><a href="regresión-espacial.html"><i class="fa fa-check"></i><b>10</b> Regresión Espacial</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regresión-espacial.html"><a href="regresión-espacial.html#to-do-2"><i class="fa fa-check"></i><b>10.1</b> (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modelos-lineales-y-modelos-lineales-generalizados.html"><a href="modelos-lineales-y-modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>11</b> Modelos Lineales y Modelos Lineales Generalizados</a>
<ul>
<li class="chapter" data-level="11.1" data-path="modelos-lineales-y-modelos-lineales-generalizados.html"><a href="modelos-lineales-y-modelos-lineales-generalizados.html#to-do-3"><i class="fa fa-check"></i><b>11.1</b> (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html"><i class="fa fa-check"></i><b>12</b> Spatial modeling leukemia</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#mortality"><i class="fa fa-check"></i><b>12.1</b> <strong>Mortality</strong></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-mortality"><i class="fa fa-check"></i><b>12.1.1</b> <em>Packages Mortality</em></a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-mortality"><i class="fa fa-check"></i><b>12.1.2</b> <em>Code Mortality</em></a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#incidence"><i class="fa fa-check"></i><b>12.2</b> Incidence</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#packages-incidence"><i class="fa fa-check"></i><b>12.2.1</b> <strong>Packages Incidence</strong></a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-modeling-leukemia.html"><a href="spatial-modeling-leukemia.html#code-incidence"><i class="fa fa-check"></i><b>12.2.2</b> <em>Code Incidence</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regresión-ponderada-geográfica.html"><a href="regresión-ponderada-geográfica.html"><i class="fa fa-check"></i><b>13</b> Regresión Ponderada Geográfica</a>
<ul>
<li class="chapter" data-level="13.1" data-path="regresión-ponderada-geográfica.html"><a href="regresión-ponderada-geográfica.html#to-do-4"><i class="fa fa-check"></i><b>13.1</b> (TO-DO)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html"><i class="fa fa-check"></i><b>14</b> Análisis de datos funcionales</a>
<ul>
<li class="chapter" data-level="14.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-exploratorio"><i class="fa fa-check"></i><b>14.1</b> Análisis de datos funcionales (ADF) - Análisis exploratorio</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#datos-funcionales"><i class="fa fa-check"></i><b>14.1.1</b> Datos funcionales</a></li>
<li class="chapter" data-level="14.1.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-gráfico-y-detección-de-outliers"><i class="fa fa-check"></i><b>14.1.2</b> Análisis gráfico y detección de outliers</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-de-datos-funcionales-adf---análisis-gráfico"><i class="fa fa-check"></i><b>14.2</b> Análisis de datos funcionales (ADF) - Análisis gráfico</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#deteccción-de-curvas-atípicas"><i class="fa fa-check"></i><b>14.2.1</b> Deteccción de curvas atípicas</a></li>
<li class="chapter" data-level="14.2.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#otras-medidas-de-resumen"><i class="fa fa-check"></i><b>14.2.2</b> Otras medidas de resumen</a></li>
<li class="chapter" data-level="14.2.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#análisis-en-componentes-principales-acpf"><i class="fa fa-check"></i><b>14.2.3</b> Análisis en Componentes Principales (ACPF)</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#modelos-lineales"><i class="fa fa-check"></i><b>14.3</b> Modelos lineales</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-escalar"><i class="fa fa-check"></i><b>14.3.1</b> Regresión lineal funcional con respuesta escalar</a></li>
<li class="chapter" data-level="14.3.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estimación-de-los-coeficientes-beta-con-regularización"><i class="fa fa-check"></i><b>14.3.2</b> Estimación de los coeficientes <span class="math inline">\(\beta\)</span> con regularización</a></li>
<li class="chapter" data-level="14.3.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#prueba-f-para-ajuste-del-modelo-a-través-de-permutaciones"><i class="fa fa-check"></i><b>14.3.3</b> Prueba <span class="math inline">\(F\)</span> para ajuste del modelo a través de permutaciones</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#modelos-lineales-funcionales-regresión-funcional"><i class="fa fa-check"></i><b>14.4</b> Modelos lineales funcionales (Regresión Funcional)</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#regresión-lineal-funcional-con-respuesta-funcional-anova-funcional"><i class="fa fa-check"></i><b>14.4.1</b> Regresión lineal funcional con respuesta funcional (ANOVA Funcional)</a></li>
<li class="chapter" data-level="14.4.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estimación---mínimos-cuadrados-ordinarios"><i class="fa fa-check"></i><b>14.4.2</b> Estimación - Mínimos cuadrados ordinarios</a></li>
<li class="chapter" data-level="14.4.3" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#pruebas-de-hipótesis---prueba-de-shen-faraway"><i class="fa fa-check"></i><b>14.4.3</b> Pruebas de hipótesis - Prueba de Shen &amp; Faraway</a></li>
<li class="chapter" data-level="14.4.4" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#ejemplo"><i class="fa fa-check"></i><b>14.4.4</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#estadística-espacial"><i class="fa fa-check"></i><b>14.5</b> Estadística Espacial</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#metodología-de-predicción-espacial-con-datos-funcionales"><i class="fa fa-check"></i><b>14.5.1</b> Metodología de predicción espacial con datos funcionales</a></li>
<li class="chapter" data-level="14.5.2" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#ilustración"><i class="fa fa-check"></i><b>14.5.2</b> Ilustración</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#patrones-puntuales"><i class="fa fa-check"></i><b>14.6</b> Patrones Puntuales</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="análisis-de-datos-funcionales.html"><a href="análisis-de-datos-funcionales.html#datos"><i class="fa fa-check"></i><b>14.6.1</b> Datos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ilustrcion del krigin simple espacio tiempo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pulimiento-de-medianas" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Capítulo 6</span> Pulimiento de medianas<a href="pulimiento-de-medianas.html#pulimiento-de-medianas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Esta es una alternativa al modelamiento de la media cuando los modelos de regresión polinómicos usuales no logran el objetivo de eliminar la tendencia ya sea porque el tipo de tendencia corresponde mas a unas ventanas móviles o porque hay presentes datos atípicos.</p>
<div id="cargar-librerias" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Cargar librerias<a href="pulimiento-de-medianas.html#cargar-librerias" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lista de librerías con link a la documentación.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="pulimiento-de-medianas.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb308-2"><a href="pulimiento-de-medianas.html#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb308-3"><a href="pulimiento-de-medianas.html#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb308-4"><a href="pulimiento-de-medianas.html#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span></code></pre></div>
<ul>
<li><a href="https://cran.r-project.org/web/packages/gstat/gstat.pdf">gstat</a></li>
<li><a href="https://cran.r-project.org/web/packages/sp/sp.pdf">sp</a></li>
</ul>
</div>
<div id="grilla-de-las-ubicaciones-espaciales." class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Grilla de las ubicaciones espaciales.<a href="pulimiento-de-medianas.html#grilla-de-las-ubicaciones-espaciales." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="pulimiento-de-medianas.html#cb309-1" aria-hidden="true" tabindex="-1"></a>n_x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb309-2"><a href="pulimiento-de-medianas.html#cb309-2" aria-hidden="true" tabindex="-1"></a>n_y <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb309-3"><a href="pulimiento-de-medianas.html#cb309-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> n_x)</span>
<span id="cb309-4"><a href="pulimiento-de-medianas.html#cb309-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> n_y)</span>
<span id="cb309-5"><a href="pulimiento-de-medianas.html#cb309-5" aria-hidden="true" tabindex="-1"></a>coordenadas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">expand.grid</span>(x, y))</span>
<span id="cb309-6"><a href="pulimiento-de-medianas.html#cb309-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(coordenadas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p>Encabezado coordenadas</p>
<table>
<thead>
<tr class="header">
<th>X</th>
<th>Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0000000</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>0.3333333</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>0.6666667</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>1.0000000</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>0.0000000</td>
<td>0.2</td>
</tr>
<tr class="even">
<td>0.3333333</td>
<td>0.2</td>
</tr>
</tbody>
</table>
</div>
<div id="definición-de-objeto-vgm" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Definición de objeto VGM<a href="pulimiento-de-medianas.html#definición-de-objeto-vgm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Esto define un objeto vgm que es el tipo de objeto que usa el paquete gstat para los modelos teóricos de variograma. Con este objeto se pueden definir modelos anidados.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/gstat/gstat.pdf#page=73">vgm</a></li>
</ul>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="pulimiento-de-medianas.html#cb310-1" aria-hidden="true" tabindex="-1"></a>vario <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="dv">10</span>, <span class="co"># Punto de silla</span></span>
<span id="cb310-2"><a href="pulimiento-de-medianas.html#cb310-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Exp&quot;</span>, <span class="co"># Modelo, ver documentación</span></span>
<span id="cb310-3"><a href="pulimiento-de-medianas.html#cb310-3" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.5</span>)  <span class="co"># Rango</span></span>
<span id="cb310-4"><a href="pulimiento-de-medianas.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vario)</span></code></pre></div>
<pre><code>##   model psill range
## 1   Exp    10   0.5</code></pre>
</div>
<div id="matriz-de-varianza-dadas-coordenadas." class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Matriz de varianza dadas coordenadas.<a href="pulimiento-de-medianas.html#matriz-de-varianza-dadas-coordenadas." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/gstat/gstat.pdf#page=78">vgmArea</a></li>
<li><a href="https://cran.r-project.org/web/packages/sp/sp.pdf#page=16">coordinates</a></li>
</ul>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="pulimiento-de-medianas.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(coordenadas) <span class="ot">&lt;-</span> <span class="er">~</span>X <span class="sc">+</span> Y</span>
<span id="cb312-2"><a href="pulimiento-de-medianas.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(coordenadas) <span class="co"># Cambio de objedto dataframe a sp</span></span></code></pre></div>
<pre><code>## [1] &quot;SpatialPoints&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="pulimiento-de-medianas.html#cb314-1" aria-hidden="true" tabindex="-1"></a>cov_mat <span class="ot">&lt;-</span> <span class="fu">vgmArea</span>(coordenadas, <span class="co"># Matriz de ubiaciones SP</span></span>
<span id="cb314-2"><a href="pulimiento-de-medianas.html#cb314-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">vgm =</span> vario) <span class="co"># VGM object</span></span>
<span id="cb314-3"><a href="pulimiento-de-medianas.html#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="pulimiento-de-medianas.html#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(cov_mat))</span></code></pre></div>
<pre><code>## [1] 24 24</code></pre>
</div>
<div id="simulación." class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Simulación.<a href="pulimiento-de-medianas.html#simulación." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulación dada la media y la matriz de varianza</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="pulimiento-de-medianas.html#cb316-1" aria-hidden="true" tabindex="-1"></a>mu  <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_x <span class="sc">*</span> n_y) <span class="co"># Media del proceso</span></span>
<span id="cb316-2"><a href="pulimiento-de-medianas.html#cb316-2" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,</span>
<span id="cb316-3"><a href="pulimiento-de-medianas.html#cb316-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean =</span> mu,</span>
<span id="cb316-4"><a href="pulimiento-de-medianas.html#cb316-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma =</span> cov_mat)</span>
<span id="cb316-5"><a href="pulimiento-de-medianas.html#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(simu[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>## [1] -4.218770 -3.030928  5.315562  1.119559  1.515620</code></pre>
</div>
<div id="pulimiento-de-medianas-1" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Pulimiento de medianas<a href="pulimiento-de-medianas.html#pulimiento-de-medianas-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unir las coordenadas con la columna de simulación</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="pulimiento-de-medianas.html#cb318-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(coordenadas<span class="sc">@</span>coords,</span>
<span id="cb318-2"><a href="pulimiento-de-medianas.html#cb318-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Simula =</span> <span class="fu">t</span>(simu)))</span>
<span id="cb318-3"><a href="pulimiento-de-medianas.html#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Var&quot;</span>)</span>
<span id="cb318-4"><a href="pulimiento-de-medianas.html#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(data))</span></code></pre></div>
<pre><code>##           X   Y       Var
## 1 0.0000000 0.0 -4.218770
## 2 0.3333333 0.0 -3.030928
## 3 0.6666667 0.0  5.315562
## 4 1.0000000 0.0  1.119559
## 5 0.0000000 0.2  1.515620
## 6 0.3333333 0.2 -1.554350</code></pre>
<p>Reshape para matriz, esto transforma la tabla de datos en matriz</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="pulimiento-de-medianas.html#cb320-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(data,</span>
<span id="cb320-2"><a href="pulimiento-de-medianas.html#cb320-2" aria-hidden="true" tabindex="-1"></a>                         X <span class="sc">~</span> Y,</span>
<span id="cb320-3"><a href="pulimiento-de-medianas.html#cb320-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value.var =</span> <span class="st">&quot;Var&quot;</span>)</span>
<span id="cb320-4"><a href="pulimiento-de-medianas.html#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabla) <span class="ot">&lt;-</span> tabla[, <span class="dv">1</span>]</span>
<span id="cb320-5"><a href="pulimiento-de-medianas.html#cb320-5" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> tabla[, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb320-6"><a href="pulimiento-de-medianas.html#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla)</span></code></pre></div>
<pre><code>##                           0       0.2       0.4         0.6        0.8           1
## 0                 -4.218770  1.515620  2.355880  0.67439769 -0.1577899 -1.87342236
## 0.333333333333333 -3.030928 -1.554350  1.246122 -0.05304733  1.2968775 -2.10463138
## 0.666666666666667  5.315562  3.628046 -1.515568 -1.09213690 -0.6026619 -0.01285466
## 1                  1.119559  2.330230 -1.228748 -1.44059652  1.5043484  1.95802632</code></pre>
<p>Pulimiento de medianas de la tabla</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="pulimiento-de-medianas.html#cb322-1" aria-hidden="true" tabindex="-1"></a>med <span class="ot">&lt;-</span> <span class="fu">medpolish</span>(tabla)</span></code></pre></div>
<pre><code>## 1: 37.03791
## Final: 37.03791</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="pulimiento-de-medianas.html#cb324-1" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(med<span class="sc">$</span>residuals)</span>
<span id="cb324-2"><a href="pulimiento-de-medianas.html#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(med)</span></code></pre></div>
<pre><code>## 
## Median Polish Results (Dataset: &quot;tabla&quot;)
## 
## Overall: -0.06518824
## 
## Row Effects:
##                 0 0.333333333333333 0.666666666666667                 1 
##        0.08313395       -0.78777100       -0.08313395        1.32150814 
## 
## Column Effects:
##           0         0.2         0.4         0.6         0.8           1 
## -1.15736511  1.28579182  0.36591754 -0.14368137  0.03614648 -0.55810231 
## 
## Residuals:
##                         0      0.2     0.4      0.6      0.8        1
## 0                 -3.0794  0.21188  1.9720  0.80013 -0.21188 -1.33327
## 0.333333333333333 -1.0206 -1.98718  1.7332  0.94359  2.11369 -0.69357
## 0.666666666666667  6.6212  2.49058 -1.7332 -0.80013 -0.49049  0.69357
## 1                  1.0206 -0.21188 -2.8510 -2.55324  0.21188  1.25981</code></pre>
<p>Reshape de los datos, con efecto de la fila y la columna</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="pulimiento-de-medianas.html#cb326-1" aria-hidden="true" tabindex="-1"></a>tabla_residuales <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(med<span class="sc">$</span>residuals)</span>
<span id="cb326-2"><a href="pulimiento-de-medianas.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tabla_residuales) <span class="ot">&lt;-</span> med<span class="sc">$</span>col</span>
<span id="cb326-3"><a href="pulimiento-de-medianas.html#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabla_residuales) <span class="ot">&lt;-</span> med<span class="sc">$</span>row</span>
<span id="cb326-4"><a href="pulimiento-de-medianas.html#cb326-4" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="fu">as.matrix</span>(tabla_residuales))</span>
<span id="cb326-5"><a href="pulimiento-de-medianas.html#cb326-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-6"><a href="pulimiento-de-medianas.html#cb326-6" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data,</span>
<span id="cb326-7"><a href="pulimiento-de-medianas.html#cb326-7" aria-hidden="true" tabindex="-1"></a>                  geo_data,</span>
<span id="cb326-8"><a href="pulimiento-de-medianas.html#cb326-8" aria-hidden="true" tabindex="-1"></a>                  med<span class="sc">$</span>overall)</span>
<span id="cb326-9"><a href="pulimiento-de-medianas.html#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(geo_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,</span>
<span id="cb326-10"><a href="pulimiento-de-medianas.html#cb326-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb326-11"><a href="pulimiento-de-medianas.html#cb326-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Var&quot;</span>,</span>
<span id="cb326-12"><a href="pulimiento-de-medianas.html#cb326-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Efecto fila&quot;</span>,</span>
<span id="cb326-13"><a href="pulimiento-de-medianas.html#cb326-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Efecto columa&quot;</span>,</span>
<span id="cb326-14"><a href="pulimiento-de-medianas.html#cb326-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Residual&quot;</span>,</span>
<span id="cb326-15"><a href="pulimiento-de-medianas.html#cb326-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Efecto Global&quot;</span>)</span>
<span id="cb326-16"><a href="pulimiento-de-medianas.html#cb326-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(geo_data)</span></code></pre></div>
<pre><code>##            X   Y         Var Efecto fila Efecto columa   Residual Efecto Global
## 1  0.0000000 0.0 -4.21876969  0.08313395   -1.15736511 -3.0793503   -0.06518824
## 2  0.3333333 0.0 -3.03092827 -0.78777100   -1.15736511 -1.0206039   -0.06518824
## 3  0.6666667 0.0  5.31556220 -0.08313395   -1.15736511  6.6212495   -0.06518824
## 4  1.0000000 0.0  1.11955872  1.32150814   -1.15736511  1.0206039   -0.06518824
## 5  0.0000000 0.2  1.51561960  0.08313395    1.28579182  0.2118821   -0.06518824
## 6  0.3333333 0.2 -1.55434972 -0.78777100    1.28579182 -1.9871823   -0.06518824
## 7  0.6666667 0.2  3.62804608 -0.08313395    1.28579182  2.4905764   -0.06518824
## 8  1.0000000 0.2  2.33022966  1.32150814    1.28579182 -0.2118821   -0.06518824
## 9  0.0000000 0.4  2.35587980  0.08313395    0.36591754  1.9720166   -0.06518824
## 10 0.3333333 0.4  1.24612176 -0.78777100    0.36591754  1.7331635   -0.06518824
## 11 0.6666667 0.4 -1.51556811 -0.08313395    0.36591754 -1.7331635   -0.06518824
## 12 1.0000000 0.4 -1.22874825  1.32150814    0.36591754 -2.8509857   -0.06518824
## 13 0.0000000 0.6  0.67439769  0.08313395   -0.14368137  0.8001333   -0.06518824
## 14 0.3333333 0.6 -0.05304733 -0.78777100   -0.14368137  0.9435933   -0.06518824
## 15 0.6666667 0.6 -1.09213690 -0.08313395   -0.14368137 -0.8001333   -0.06518824
## 16 1.0000000 0.6 -1.44059652  1.32150814   -0.14368137 -2.5532351   -0.06518824
## 17 0.0000000 0.8 -0.15778987  0.08313395    0.03614648 -0.2118821   -0.06518824
## 18 0.3333333 0.8  1.29687747 -0.78777100    0.03614648  2.1136902   -0.06518824
## 19 0.6666667 0.8 -0.60266192 -0.08313395    0.03614648 -0.4904862   -0.06518824
## 20 1.0000000 0.8  1.50434844  1.32150814    0.03614648  0.2118821   -0.06518824
## 21 0.0000000 1.0 -1.87342236  0.08313395   -0.55810231 -1.3332658   -0.06518824
## 22 0.3333333 1.0 -2.10463138 -0.78777100   -0.55810231 -0.6935698   -0.06518824
## 23 0.6666667 1.0 -0.01285466 -0.08313395   -0.55810231  0.6935698   -0.06518824
## 24 1.0000000 1.0  1.95802632  1.32150814   -0.55810231  1.2598087   -0.06518824</code></pre>
<p>Validación de la descomposición</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="pulimiento-de-medianas.html#cb328-1" aria-hidden="true" tabindex="-1"></a>valida <span class="ot">&lt;-</span> <span class="fu">cbind</span>(geo_data<span class="sc">$</span>Var,</span>
<span id="cb328-2"><a href="pulimiento-de-medianas.html#cb328-2" aria-hidden="true" tabindex="-1"></a>                geo_data[[<span class="st">&quot;Efecto fila&quot;</span>]] <span class="sc">+</span></span>
<span id="cb328-3"><a href="pulimiento-de-medianas.html#cb328-3" aria-hidden="true" tabindex="-1"></a>                geo_data[[<span class="st">&quot;Efecto columa&quot;</span>]] <span class="sc">+</span></span>
<span id="cb328-4"><a href="pulimiento-de-medianas.html#cb328-4" aria-hidden="true" tabindex="-1"></a>                geo_data[[<span class="st">&quot;Residual&quot;</span>]] <span class="sc">+</span></span>
<span id="cb328-5"><a href="pulimiento-de-medianas.html#cb328-5" aria-hidden="true" tabindex="-1"></a>                geo_data[[<span class="st">&quot;Efecto Global&quot;</span>]])</span>
<span id="cb328-6"><a href="pulimiento-de-medianas.html#cb328-6" aria-hidden="true" tabindex="-1"></a>valida <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(valida)</span>
<span id="cb328-7"><a href="pulimiento-de-medianas.html#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(valida) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;datos&quot;</span>, <span class="st">&quot;suma&quot;</span>)</span>
<span id="cb328-8"><a href="pulimiento-de-medianas.html#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(valida)</span></code></pre></div>
<pre><code>##          datos        suma
## 1  -4.21876969 -4.21876969
## 2  -3.03092827 -3.03092827
## 3   5.31556220  5.31556220
## 4   1.11955872  1.11955872
## 5   1.51561960  1.51561960
## 6  -1.55434972 -1.55434972
## 7   3.62804608  3.62804608
## 8   2.33022966  2.33022966
## 9   2.35587980  2.35587980
## 10  1.24612176  1.24612176
## 11 -1.51556811 -1.51556811
## 12 -1.22874825 -1.22874825
## 13  0.67439769  0.67439769
## 14 -0.05304733 -0.05304733
## 15 -1.09213690 -1.09213690
## 16 -1.44059652 -1.44059652
## 17 -0.15778987 -0.15778987
## 18  1.29687747  1.29687747
## 19 -0.60266192 -0.60266192
## 20  1.50434844  1.50434844
## 21 -1.87342236 -1.87342236
## 22 -2.10463138 -2.10463138
## 23 -0.01285466 -0.01285466
## 24  1.95802632  1.95802632</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducción-proceso-espacial-bivariado.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="otros-tipos-de-kriging.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/edit/master/05-PulimientoMedianas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mpbohorquezc/Clases-EE-UN/blob/master/05-PulimientoMedianas.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
